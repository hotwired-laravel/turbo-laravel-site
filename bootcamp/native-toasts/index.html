<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <link rel="canonical" href="https://turbo-laravel.com/bootcamp/native-toasts">
        <meta name="description" content="Native Toasts">
        <title>Native Toasts</title>
        <link rel="apple-touch-icon" sizes="180x180" href="/assets/manifest/apple-touch-icon.png">
        <link rel="icon" type="image/png" sizes="32x32" href="/assets/manifest/favicon-32x32.png">
        <link rel="icon" type="image/png" sizes="16x16" href="/assets/manifest/favicon-16x16.png">
        <link rel="manifest" href="/assets/site.webmanifest">
        <link rel="preload" href="/assets/fonts/OpenSans-ExtraBold.ttf" as="font" type="font/ttf" crossorigin>
        <link rel="preload" href="/assets/fonts/Jost-Regular.woff2" as="font" type="font/woff2" crossorigin>
        <link rel="preload" href="/assets/fonts/Jost-Italic.woff2" as="font" type="font/woff2" crossorigin>
        <link rel="stylesheet" href="/assets/build/css/main.css?id=4d73d68534fb60a6d8714799848a8219">
        <script defer src="/assets/build/js/main.js?id=b0f29cd4e71d41b4ee570d0f42344180"></script>
    </head>
    <body class="text-zinc-900 text-xl font-sans antialiased bg-zinc-700/5 min-h-screen" data-controller="search" data-action="keydown@window->search#focus">
        <header class="px-4 py-6 lg:px-10 xl:px-20 lg:py-10 flex items-center space-x-2 justify-between">
  <div class="relative flex-1 lg:flex-auto flex justify-between items-center space-x-4 sm:space-x-2">
    <h1 class="text-3xl sm:text-4xl font-extrabold font-heading">
      <a href="/">Turbo Laravel</a>
    </h1>

    <nav class="inline-block lg:hidden">
      <details class="group" data-search-target="nav">
        <summary class="list-none">
          <span>
            <span class="sr-only">Navigation</span>

            <svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-8 rotate-0 transition group-open:rotate-90">
              <path class="opacity-100 transition group-open:opacity-0" stroke-linecap="round" stroke-linejoin="round" d="M3.75 6.75h16.5M3.75 12h16.5m-16.5 5.25h16.5" />
              <path class="transition opacity-0 group-open:opacity-100" stroke-linecap="round" stroke-linejoin="round" d="M6 18 18 6M6 6l12 12" />
            </svg>
          </span>
        </summary>

        <div class="bg-white/50 z-10 absolute top-12 -inset-x-4 backdrop-blur-xl">
          <div class="bg-zinc-700/5 px-4 py-6 backdrop-blur">
            <form action="/docs/search" method="GET" class="px-4">
  <label for="search" class="sr-only">Search</label>
  <input data-search-target="mobile" type="search" name="q" class="search-input rounded border border-zinc-900/5 px-4 py-2 text-base leading-3 shadow w-full" placeholder="Search 2.x docs..." />
  <button type="submit" class="sr-only">Search</button>
</form>

            <ul class="space-y-6 -mb-2 mt-4">
              <li>
                <a href="/docs" class="px-4 py-2 font-medium rounded-full transition hover:bg-white/90 flex items-center space-x-1">
                  <span>Documentation</span>
                </a>

                              </li>
              <li>
                <a href="https://github.com/hotwired-laravel/turbo-laravel" class="px-4 py-2 font-medium rounded-full transition hover:bg-zinc-900/20">Source Code</a>
              </li>
              <li class="space-y-6">
                <a href="/bootcamp/introduction" class="px-4 py-2 font-medium rounded-full transition hover:bg-white/90">Bootcamp</a>
                  <div class="mx-4 pl-3 border-l-4 border-zinc-900/30">
  <ul class="">
        <li class="px-2 py-1 font-heading font-extrabold uppercase text-sm text-zinc-900/40">Prologue</li>
    <li class="children mt-2">
      <ul class="list-inside space-y-1 text-lg">
                <li><a href="/bootcamp/introduction" class=" transition hover:bg-zinc-900/20 w-full inline-block px-2 py-1">Introduction</a></li>
              </ul>
    </li>
        <li class="px-2 py-1 font-heading font-extrabold uppercase text-sm text-zinc-900/40">Web</li>
    <li class="children mt-2">
      <ul class="list-inside space-y-1 text-lg">
                <li><a href="/bootcamp/installation" class=" transition hover:bg-zinc-900/20 w-full inline-block px-2 py-1">Installation</a></li>
                <li><a href="/bootcamp/creating-chirps" class=" transition hover:bg-zinc-900/20 w-full inline-block px-2 py-1">Creating Chirps</a></li>
                <li><a href="/bootcamp/listing-chirps" class=" transition hover:bg-zinc-900/20 w-full inline-block px-2 py-1">Listing Chirps</a></li>
                <li><a href="/bootcamp/editing-chirps" class=" transition hover:bg-zinc-900/20 w-full inline-block px-2 py-1">Editing Chirps</a></li>
                <li><a href="/bootcamp/deleting-chirps" class=" transition hover:bg-zinc-900/20 w-full inline-block px-2 py-1">Deleting Chirps</a></li>
                <li><a href="/bootcamp/hotwiring-everything" class=" transition hover:bg-zinc-900/20 w-full inline-block px-2 py-1">Hotwiring Everything</a></li>
                <li><a href="/bootcamp/broadcasting" class=" transition hover:bg-zinc-900/20 w-full inline-block px-2 py-1">Broadcasting</a></li>
              </ul>
    </li>
        <li class="px-2 py-1 font-heading font-extrabold uppercase text-sm text-zinc-900/40">Native</li>
    <li class="children mt-2">
      <ul class="list-inside space-y-1 text-lg">
                <li><a href="/bootcamp/native-setup" class=" transition hover:bg-zinc-900/20 w-full inline-block px-2 py-1">Installation</a></li>
                <li><a href="/bootcamp/native-auth" class=" transition hover:bg-zinc-900/20 w-full inline-block px-2 py-1">Authentication</a></li>
                <li><a href="/bootcamp/native-bridge-component" class=" transition hover:bg-zinc-900/20 w-full inline-block px-2 py-1">Our First Bridge Component</a></li>
                <li><a href="/bootcamp/native-editing-modal" class=" transition hover:bg-zinc-900/20 w-full inline-block px-2 py-1">Editing as a Modal</a></li>
                <li><a href="/bootcamp/native-confirmation" class=" transition hover:bg-zinc-900/20 w-full inline-block px-2 py-1">Native Confirmation Dialog</a></li>
                <li><a href="/bootcamp/native-toasts" class="font-bold transition hover:bg-zinc-900/20 w-full inline-block px-2 py-1">Native Toasts</a></li>
              </ul>
    </li>
        <li class="px-2 py-1 font-heading font-extrabold uppercase text-sm text-zinc-900/40">Epilogue</li>
    <li class="children mt-2">
      <ul class="list-inside space-y-1 text-lg">
                <li><a href="/bootcamp/conclusion" class=" transition hover:bg-zinc-900/20 w-full inline-block px-2 py-1">Conclusion</a></li>
              </ul>
    </li>
      </ul>
</div>
              </li>
              <!-- <li><a href="/demo" class="px-4 py-2 font-medium rounded-full transition hover:bg-white/90">Demo</a></li> -->
            </ul>
          </div>
        </div>
      </details>
    </nav>
  </div>

  <nav class="hidden lg:block">
    <ul class="flex items-center space-x-6 -my-2">
      <li>
        <div class="group relative py-2">
          <a href="/docs" class=" px-4 py-2 font-medium rounded-full transition hover:bg-white/90 flex items-center space-x-1">
            <span>Documentation</span>

            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-5">
              <path stroke-linecap="round" stroke-linejoin="round" d="m19.5 8.25-7.5 7.5-7.5-7.5" />
            </svg>
          </a>

          <div class="absolute p-4 top-14 inset-x opacity-0 scale-0 -translate-y-8 transition group-hover:translate-y-0 group-hover:scale-100 group-hover:opacity-100 rounded bg-white shadow z-10">
            <ul class="space-y-1">
              <li><a href="/docs/installation" class="block px-2 py-1 bg-zinc-900/20 rounded">Version <span class="">2.2.0</span></a></li>
              <li><a href="/1.x/docs/installation" class="block px-2 py-1  rounded">Version <span class="">1.12.2</span></a></li>
            </ul>
          </div>
        </div>
      </li>
      <li><a href="https://github.com/hotwired-laravel/turbo-laravel" class="px-4 py-2 font-medium rounded-full transition hover:bg-white/90">Source Code</a></li>
      <li><a href="/bootcamp/introduction" class="bg-white/90 px-4 py-2 font-medium rounded-full transition hover:bg-white/90">Bootcamp</a></li>
      <!-- <li><a href="/demo" class=" px-4 py-2 font-medium rounded-full transition hover:bg-white/90">Demo</a></li> -->
    </ul>
  </nav>
</header>

          <div class="bg-white/90 custom-border px-6 py-20 sm:flex space-x-6">
    <div class="sm:flex sm:space-x-6 sm:max-w-7xl w-full mx-auto">
      <aside class="relative w-1/4 hidden lg:block" data-search-target="aside">
        <div class="sticky top-4 block space-y-4">
            <form action="/bootcamp/search" method="GET">
  <label for="search" class="sr-only">Search</label>
  <input data-search-target="web" type="text" name="q" placeholder="Search bootcamp... (press &quot;/&quot; to focus)" class="search-input rounded border border-zinc-900/5 px-4 py-2 text-base leading-3 shadow w-full" />
</form>

            <ul class="[&_.children]:mb-4">
    <li class="px-2 py-1 font-heading font-extrabold uppercase text-sm text-zinc-900/40">Prologue</li>
  <li class="children mt-2">
    <ul class="list-inside space-y-1 text-lg">
            <li><a href="/bootcamp/introduction" class=" transition hover:bg-zinc-900/20 w-full inline-block px-2 py-1 rounded">Introduction</a></li>
          </ul>
  </li>
    <li class="px-2 py-1 font-heading font-extrabold uppercase text-sm text-zinc-900/40">Web</li>
  <li class="children mt-2">
    <ul class="list-inside space-y-1 text-lg">
            <li><a href="/bootcamp/installation" class=" transition hover:bg-zinc-900/20 w-full inline-block px-2 py-1 rounded">Installation</a></li>
            <li><a href="/bootcamp/creating-chirps" class=" transition hover:bg-zinc-900/20 w-full inline-block px-2 py-1 rounded">Creating Chirps</a></li>
            <li><a href="/bootcamp/listing-chirps" class=" transition hover:bg-zinc-900/20 w-full inline-block px-2 py-1 rounded">Listing Chirps</a></li>
            <li><a href="/bootcamp/editing-chirps" class=" transition hover:bg-zinc-900/20 w-full inline-block px-2 py-1 rounded">Editing Chirps</a></li>
            <li><a href="/bootcamp/deleting-chirps" class=" transition hover:bg-zinc-900/20 w-full inline-block px-2 py-1 rounded">Deleting Chirps</a></li>
            <li><a href="/bootcamp/hotwiring-everything" class=" transition hover:bg-zinc-900/20 w-full inline-block px-2 py-1 rounded">Hotwiring Everything</a></li>
            <li><a href="/bootcamp/broadcasting" class=" transition hover:bg-zinc-900/20 w-full inline-block px-2 py-1 rounded">Broadcasting</a></li>
          </ul>
  </li>
    <li class="px-2 py-1 font-heading font-extrabold uppercase text-sm text-zinc-900/40">Native</li>
  <li class="children mt-2">
    <ul class="list-inside space-y-1 text-lg">
            <li><a href="/bootcamp/native-setup" class=" transition hover:bg-zinc-900/20 w-full inline-block px-2 py-1 rounded">Installation</a></li>
            <li><a href="/bootcamp/native-auth" class=" transition hover:bg-zinc-900/20 w-full inline-block px-2 py-1 rounded">Authentication</a></li>
            <li><a href="/bootcamp/native-bridge-component" class=" transition hover:bg-zinc-900/20 w-full inline-block px-2 py-1 rounded">Our First Bridge Component</a></li>
            <li><a href="/bootcamp/native-editing-modal" class=" transition hover:bg-zinc-900/20 w-full inline-block px-2 py-1 rounded">Editing as a Modal</a></li>
            <li><a href="/bootcamp/native-confirmation" class=" transition hover:bg-zinc-900/20 w-full inline-block px-2 py-1 rounded">Native Confirmation Dialog</a></li>
            <li><a href="/bootcamp/native-toasts" class="bg-zinc-900/20 transition hover:bg-zinc-900/20 w-full inline-block px-2 py-1 rounded">Native Toasts</a></li>
          </ul>
  </li>
    <li class="px-2 py-1 font-heading font-extrabold uppercase text-sm text-zinc-900/40">Epilogue</li>
  <li class="children mt-2">
    <ul class="list-inside space-y-1 text-lg">
            <li><a href="/bootcamp/conclusion" class=" transition hover:bg-zinc-900/20 w-full inline-block px-2 py-1 rounded">Conclusion</a></li>
          </ul>
  </li>
  </ul>
        </div>
      </aside>

      <main class="flex-1 min-w-0">
        <div class="prose prose-xl overflow-hidden prose-zinc [&_code:not(pre_code)]:text-wrap [&_code:not(pre_code)]:break-words prose-headings:font-heading prose-headings:font-extrabold max-w-none mx-auto w-full">
            <h1><em>13.</em> Native Toasts</h1>

<p>You may have noticed that our flash messages are not behaving correctly in the native side. That's because of how our native client handles redirects. It looks like it actiaves the cache first, which triggers a new request to the web app, then it visits the redirected URL, which then triggers another visit. Our flash messages are flashed for a single subsequent request, which is the one that comes from the activated cache, so they get lost when the redirect visit starts.</p>

<p>We can fix that by using some predefined URLs in the webapp that will only happen for Hotwire Native requests and they only instruct the web app to either recede, resume, or refresh the screens natively instead of following redirects.</p>

<p>Turbo Laravel ships with those predefined URLs for you:</p>

<pre><code class="language-bash">php artisan route:list | grep turbo
  GET|HEAD        recede_historical_location turbo_recede_historical_location…
  GET|HEAD        refresh_historical_location turbo_refresh_historical_locati…
  GET|HEAD        resume_historical_location turbo_resume_historical_location…
</code></pre>

<p>If you make a request to those routes, you will see that they don't actually have any contents on them:</p>

<pre><code class="language-bash">curl localhost/recede_historical_location
Going back...

curl localhost/refresh_historical_location
Refreshing...

curl localhost/resume_historical_location
Staying put...
</code></pre>

<p>Turbo Laravel ships with a <code>InteractsWithTurboNativeNavigation</code> trait that we can use in our controllers to redirect to these routes when the request comes from a Hotwire Native client or to a fallback route otherwise.</p>

<p>Let's change our controller to make use of that. We're going to change both the store and update actions to <em>recede</em> the screen stacks instead of a regular redirect:</p>

<pre><code class="language-php"><span class="hl-keyword">&lt;?php</span>

<span class="hl-keyword">namespace</span> <span class="hl-type">App\Http\Controllers</span>;

<span class="hl-keyword">use</span> <span class="hl-type">App\Models\Chirp</span>;
<span class="hl-keyword">use</span> <span class="hl-type">Illuminate\Http\Request</span>;
<span class="hl-keyword">use</span> <span class="hl-type">HotwiredLaravel\TurboLaravel\Http\Controllers\Concerns\InteractsWithHotwireNativeNavigation</span>; <span class="hl-comment">// Add this</span>

<span class="hl-keyword">class</span> <span class="hl-type">ChirpController</span> <span class="hl-keyword">extends</span> <span class="hl-type">Controller</span>
{
    <span class="hl-comment">// Add this:</span>
    <span class="hl-keyword">use</span> <span class="hl-type">InteractsWithHotwireNativeNavigation</span>;

    <span class="hl-comment">// ...</span>

    <span class="hl-keyword">public</span> <span class="hl-keyword">function</span> <span class="hl-property">store</span>(<span class="hl-injection"><span class="hl-type">Request</span> $request</span>)
    {
        <span class="hl-variable">$validated</span> = <span class="hl-variable">$request</span>-&gt;<span class="hl-property">validate</span>([
            <span class="hl-value">'message'</span> =&gt; [<span class="hl-value">'required'</span>, <span class="hl-value">'string'</span>, <span class="hl-value">'max:255'</span>],
        ]);

        <span class="hl-variable">$chirp</span> = <span class="hl-variable">$request</span>-&gt;<span class="hl-property">user</span>()-&gt;<span class="hl-property">chirps</span>()-&gt;<span class="hl-property">create</span>(<span class="hl-variable">$validated</span>);

        <span class="hl-comment">// Check if the request came from a Hotwire Native client...</span>
        <span class="hl-keyword">if</span> (<span class="hl-variable">$request</span>-&gt;<span class="hl-property">wantsTurboStream</span>() <span class="hl-operator">&amp;&amp;</span> ! <span class="hl-variable">$request</span>-&gt;<span class="hl-property">wasFromHotwireNative</span>()) {
            <span class="hl-keyword">return</span> <span class="hl-property">turbo_stream</span>([
                <span class="hl-property">turbo_stream</span>(<span class="hl-variable">$chirp</span>, <span class="hl-value">'prepend'</span>),
                <span class="hl-property">turbo_stream</span>()-&gt;<span class="hl-property">update</span>(<span class="hl-value">'create_chirp'</span>, <span class="hl-property">view</span>(<span class="hl-value">'chirps._form'</span>)),
                <span class="hl-property">turbo_stream</span>()-&gt;<span class="hl-property">append</span>(<span class="hl-value">'notifications'</span>, <span class="hl-property">view</span>(<span class="hl-value">'layouts.notification'</span>, [
                    <span class="hl-value">'message'</span> =&gt; <span class="hl-property">__</span>(<span class="hl-value">'Chirp created.'</span>),
                ])),
            ]);
        }

        <span class="hl-comment">// Use the recedeOrRedirectTo helper:</span>
        <span class="hl-keyword">return</span> <span class="hl-variable">$this</span>-&gt;<span class="hl-property">recedeOrRedirectTo</span>(<span class="hl-property">route</span>(<span class="hl-value">'chirps.index'</span>))
            -&gt;<span class="hl-property">with</span>(<span class="hl-value">'status'</span>, <span class="hl-property">__</span>(<span class="hl-value">'Chirp created.'</span>));
    }

    <span class="hl-comment">// ...</span>

    <span class="hl-keyword">public</span> <span class="hl-keyword">function</span> <span class="hl-property">update</span>(<span class="hl-injection"><span class="hl-type">Request</span> $request, <span class="hl-type">Chirp</span> $chirp</span>)
    {
        <span class="hl-variable">$this</span>-&gt;<span class="hl-property">authorize</span>(<span class="hl-value">'update'</span>, <span class="hl-variable">$chirp</span>);

        <span class="hl-variable">$validated</span> = <span class="hl-variable">$request</span>-&gt;<span class="hl-property">validate</span>([
            <span class="hl-value">'message'</span> =&gt; [<span class="hl-value">'required'</span>, <span class="hl-value">'string'</span>, <span class="hl-value">'max:255'</span>],
        ]);

        <span class="hl-variable">$chirp</span>-&gt;<span class="hl-property">update</span>(<span class="hl-variable">$validated</span>);

        <span class="hl-comment">// Check if the request was from a Hotwire Native client...</span>
        <span class="hl-keyword">if</span> (<span class="hl-variable">$request</span>-&gt;<span class="hl-property">wantsTurboStream</span>() <span class="hl-operator">&amp;&amp;</span> ! <span class="hl-variable">$request</span>-&gt;<span class="hl-property">wasFromHotwireNative</span>()) {
            <span class="hl-keyword">return</span> <span class="hl-property">turbo_stream</span>([
                <span class="hl-property">turbo_stream</span>(<span class="hl-variable">$chirp</span>),
                <span class="hl-property">turbo_stream</span>()-&gt;<span class="hl-property">append</span>(<span class="hl-value">'notifications'</span>, <span class="hl-property">view</span>(<span class="hl-value">'layouts.notification'</span>, [
                    <span class="hl-value">'message'</span> =&gt; <span class="hl-property">__</span>(<span class="hl-value">'Chirp updated.'</span>),
                ])),
            ]);
        }

        <span class="hl-comment">// Use the recedeOrRedirectTo helper:</span>
        <span class="hl-keyword">return</span> <span class="hl-variable">$this</span>-&gt;<span class="hl-property">recedeOrRedirectTo</span>(<span class="hl-property">route</span>(<span class="hl-value">'chirps.index'</span>))
            -&gt;<span class="hl-property">with</span>(<span class="hl-value">'status'</span>, <span class="hl-property">__</span>(<span class="hl-value">'Chirp updated.'</span>));
    }

    <span class="hl-comment">// ...</span>
}
</code></pre>

<p>The <code>recedeOrRedirectTo</code> method is the one that does the job of checking if the request comes from a Hotwire Native client or a regular web client and recides to redirect to the recede route instead of default redirect route. We also need to ensure that for when we're creating or updating chirps, we only return Turbo Streams if the request didn't come from a Hotwire Native client.</p>

<p>Next, we need to configure our specific routes in the <code>Constants.kt</code> file:</p>

<pre><code class="language-kotlin">package com.example.turbochirpernative.util

const val BASE_URL = &quot;http://10.0.2.2&quot;
const val CHIRPS_HOME_URL = &quot;$BASE_URL/chirps&quot;
const val CHIRPS_CREATE_URL = &quot;$BASE_URL/chirps/create&quot;

// Native Redirect Routes
const val REFRESH_HISTORICAL_URL = &quot;$BASE_URL/refresh_historical_location&quot;
const val RECEDE_HISTORICAL_URL = &quot;$BASE_URL/recede_historical_location&quot;
const val RESUME_HISTORICAL_URL = &quot;$BASE_URL/resume_historical_location&quot;

const val API_BASE_URL = &quot;$BASE_URL/api&quot;
const val API_CSRF_COOKIES_URL = &quot;$BASE_URL/sanctum/csrf-cookie&quot;
const val API_LOGIN_URL = &quot;$API_BASE_URL/login&quot;
</code></pre>

<p>Now, we need to update our main <code>WebFragment</code> (which is inherited by our sub fragments like the modal one) to catch redirects to these specific routes and stop the navigation and instead apply their native behavior in the navigation stack:</p>

<pre><code class="language-kotlin">package com.example.turbochirpernative.features.web

import android.os.Bundle
import android.view.LayoutInflater
import android.view.View
import android.view.ViewGroup
import com.example.turbochirpernative.R

// Add these imports:
import com.example.turbochirpernative.util.RECEDE_HISTORICAL_URL
import com.example.turbochirpernative.util.REFRESH_HISTORICAL_URL
import com.example.turbochirpernative.util.RESUME_HISTORICAL_URL

import dev.hotwire.turbo.fragments.TurboWebFragment
import dev.hotwire.turbo.nav.TurboNavGraphDestination

@TurboNavGraphDestination(uri = &quot;turbo://fragment/web&quot;)
open class WebFragment: TurboWebFragment() {
    override fun onCreateView(inflater: LayoutInflater, container: ViewGroup?, savedInstanceState: Bundle?): View? {
        return inflater.inflate(R.layout.fragment_web, container, false)
    }

    // Add this:
    override fun shouldNavigateTo(newLocation: String): Boolean {
        return when (newLocation) {
            RECEDE_HISTORICAL_URL -&gt; {
                navigateBack()
                false
            }
            REFRESH_HISTORICAL_URL -&gt; {
                refresh()
                false
            }
            RESUME_HISTORICAL_URL -&gt; {
                false
            }
            else -&gt; super.shouldNavigateTo(newLocation)
        }
    }
}
</code></pre>

<p>Now, if we try creating or updating a <em>Chirp</em>, we should see the web flash messages appearing!</p>

<p><img src="/assets/images/bootcamp/native/flash-messages-web-on-native.png" alt="Web Flash Messages on Native" /></p>

<h2>Flash as Toast Messages</h2>

<p>It's cool that we're showing the web flash messages, but it would be even better if we could instead convert those messages to appear as real native Toasts, don't you think?! So, let's implement that.</p>

<p>First, we'll need to hide the flash messages wrapper, so they don't appear in a Hotwire Native context. We can do that using the <code>turbo-native:</code> Tailwind variant we already have. Open the <code>resources/views/layouts/notifications.blade.php</code> file and update its contents:</p>

<pre><code class="language-blade"><span class="hl-comment">&lt;!-- Update the root element: --&gt;</span>
&lt;<span class="hl-keyword">div</span> <span class="hl-property">id</span>=&quot;notifications&quot; <span class="hl-property">class</span>=&quot;fixed top-10 left-0 w-full text-center flex flex-col items-center space-y-2 justify-center z-10 opacity-80 turbo-native:hidden&quot;&gt;
    <span class="hl-keyword">@if</span> (<span class="hl-variable">$message</span> = <span class="hl-property">session</span>()-&gt;<span class="hl-property">get</span>(<span class="hl-value">'status'</span>, <span class="hl-keyword">null</span>))
        <span class="hl-keyword">@include</span>(<span class="hl-value">'layouts.notification'</span>, [<span class="hl-value">'message'</span> =&gt; <span class="hl-variable">$message</span>])
    <span class="hl-keyword">@endif</span>
&lt;/<span class="hl-keyword">div</span>&gt;
</code></pre>

<p>With that, the flash messages shouldn't appear in Hotwire Native clients, but they should still appear in the web ones.</p>

<p>Next, let's create a bridge Stimulus controller that will send a message to the Native client to show convert those web flash messages into native ones.</p>

<pre><code class="language-bash">php artisan stimulus:make bridge/toast_controller
</code></pre>

<p>We'll update the notification view (the singular one) and make it use the controller we just created. It's important to note that the bridge controller needs to be listed before all other controllers:</p>

<pre><code class="language-blade">&lt;<span class="hl-keyword">div</span> <span class="hl-property">data-turbo-cache</span>=&quot;false&quot; <span class="hl-property">class</span>=&quot;py-1 px-4 leading-7 text-center text-white rounded-full bg-gray-900 transition-all animate-appear-then-fade&quot; <span class="hl-property">data-controller</span>=&quot;bridge--toast notification&quot; <span class="hl-property">data-action</span>=&quot;animationend-&gt;notification#remove&quot;&gt;
    {{ <span class="hl-variable">$message</span> }}
&lt;/<span class="hl-keyword">div</span>&gt;
</code></pre>

<p>Now, let's implement our Stimulus Toast controller:</p>

<pre><code class="language-js"><span class="hl-keyword">import</span> { Controller } <span class="hl-keyword">from</span> <span class="hl-value">&quot;@hotwired/stimulus&quot;</span>
<span class="hl-keyword">import</span> { isMobileApp } <span class="hl-keyword">from</span> <span class="hl-value">&quot;../../helpers/platform&quot;</span>

<span class="hl-comment">// Connects to data-controller=&quot;bridge--toast&quot;</span>
<span class="hl-keyword">export</span> <span class="hl-keyword">default</span> <span class="hl-keyword">class</span> <span class="hl-keyword">extends</span> Controller {
    <span class="hl-property">connect</span>() {
        <span class="hl-keyword">if</span> (! <span class="hl-keyword">this</span>.<span class="hl-property">enabled</span>) <span class="hl-keyword">return</span>

        window.<span class="hl-type">NativeBridge</span>.<span class="hl-property">showToast</span>(<span class="hl-keyword">this</span>.<span class="hl-property">element</span>.<span class="hl-property">textContent</span>.<span class="hl-property">trim</span>())
        <span class="hl-keyword">this</span>.<span class="hl-property">element</span>.<span class="hl-property">remove</span>();
    }

    <span class="hl-keyword">get</span> <span class="hl-property">enabled</span>() {
        <span class="hl-keyword">return</span> isMobileApp
    }
}
</code></pre>

<p>It will simply read the text content of the flash message and pass it up to the native client to as a toast, then it removes the flash element from the page.</p>

<p>Now, we need to implement the <code>showToast</code> handling in our <code>MainSessionNavHostFragment</code>:</p>

<pre><code class="language-kotlin">package com.example.turbochirpernative.main

// ...
import android.widget.Toast // Add this

class MainSessionNavHostFragment : TurboSessionNavHostFragment(), PopupMenuDelegator {
    // ...

    // Add this:
    override fun showToast(msg: String) {
        activity?.runOnUiThread {
            Toast
                .makeText(requireContext(), msg, Toast.LENGTH_SHORT)
                .show()
        }
    }

    // ...
}

interface PopupMenuDelegator {
    fun showPopupMenu(options: PopupMenu);
    fun showToast(msg: String); // Add this
    fun showConfirmationModal(msg: String);
}

class JsBridge(private var delegator: PopupMenuDelegator) {
    // ...

    // Add this:
    @JavascriptInterface
    fun showToast(msg: String) {
        delegator.showToast(msg)
    }

    @JavascriptInterface
    fun showConfirmationModal(msg: String) {
        delegator.showConfirmationModal(msg)
    }
}
</code></pre>

<p>Now, we should have the native Toast messages!</p>

<p><img src="/assets/images/bootcamp/native/flash-messages-toast.png" alt="Flash Messages as Toast" /></p>

<p>What is cool about this is that we have full control over the text message shown in the notification from our web app! Let's change the message to use an emoji, for instance:</p>

<p><img src="/assets/images/bootcamp/native/flash-message-changed-emoji-native.png" alt="Flash Messages Deleted With Emoji on Native" />
<img src="/assets/images/bootcamp/native/flash-message-changed-emoji-web.png" alt="Flash Messages Deleted With Emoji on Web" /></p>

<p>That's it!</p>
        </div>

                    <div class="mt-4 grid grid-cols-1 lg:grid-cols-2 gap-6">
      <div class="relative space-y-1 p-4 rounded border border-zinc-900/10 shadow transition hover:bg-zinc-900/5">
      <div class="text-sm font-heading font-extrabold text-zinc-900/30 uppercase">Previous</div>
      <a class="font-heading font-extrabold text-zinc-900/80" href="/bootcamp/native-confirmation">Native Confirmation Dialog <span class="absolute inset-0"></span></a>
    </div>
  
      <div class="lg:col-start-2 relative space-y-1 p-4 rounded border border-zinc-900/10 shadow transition hover:bg-zinc-900/5">
      <div class="text-sm font-heading font-extrabold text-zinc-900/30 uppercase">Next</div>
      <a class="font-heading font-extrabold text-zinc-900/80" href="/bootcamp/conclusion">Conclusion <span class="absolute inset-0"></span></a>
    </div>
  </div>
              </main>
    </div>
  </div>

        <footer class="px-6 py-4 sm:px-20 sm:py-10 flex items-center space-x-2 justify-between">
          <p class="text-base text-center w-full">
            Turbo Laravel is maintained by <a href="https://tonysm.com" class="underline text-zinc-900/90">Tony Messias</a>. This is a <em>community project</em>, therefore not affiliated with Laravel nor Hotwire.
          </p>
        </footer>
    </body>
</html>
