<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <link rel="canonical" href="https://turbo-laravel.com/bootcamp/search">
        <meta name="description" content="Website and documentation for the Turbo Laravel package.">
        <title>Turbo Laravel</title>
        <link rel="apple-touch-icon" sizes="180x180" href="/assets/manifest/apple-touch-icon.png">
        <link rel="icon" type="image/png" sizes="32x32" href="/assets/manifest/favicon-32x32.png">
        <link rel="icon" type="image/png" sizes="16x16" href="/assets/manifest/favicon-16x16.png">
        <link rel="manifest" href="/assets/site.webmanifest">
        <link rel="preload" href="/assets/fonts/OpenSans-ExtraBold.ttf" as="font" type="font/ttf" crossorigin>
        <link rel="preload" href="/assets/fonts/Jost-Regular.woff2" as="font" type="font/woff2" crossorigin>
        <link rel="preload" href="/assets/fonts/Jost-Italic.woff2" as="font" type="font/woff2" crossorigin>
        <link rel="stylesheet" href="/assets/build/css/main.css?id=4d73d68534fb60a6d8714799848a8219">
        <script defer src="/assets/build/js/main.js?id=b0f29cd4e71d41b4ee570d0f42344180"></script>
    </head>
    <body class="text-zinc-900 text-xl font-sans antialiased bg-zinc-700/5 min-h-screen" data-controller="search" data-action="keydown@window->search#focus">
        <header class="px-4 py-6 lg:px-10 xl:px-20 lg:py-10 flex items-center space-x-2 justify-between">
  <div class="relative flex-1 lg:flex-auto flex justify-between items-center space-x-4 sm:space-x-2">
    <h1 class="text-3xl sm:text-4xl font-extrabold font-heading">
      <a href="/">Turbo Laravel</a>
    </h1>

    <nav class="inline-block lg:hidden">
      <details class="group" data-search-target="nav">
        <summary class="list-none">
          <span>
            <span class="sr-only">Navigation</span>

            <svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-8 rotate-0 transition group-open:rotate-90">
              <path class="opacity-100 transition group-open:opacity-0" stroke-linecap="round" stroke-linejoin="round" d="M3.75 6.75h16.5M3.75 12h16.5m-16.5 5.25h16.5" />
              <path class="transition opacity-0 group-open:opacity-100" stroke-linecap="round" stroke-linejoin="round" d="M6 18 18 6M6 6l12 12" />
            </svg>
          </span>
        </summary>

        <div class="bg-white/50 z-10 absolute top-12 -inset-x-4 backdrop-blur-xl">
          <div class="bg-zinc-700/5 px-4 py-6 backdrop-blur">
            <form action="/docs/search" method="GET" class="px-4">
  <label for="search" class="sr-only">Search</label>
  <input data-search-target="mobile" type="search" name="q" class="search-input rounded border border-zinc-900/5 px-4 py-2 text-base leading-3 shadow w-full" placeholder="Search 2.x docs..." />
  <button type="submit" class="sr-only">Search</button>
</form>

            <ul class="space-y-6 -mb-2 mt-4">
              <li>
                <a href="/docs" class="px-4 py-2 font-medium rounded-full transition hover:bg-white/90 flex items-center space-x-1">
                  <span>Documentation</span>
                </a>

                              </li>
              <li>
                <a href="https://github.com/hotwired-laravel/turbo-laravel" class="px-4 py-2 font-medium rounded-full transition hover:bg-zinc-900/20">Source Code</a>
              </li>
              <li class="space-y-6">
                <a href="/bootcamp/introduction" class="px-4 py-2 font-medium rounded-full transition hover:bg-white/90">Bootcamp</a>
                  <div class="mx-4 pl-3 border-l-4 border-zinc-900/30">
  <ul class="">
        <li class="px-2 py-1 font-heading font-extrabold uppercase text-sm text-zinc-900/40">Prologue</li>
    <li class="children mt-2">
      <ul class="list-inside space-y-1 text-lg">
                <li><a href="/bootcamp/introduction" class=" transition hover:bg-zinc-900/20 w-full inline-block px-2 py-1">Introduction</a></li>
              </ul>
    </li>
        <li class="px-2 py-1 font-heading font-extrabold uppercase text-sm text-zinc-900/40">Web</li>
    <li class="children mt-2">
      <ul class="list-inside space-y-1 text-lg">
                <li><a href="/bootcamp/installation" class=" transition hover:bg-zinc-900/20 w-full inline-block px-2 py-1">Installation</a></li>
                <li><a href="/bootcamp/creating-chirps" class=" transition hover:bg-zinc-900/20 w-full inline-block px-2 py-1">Creating Chirps</a></li>
                <li><a href="/bootcamp/listing-chirps" class=" transition hover:bg-zinc-900/20 w-full inline-block px-2 py-1">Listing Chirps</a></li>
                <li><a href="/bootcamp/editing-chirps" class=" transition hover:bg-zinc-900/20 w-full inline-block px-2 py-1">Editing Chirps</a></li>
                <li><a href="/bootcamp/deleting-chirps" class=" transition hover:bg-zinc-900/20 w-full inline-block px-2 py-1">Deleting Chirps</a></li>
                <li><a href="/bootcamp/hotwiring-everything" class=" transition hover:bg-zinc-900/20 w-full inline-block px-2 py-1">Hotwiring Everything</a></li>
                <li><a href="/bootcamp/broadcasting" class=" transition hover:bg-zinc-900/20 w-full inline-block px-2 py-1">Broadcasting</a></li>
              </ul>
    </li>
        <li class="px-2 py-1 font-heading font-extrabold uppercase text-sm text-zinc-900/40">Native</li>
    <li class="children mt-2">
      <ul class="list-inside space-y-1 text-lg">
                <li><a href="/bootcamp/native-setup" class=" transition hover:bg-zinc-900/20 w-full inline-block px-2 py-1">Installation</a></li>
                <li><a href="/bootcamp/native-auth" class=" transition hover:bg-zinc-900/20 w-full inline-block px-2 py-1">Authentication</a></li>
                <li><a href="/bootcamp/native-bridge-component" class=" transition hover:bg-zinc-900/20 w-full inline-block px-2 py-1">Our First Bridge Component</a></li>
                <li><a href="/bootcamp/native-editing-modal" class=" transition hover:bg-zinc-900/20 w-full inline-block px-2 py-1">Editing as a Modal</a></li>
                <li><a href="/bootcamp/native-confirmation" class=" transition hover:bg-zinc-900/20 w-full inline-block px-2 py-1">Native Confirmation Dialog</a></li>
                <li><a href="/bootcamp/native-toasts" class=" transition hover:bg-zinc-900/20 w-full inline-block px-2 py-1">Native Toasts</a></li>
              </ul>
    </li>
        <li class="px-2 py-1 font-heading font-extrabold uppercase text-sm text-zinc-900/40">Epilogue</li>
    <li class="children mt-2">
      <ul class="list-inside space-y-1 text-lg">
                <li><a href="/bootcamp/conclusion" class=" transition hover:bg-zinc-900/20 w-full inline-block px-2 py-1">Conclusion</a></li>
              </ul>
    </li>
      </ul>
</div>
              </li>
              <!-- <li><a href="/demo" class="px-4 py-2 font-medium rounded-full transition hover:bg-white/90">Demo</a></li> -->
            </ul>
          </div>
        </div>
      </details>
    </nav>
  </div>

  <nav class="hidden lg:block">
    <ul class="flex items-center space-x-6 -my-2">
      <li>
        <div class="group relative py-2">
          <a href="/docs" class=" px-4 py-2 font-medium rounded-full transition hover:bg-white/90 flex items-center space-x-1">
            <span>Documentation</span>

            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-5">
              <path stroke-linecap="round" stroke-linejoin="round" d="m19.5 8.25-7.5 7.5-7.5-7.5" />
            </svg>
          </a>

          <div class="absolute p-4 top-14 inset-x opacity-0 scale-0 -translate-y-8 transition group-hover:translate-y-0 group-hover:scale-100 group-hover:opacity-100 rounded bg-white shadow z-10">
            <ul class="space-y-1">
              <li><a href="/docs/installation" class="block px-2 py-1 bg-zinc-900/20 rounded">Version <span class="">2.2.0</span></a></li>
              <li><a href="/1.x/docs/installation" class="block px-2 py-1  rounded">Version <span class="">1.12.2</span></a></li>
            </ul>
          </div>
        </div>
      </li>
      <li><a href="https://github.com/hotwired-laravel/turbo-laravel" class="px-4 py-2 font-medium rounded-full transition hover:bg-white/90">Source Code</a></li>
      <li><a href="/bootcamp/introduction" class="bg-white/90 px-4 py-2 font-medium rounded-full transition hover:bg-white/90">Bootcamp</a></li>
      <!-- <li><a href="/demo" class=" px-4 py-2 font-medium rounded-full transition hover:bg-white/90">Demo</a></li> -->
    </ul>
  </nav>
</header>

          <div class="bg-white/90 custom-border px-6 py-20 sm:flex space-x-6">
    <div class="sm:flex sm:space-x-6 sm:max-w-7xl w-full mx-auto">
      <aside class="relative w-1/4 hidden lg:block" data-search-target="aside">
        <div class="sticky top-4 block space-y-4">
            <form action="/bootcamp/search" method="GET">
  <label for="search" class="sr-only">Search</label>
  <input data-search-target="web" type="text" name="q" placeholder="Search bootcamp... (press &quot;/&quot; to focus)" class="search-input rounded border border-zinc-900/5 px-4 py-2 text-base leading-3 shadow w-full" />
</form>

            <ul class="[&_.children]:mb-4">
    <li class="px-2 py-1 font-heading font-extrabold uppercase text-sm text-zinc-900/40">Prologue</li>
  <li class="children mt-2">
    <ul class="list-inside space-y-1 text-lg">
            <li><a href="/bootcamp/introduction" class=" transition hover:bg-zinc-900/20 w-full inline-block px-2 py-1 rounded">Introduction</a></li>
          </ul>
  </li>
    <li class="px-2 py-1 font-heading font-extrabold uppercase text-sm text-zinc-900/40">Web</li>
  <li class="children mt-2">
    <ul class="list-inside space-y-1 text-lg">
            <li><a href="/bootcamp/installation" class=" transition hover:bg-zinc-900/20 w-full inline-block px-2 py-1 rounded">Installation</a></li>
            <li><a href="/bootcamp/creating-chirps" class=" transition hover:bg-zinc-900/20 w-full inline-block px-2 py-1 rounded">Creating Chirps</a></li>
            <li><a href="/bootcamp/listing-chirps" class=" transition hover:bg-zinc-900/20 w-full inline-block px-2 py-1 rounded">Listing Chirps</a></li>
            <li><a href="/bootcamp/editing-chirps" class=" transition hover:bg-zinc-900/20 w-full inline-block px-2 py-1 rounded">Editing Chirps</a></li>
            <li><a href="/bootcamp/deleting-chirps" class=" transition hover:bg-zinc-900/20 w-full inline-block px-2 py-1 rounded">Deleting Chirps</a></li>
            <li><a href="/bootcamp/hotwiring-everything" class=" transition hover:bg-zinc-900/20 w-full inline-block px-2 py-1 rounded">Hotwiring Everything</a></li>
            <li><a href="/bootcamp/broadcasting" class=" transition hover:bg-zinc-900/20 w-full inline-block px-2 py-1 rounded">Broadcasting</a></li>
          </ul>
  </li>
    <li class="px-2 py-1 font-heading font-extrabold uppercase text-sm text-zinc-900/40">Native</li>
  <li class="children mt-2">
    <ul class="list-inside space-y-1 text-lg">
            <li><a href="/bootcamp/native-setup" class=" transition hover:bg-zinc-900/20 w-full inline-block px-2 py-1 rounded">Installation</a></li>
            <li><a href="/bootcamp/native-auth" class=" transition hover:bg-zinc-900/20 w-full inline-block px-2 py-1 rounded">Authentication</a></li>
            <li><a href="/bootcamp/native-bridge-component" class=" transition hover:bg-zinc-900/20 w-full inline-block px-2 py-1 rounded">Our First Bridge Component</a></li>
            <li><a href="/bootcamp/native-editing-modal" class=" transition hover:bg-zinc-900/20 w-full inline-block px-2 py-1 rounded">Editing as a Modal</a></li>
            <li><a href="/bootcamp/native-confirmation" class=" transition hover:bg-zinc-900/20 w-full inline-block px-2 py-1 rounded">Native Confirmation Dialog</a></li>
            <li><a href="/bootcamp/native-toasts" class=" transition hover:bg-zinc-900/20 w-full inline-block px-2 py-1 rounded">Native Toasts</a></li>
          </ul>
  </li>
    <li class="px-2 py-1 font-heading font-extrabold uppercase text-sm text-zinc-900/40">Epilogue</li>
  <li class="children mt-2">
    <ul class="list-inside space-y-1 text-lg">
            <li><a href="/bootcamp/conclusion" class=" transition hover:bg-zinc-900/20 w-full inline-block px-2 py-1 rounded">Conclusion</a></li>
          </ul>
  </li>
  </ul>
        </div>
      </aside>

      <main class="flex-1 min-w-0">
        <div class="prose prose-xl overflow-hidden prose-zinc [&_code:not(pre_code)]:text-wrap [&_code:not(pre_code)]:break-words prose-headings:font-heading prose-headings:font-extrabold max-w-none mx-auto w-full">
              <h2>Search results for <em id="search-term" class="text-zinc-900/40"></em></h2>

  <div id="search-results"></div>

  <script>
  window.store = {
          "introduction": {
        "title": "Introduction",
        "content": "&quot;Lean how to make Hotwired web apps using Laravel. And when we&#039;re finished with the web app, we&#039;ll dive into the Hotwire Native side of Hotwire so we can see how it bridges the web and native worlds!\n\nTo explore the many sides of Hotwire, we&#039;ll build a micro-blogging platform called Turbo Chirper. Many parts of this tutorial were inspired by the official Laravel Bootcamp adapted to work better in a Hotwired app.\n\nWe&#039;ll use Importmap Laravel and TailwindCSS Laravel instead of Laravel&#039;s default Vite setup. Vite would work, but I&#039;m taking this opportunity to demonstrate an alternative front-end setup. If you&#039;re already familiar with Vite, feel free to choose the turbo-vite stack when setting up the application in the installation guide.\n\nOn the JavaScript side, we&#039;ll use Stimulus.js. Turbo Breeze - the starter kit we&#039;ll use - comes with all the same components in Laravel Breeze, reimplemented in Stimulus, so you won&#039;t miss out on anything. Also, most of the time, we&#039;re able to quickly convert Alpine components into Stimulus controllers.\n\nLet&#039;s get started!\n\nWeb\n\nIn the Web Tutorial, we&#039;re gonna build our majestic web app using Laravel and Turbo Laravel that will serve as basis for the second part of the tutorial which focuses on Hotwire Native and Android.\n\nStart the Web Tutorial...\n\nNative\n\nThe second part of this Bootcamp will focus on Hotwire Native. The goal is to showcase the Native side of Hotwire. We&#039;re going to use Android and Kotlin to build a fully native wrapper around our web app and progressively enhance the UX for mobile users.&quot;",
        "url": "https://turbo-laravel.com/bootcamp/introduction",
      },
          "installation": {
        "title": "Installation",
        "content": "&quot;Our first step is to create the web app and setup our local environment. This bootcamp assumes you have PHP installed on your system.\n\nInstalling Laravel\n\nYou may create a new Laravel project using Composer:\n\ncomposer create-project laravel\/laravel turbo-chirper\n\n\nAfter the project has been created, start Laravel&#039;s local development server using the Laravel&#039;s Artisan CLI serve command:\n\ncd turbo-chirper\/\n\nphp artisan serve\n\n\nOnce you have started the Artisan development server, your application will be accessible in your web browser at http:\/\/localhost:8000.\n\n\n\nBy default, the Laravel app will be created using SQLite.\n\nInstalling Turbo Breeze\n\nNext, we&#039;ll give our application a head-start by installing Turbo Breeze, a minimal, simple implementation of all of Laravel&#039;s authentication features, including login, registration, password reset, email verification, and password confirmation. Once installed, you are welcome to customize the components to suit your needs.\n\nTurbo Breeze offers two stack options: turbo, which comes with Importmap Laravel and TailwindCSS Laravel installed for a Node-less setup, and a turbo-vite option, which relies on having Node and NPM. For this tutorial, we&#039;ll be using turbo.\n\nOpen a new terminal in your turbo-chirper project directory and install your chosen stack with the given commands:\n\ncomposer require hotwired-laravel\/turbo-breeze:1.x-dev --dev\n\nphp artisan turbo-breeze:install turbo --dark\n\n\nTurbo Breeze will install and configure your front-end dependencies for you. It should have built the initial version of our assets for us.\n\nThe welcome page should now have the Login and Register links at the top:\n\n\n\nAnd you should be able to head to the \/register route and create your own account:\n\n\n\nThen, you should be redirected to the Dashboard page:\n\n\n\nThis Dashboard page is protected by Laravel&#039;s auth middleware, so only authenticated users can access it. The registration process automatically authenticates us.\n\nTurbo Breeze is a fork of Laravel Breeze, but customized to work better in a Hotwired context. It comes with all the same components as Laravel Breeze does, except they were rewritten in Stimulus. For an introduction to Stimulus, head out to the Stimulus Handbook.\n\nThere are a couple differences between Turbo Breeze and Laravel Breeze. In Laravel Breeze, your name at the top of the navigation bar is a dropdown. In Turbo Breeze, it&#039;s a link to a page with the menu:\n\n\n\nIn Laravel Breeze, all the profile forms are rendered in the same page. In Turbo Breeze, each one has its own dedicated page. That&#039;s not a requirement for Hotwired apps, but it works best in a mobile context. We&#039;ll see more about that later in this bootcamp.\n\nNow we&#039;re ready for our first feature!&quot;",
        "url": "https://turbo-laravel.com/bootcamp/installation",
      },
          "creating-chirps": {
        "title": "Creating Chirps",
        "content": "&quot;Let&#039;s allow users to post short messages called Chirps.\n\nModels, migrations, and controllers\n\nTo allow users to post Chirps, we&#039;ll use migrations, models, and controllers. Let&#039;s briefly cover those concepts:\n\n\nModels provide a powerful and enjoyable interface for you to interact with the tables in your database.\nMigrations allow you to easily create and modify the tables in your database. They ensure that the same database structure exists everywhere that your application runs.\nControllers are responsible for processing requests made to your application and returning a response.\n\n\nAlmost every feature you build will involve all of these pieces working together in harmony, so the artisan make:model command can create them all for you at once.\n\nLet&#039;s create a model, migration, and resource controller for our Chirps with the following command:\n\nphp artisan make:model -mcr Chirp\n\n\nYou can see all the available options by using the --help option, like php artisan make:model --help.\n\nThis command will create three files:\n\n\napp\/Models\/Chirp.php - The Eloquent model.\ndatabase\/migrations\/&amp;lt;timestamp&amp;gt;_create_chirps_table.php - The database migration that will create the database table.\napp\/Http\/Controller\/ChirpController.php - The HTTP controller that will take incoming requests and return responses.\n\n\nRouting\n\nWe will also need to create URLs for our controller. We can do this by adding \&quot;routes\&quot;, which are managed in the routes directory of your project. Because we&#039;re using a resource controller, we can use a single Route::resource() statement to define all of the routes following a conventional URL structure.\n\nTo start with, we are going to enable three routes:\n\n\nThe index route will display our listing of Chirps.\nThe create route will display the form to create Chirps.\nThe store route will be used for saving new Chirps.\n\n\nWe are also going to place these routes behind two middlewares:\n\n\nThe auth middleware ensures that only logged-in users can access the route.\nThe verified middleware will be used if you decide to enable email verification.\n\n\n\n\nuse App\\Http\\Controllers\\ChirpController; \nuse App\\Http\\Controllers\\ProfileController;\nuse App\\Http\\Controllers\\ProfilePasswordController;\nuse Illuminate\\Support\\Facades\\Route;\n\n\/\/ ...\n\nRoute::get(&#039;\/dashboard&#039;, function () {\n    return view(&#039;dashboard&#039;);\n})-&amp;gt;middleware([&#039;auth&#039;, &#039;verified&#039;])-&amp;gt;name(&#039;dashboard&#039;);\n\nRoute::resource(&#039;chirps&#039;, ChirpController::class)\n    -&amp;gt;only([&#039;index&#039;, &#039;create&#039;, &#039;store&#039;])\n    -&amp;gt;middleware([&#039;auth&#039;, &#039;verified&#039;]); \n\nRoute::middleware(&#039;auth&#039;)-&amp;gt;group(function () {\n    \/\/ ...\n});\n\nrequire __DIR__.&#039;\/auth.php&#039;;\n\n\n\n\nThis will create the following routes:\n\n\n\n\n  Verb\n  URI\n  Action\n  Route Name\n\n\n\n\n  GET\n  \/chirps\n  index\n  chirps.index\n\n\n  GET\n  \/chirps\/create\n  create\n  chirps.create\n\n\n  POST\n  \/chirps\n  store\n  chirps.store\n\n\n\n\nYou may view all of the routes for your application by running the php artisan route:list command.\n\nLet&#039;s test our route and controller by returning a test message from the index method of our new ChirpController class:\n\n\n\n&amp;lt;?php\n\n\/\/ ...\n\nclass ChirpController extends Controller\n{\n    public function index()\n    {\n        \/\/\n        return &#039;Hello, World!&#039;;\n    }\n\n    \/\/ ...\n}\n\n\n\n\nIf you are still logged in from earlier, you should see your message when navigating to http:\/\/localhost:8000\/chirps, or http:\/\/localhost\/chirps if you&#039;re using Sail!\n\nAdding The Form\n\nLet&#039;s update our index action in the ChirpController to render the view that will display the listing of Chirps and a link to create a Chirp. We&#039;ll also update the create action to render the view that will display the form to create Chirps:\n\n\n\n&amp;lt;?php\n\n\/\/ ...\n\nclass ChirpController extends Controller\n{\n    public function index()\n    {\n        return &#039;Hello, World&#039;;\n        return view(&#039;chirps.index&#039;, [\n            \/\/\n        ]);\n    }\n\n    public function create()\n    {\n        \/\/\n        return view(&#039;chirps.create&#039;, [\n            \/\/\n        ]);\n    }\n\n    \/\/ ...\n}\n\n\n\n\nWe can then create our chirps.index view with a link to our form for creating new Chirps:\n\n\n\n&amp;lt;x-app-layout&amp;gt;\n    &amp;lt;x-slot name=&amp;quot;header&amp;quot;&amp;gt;\n        &amp;lt;h2 class=&amp;quot;flex items-center space-x-1 font-semibold text-xl text-gray-800 dark:text-gray-200 leading-tight&amp;quot;&amp;gt;\n            &amp;lt;x-breadcrumbs :links=&amp;quot;[__(&#039;Chirps&#039;)]&amp;quot; \/&amp;gt;\n        &amp;lt;\/h2&amp;gt;\n    &amp;lt;\/x-slot&amp;gt;\n\n    &amp;lt;div class=&amp;quot;py-12&amp;quot;&amp;gt;\n        &amp;lt;div class=&amp;quot;max-w-2xl mx-auto sm:px-6 lg:px-8 space-y-6&amp;quot;&amp;gt;\n            &amp;lt;div class=&amp;quot;p-4 sm:p-8 bg-white dark:bg-gray-800 shadow sm:rounded-lg&amp;quot;&amp;gt;\n                &amp;lt;div class=&amp;quot;max-w-xl mx-auto&amp;quot;&amp;gt;\n                    {{&#039;@&#039;}}include(&#039;chirps.partials.new-chirp-trigger&#039;)\n                &amp;lt;\/div&amp;gt;\n            &amp;lt;\/div&amp;gt;\n        &amp;lt;\/div&amp;gt;\n    &amp;lt;\/div&amp;gt;\n&amp;lt;\/x-app-layout&amp;gt;\n\n\n\n\nThis view is including a partial called new-chirp-trigger, so create the partial with the following content:\n\n\n\n&amp;lt;div class=&amp;quot;relative flex items-center justify-center py-10 px-4 rounded-lg border border-dotted border-gray-300 dark:border-gray-600&amp;quot;&amp;gt;\n    &amp;lt;a class=&amp;quot;text-gray-700 dark:text-gray-500&amp;quot; href=&amp;quot;@{{ route(&#039;chirps.create&#039;) }}&amp;quot;&amp;gt;\n        @{{ __(&#039;New Chirp&#039;) }}\n        &amp;lt;span class=&amp;quot;absolute inset-0&amp;quot;&amp;gt;&amp;lt;\/span&amp;gt;\n    &amp;lt;\/a&amp;gt;\n&amp;lt;\/div&amp;gt;\n\n\n\n\nThen, let&#039;s create our chirps.create page view with the Chirps form:\n\n\n\n&amp;lt;x-app-layout :title=&amp;quot;__(&#039;Create Chirp&#039;)&amp;quot;&amp;gt;\n    &amp;lt;x-slot name=&amp;quot;header&amp;quot;&amp;gt;\n        &amp;lt;h2 class=&amp;quot;flex items-center space-x-1 font-semibold text-xl text-gray-800 dark:text-gray-200 leading-tight&amp;quot;&amp;gt;\n            &amp;lt;x-breadcrumbs :links=&amp;quot;[route(&#039;chirps.index&#039;) =&amp;gt; __(&#039;Chirps&#039;), __(&#039;New Chirp&#039;)]&amp;quot; \/&amp;gt;\n        &amp;lt;\/h2&amp;gt;\n    &amp;lt;\/x-slot&amp;gt;\n\n    &amp;lt;div class=&amp;quot;py-12&amp;quot;&amp;gt;\n        &amp;lt;div class=&amp;quot;max-w-2xl mx-auto sm:px-6 lg:px-8 space-y-6&amp;quot;&amp;gt;\n            &amp;lt;div class=&amp;quot;p-4 sm:p-8 bg-white dark:bg-gray-800 shadow sm:rounded-lg&amp;quot;&amp;gt;\n                &amp;lt;div class=&amp;quot;max-w-xl mx-auto&amp;quot;&amp;gt;\n                    {{&#039;@&#039;}}include(&#039;chirps.partials.form&#039;)\n                &amp;lt;\/div&amp;gt;\n            &amp;lt;\/div&amp;gt;\n        &amp;lt;\/div&amp;gt;\n    &amp;lt;\/div&amp;gt;\n&amp;lt;\/x-app-layout&amp;gt;\n\n\n\n\nAgain, this view is including a form partial. Create that file with the following content:\n\n\n\n&amp;lt;form action=&amp;quot;@{{ route(&#039;chirps.store&#039;) }}&amp;quot; method=&amp;quot;POST&amp;quot; class=&amp;quot;w-full&amp;quot;&amp;gt;\n    {{&#039;@&#039;}}csrf\n\n    &amp;lt;div&amp;gt;\n        &amp;lt;x-input-label for=&amp;quot;message&amp;quot; :value=&amp;quot;__(&#039;Message&#039;)&amp;quot; class=&amp;quot;sr-only&amp;quot; \/&amp;gt;\n        &amp;lt;x-textarea-input id=&amp;quot;message&amp;quot; name=&amp;quot;message&amp;quot; placeholder=&amp;quot;@{{ __(&#039;What\\&#039;s on your mind?&#039;) }}&amp;quot; class=&amp;quot;block w-full&amp;quot; \/&amp;gt;\n        &amp;lt;x-input-error :messages=&amp;quot;$errors-&amp;gt;get(&#039;message&#039;)&amp;quot; class=&amp;quot;mt-2&amp;quot; \/&amp;gt;\n    &amp;lt;\/div&amp;gt;\n\n    &amp;lt;div class=&amp;quot;mt-6&amp;quot;&amp;gt;\n        &amp;lt;x-primary-button&amp;gt;\n            @{{ __(&#039;Chirp&#039;) }}\n        &amp;lt;\/x-primary-button&amp;gt;\n    &amp;lt;\/div&amp;gt;\n&amp;lt;\/form&amp;gt;\n\n\n\n\nThis partial is making use a Blade component that doesn&#039;t exist yet called x-textarea-input, let&#039;s create it:\n\n\n\n{{&#039;@&#039;}}props([&#039;disabled&#039; =&amp;gt; false, &#039;value&#039; =&amp;gt; &#039;&#039;])\n\n&amp;lt;textarea @{{ $disabled ? &#039;disabled&#039; : &#039;&#039; }} @{!! $attributes-&amp;gt;merge([&#039;class&#039; =&amp;gt; &#039;border-gray-300 dark:border-gray-700 dark:bg-gray-900 dark:text-gray-300 focus:border-indigo-500 dark:focus:border-indigo-600 focus:ring-indigo-500 dark:focus:ring-indigo-600 rounded-md shadow-sm&#039;]) !!}&amp;gt;@{{ $value }}&amp;lt;\/textarea&amp;gt;\n\n\n\n\nThat&#039;s it! Refresh the page in your browser to see your new form rendered in the default layout provided by Breeze!\n\n\n\nIf you click on that link, you will see the form to create Chirps and the breadcrumbs should also have been updated:\n\n\n\nNavigation menu\n\nLet&#039;s take a moment to add a link to the navigation menu provided by Turbo Breeze.\n\nUpdate the navigation partial provided by Turbo Breeze to add a menu item for desktop screens:\n\n\n\n&amp;lt;!-- Navigation Links --&amp;gt;\n&amp;lt;div class=&amp;quot;hidden space-x-8 sm:-my-px sm:ms-10 sm:flex&amp;quot;&amp;gt;\n    &amp;lt;x-nav-link :href=&amp;quot;route(&#039;dashboard&#039;)&amp;quot; :active=&amp;quot;request()-&amp;gt;routeIs(&#039;dashboard&#039;)&amp;quot;&amp;gt;\n        @{{ __(&#039;Dashboard&#039;) }}\n    &amp;lt;\/x-nav-link&amp;gt;\n\n    &amp;lt;x-nav-link :href=&amp;quot;route(&#039;chirps.index&#039;)&amp;quot; :active=&amp;quot;request()-&amp;gt;routeIs(&#039;chirps.*&#039;)&amp;quot;&amp;gt;\n        @{{ __(&#039;Chirps&#039;) }}\n    &amp;lt;\/x-nav-link&amp;gt;\n&amp;lt;\/div&amp;gt;\n\n\n\n\nDon&#039;t forget the responsive menu:\n\n\n\n&amp;lt;!-- Responsive Navigation Menu --&amp;gt;\n&amp;lt;div class=&amp;quot;hidden group-data-[responsive-nav-open-value=true]:block sm:group-data-[responsive-nav-open-value=true]:hidden&amp;quot;&amp;gt;\n    &amp;lt;div class=&amp;quot;pt-2 pb-3 space-y-1&amp;quot;&amp;gt;\n        &amp;lt;x-responsive-nav-link :href=&amp;quot;route(&#039;dashboard&#039;)&amp;quot; :active=&amp;quot;request()-&amp;gt;routeIs(&#039;dashboard&#039;)&amp;quot;&amp;gt;\n            @{{ __(&#039;Dashboard&#039;) }}\n        &amp;lt;\/x-responsive-nav-link&amp;gt;\n\n        &amp;lt;x-responsive-nav-link :href=&amp;quot;route(&#039;chirps.index&#039;)&amp;quot; :active=&amp;quot;request()-&amp;gt;routeIs(&#039;chirps.*&#039;)&amp;quot;&amp;gt;\n            @{{ __(&#039;Chirps&#039;) }}\n        &amp;lt;\/x-responsive-nav-link&amp;gt;\n    &amp;lt;\/div&amp;gt;\n&amp;lt;\/div&amp;gt;\n\n\n\n\nWe should see the Chirps link on the page nav now:\n\n\n\nSaving the Chirp\n\nOur form has been configured to post messages to the chirps.store route that we created earlier. Let&#039;s update the store action on our ChirpController class to validate the data and create a new Chirp:\n\n\n\n&amp;lt;?php\n\n\/\/ ...\n\nclass ChirpController extends Controller\n{\n    \/\/ ...\n\n    public function store(Request $request)\n    {\n        \/\/\n        $validated = $request-&amp;gt;validate([\n            &#039;message&#039; =&amp;gt; [&#039;required&#039;, &#039;string&#039;, &#039;max:255&#039;],\n        ]);\n\n        $request-&amp;gt;user()-&amp;gt;chirps()-&amp;gt;create($validated);\n\n        return redirect()-&amp;gt;route(&#039;chirps.index&#039;);\n    }\n\n    \/\/ ...\n}\n\n\n\n\nWe&#039;re using Laravel&#039;s powerful validation feature to ensure that the user provides a message and that it won&#039;t exceed the 255 character limit of the database column we&#039;ll be creating.\n\nWe&#039;re then creating a record that will belong to the logged in user by leveraging a chirps relationship. We will define that relationship soon.\n\nFinally, we can return a redirect response to our chirps.index route.\n\nCreating a relationship\n\nYou may have noticed in the previous step that we called a chirps method on the $request-&amp;gt;user() object. We need to create this method on our User model to define a \&quot;has many\&quot; relationship:\n\n\n\n&amp;lt;?php\n\nnamespace App\\Models;\n\n\/\/ ...\n\nclass User extends Authenticatable\n{\n    use HasApiTokens, HasFactory, Notifiable;\n\n    \/\/ ...\n\n    public function chirps()\n    {\n        return $this-&amp;gt;hasMany(Chirp::class);\n    }\n}\n\n\n\n\nLaravel offers many different types of model relationships that you can read more about in the Eloquent Relationships documentation.\n\nMass assignment protection\n\nPassing all of the data from a request to your model can be risky. Imagine you have a page where users can edit their profiles. If you were to pass the entire request to the model, then a user could edit any column they like, such as an is_admin column. This is called a mass assignment vulnerability.\n\nLaravel protects you from accidentally doing this by blocking mass assignment by default. Mass assignment is very convenient though, as it prevents you from having to assign each attribute one-by-one. We can enable mass assignment for safe attributes by marking them as \&quot;fillable\&quot;.\n\nLet&#039;s add the $fillable property to our Chirp model to enable mass-assignment for the message attribute:\n\n\n\n&amp;lt;?php\n\n\/\/ ...\n\nclass Chirp extends Model\n{\n    use HasFactory;\n\n    protected $fillable = [\n        &#039;message&#039;,\n    ];\n}\n\n\n\n\nYou can learn more about Laravel&#039;s mass assignment protection in the documentation.\n\nUpdating the migration\n\nThe only thing missing is extra columns in our database to store the relationship between a Chirp and its User and the message itself. Remember the database migration we created earlier? It&#039;s time to open that file to add some extra columns:\n\n\n\n&amp;lt;?php\n\nuse Illuminate\\Database\\Migrations\\Migration;\nuse Illuminate\\Database\\Schema\\Blueprint;\nuse Illuminate\\Support\\Facades\\Schema;\n\nreturn new class extends Migration\n{\n    public function up()\n    {\n        Schema::create(&#039;chirps&#039;, function (Blueprint $table) {\n            $table-&amp;gt;id();\n            $table-&amp;gt;foreignId(&#039;user_id&#039;)-&amp;gt;constrained()-&amp;gt;cascadeOnDelete();\n            $table-&amp;gt;string(&#039;message&#039;);\n            $table-&amp;gt;timestamps();\n        });\n    }\n\n    \/\/ ...\n};\n\n\n\n\nWe haven&#039;t migrated the database since we added this migration, so let do it now:\n\nphp artisan migrate\n\n\nEach database migration will only be run once. To make additional changes to a table, you will need to create another migration. During development, you may wish to update an undeployed migration and rebuild your database from scratch using the php artisan migrate:fresh command.\n\nTesting it out\n\nWe&#039;re now ready to send a Chirp using the form we just created! We won&#039;t be able to see the result yet because we haven&#039;t displayed existing Chirps on the page.\n\n\n\nIf you leave the message field empty, or enter more than 255 characters, then you&#039;ll see the validation in action.\n\nArtisan Tinker\n\nThis is great time to learn about Artisan Tinker, a REPL (Read-eval-print loop) where you can execute arbitrary PHP code in your Laravel application.\n\nIn your console, start a new tinker session:\n\nphp artisan tinker\n\n\nNext, execute the following code to display the Chirps in your database:\n\nApp\\Models\\Chirp::all();\n\n\n=&amp;gt; Illuminate\\Database\\Eloquent\\Collection {#4634\n     all: [\n       App\\Models\\Chirp {#4636\n         id: 1,\n         user_id: 1,\n         message: &amp;quot;Hello World!&amp;quot;,\n         created_at: &amp;quot;2023-11-26 19:53:33&amp;quot;,\n         updated_at: &amp;quot;2023-11-26 19:53:33&amp;quot;,\n       },\n     ],\n   }\n\n\nYou may exit Tinker by using the exit command, or by pressing Ctrl + c.\n\nFlash Messages\n\nBefore we move on from creating Chirps, let&#039;s add the ability to show flash messages to the users. This may be useful to tell them that something happened in our app.\n\nSince we&#039;re redirecting the user to another page and redirects happens in the browser (client side), we&#039;d need a way to store messages across requests. Laravel has a feature called Flash Data which does exactly that! With that, we can safely store a flash message in the user&#039;s session, just so we can retrive it from there after the redirect happens in the user&#039;s browser.\n\nLet&#039;s update our store action in the ChirpController to also return a flash message named notice in the redirect:\n\n\n\n&amp;lt;?php\n\n\/\/ ...\n\nclass ChirpController extends Controller\n{\n    \/\/ ...\n\n    public function store(Request $request)\n    {\n        $validated = $request-&amp;gt;validate([\n            &#039;message&#039; =&amp;gt; [&#039;required&#039;, &#039;string&#039;, &#039;max:255&#039;],\n        ]);\n\n        $request-&amp;gt;user()-&amp;gt;chirps()-&amp;gt;create($validated);\n\n        return redirect()-&amp;gt;route(&#039;chirps.index&#039;);\n        return redirect()\n            -&amp;gt;route(&#039;chirps.index&#039;)\n            -&amp;gt;with(&#039;notice&#039;, __(&#039;Chirp created.&#039;));\n    }\n\n    \/\/ ...\n}\n\n\n\n\nThen, let&#039;s change our layouts.app file to include a layouts.partials.notifications partial:\n\n\n\n&amp;lt;body class=&amp;quot;font-sans antialiased&amp;quot;&amp;gt;\n    &amp;lt;div class=&amp;quot;min-h-screen bg-gray-100&amp;quot;&amp;gt;\n        {{&#039;@&#039;}}include(&#039;layouts.partials.navigation&#039;)\n        {{&#039;@&#039;}}include(&#039;layouts.partials.notifications&#039;)\n\n        &amp;lt;!-- ... --&amp;gt;\n    &amp;lt;\/div&amp;gt;\n&amp;lt;\/body&amp;gt;\n\n\n\n\nNext, let&#039;s create the layouts.partials.notifications wrapper partial:\n\n\n\n&amp;lt;div id=&amp;quot;notifications&amp;quot; class=&amp;quot;fixed top-10 left-0 right-0 flex flex-col items-center justify-center space-y-2 z-10 opacity-80&amp;quot;&amp;gt;\n    {{&#039;@&#039;}}if (session()-&amp;gt;has(&#039;notice&#039;))\n        {{&#039;@&#039;}}include(&#039;layouts.partials.notice&#039;, [&#039;message&#039; =&amp;gt; session(&#039;notice&#039;)])\n    {{&#039;@&#039;}}endif\n&amp;lt;\/div&amp;gt;\n\n\n\n\nSo, each notification will render with the layouts.partials.notice (singular) partial and will be added to the wrapper partial. Let&#039;s add the individual notification partial:\n\n\n\n&amp;lt;div data-turbo-temporary data-controller=&amp;quot;flash&amp;quot; data-action=&amp;quot;animationend-&amp;gt;flash#remove&amp;quot; class=&amp;quot;py-1 px-4 leading-7 text-center text-white rounded-full bg-gray-900 transition-all animate-appear-then-fade-out&amp;quot;&amp;gt;\n    @{{ $message }}\n&amp;lt;\/div&amp;gt;\n\n\n\n\nThere are a few attributes I&#039;d like to briefly discuss here:\n\n\nThe data-turbo-temporary tells Turbo to remove this element from the Page Cache\nThe data-controller=\&quot;flash\&quot; is how we bind Stimulus controllers to an element. In this case, we&#039;re binding the flash controller, which is a controller that ships with Turbo Breeze and may be found at resources\/js\/controllers\/flash_controller.js\nThe data-action=\&quot;animationend-&amp;gt;flash#remove\&quot; is how we add event listeners and invoke Stimulus controller actions when those events happens. In this case, we&#039;re listening to a CSS3 event called animationend which is fired whenever a CSS animation ends. The animation is the one provided by the animation-appear-then-fade-out CSS class, it also comes from Turbo Breeze.\n\n\nNow, build our Tailwind CSS styles:\n\nphp artisan tailwindcss:build\n\n\nIf you create another Chirp now, you should see a nice notification message at the top:&quot;",
        "url": "https://turbo-laravel.com/bootcamp/creating-chirps",
      },
          "listing-chirps": {
        "title": "Listing Chirps",
        "content": "&quot;In the previous step we added the ability to create Chirps, now we&#039;re ready to display them!\n\nRetrieving the Chirps\n\nLet&#039;s update the index action our ChirpController to pass Chirps from every user to our chirps.index page.\n\n\n\n&amp;lt;?php\n\nnamespace App\\Http\\Controllers;\n\nuse App\\Models\\Chirp;\nuse Illuminate\\Http\\Request;\n\nclass ChirpController extends Controller\n{\n    public function index()\n    {\n        return view(&#039;chirps.index&#039;, [\n            \/\/\n            &#039;chirps&#039; =&amp;gt; Chirp::with(&#039;user&#039;)-&amp;gt;latest()-&amp;gt;get(),\n        ]);\n    }\n\n    \/\/ ...\n}\n\n\n\n\nHere we&#039;ve used Eloquent&#039;s with method to eager-load every Chirp&#039;s associated user&#039;s ID and name. We&#039;ve also used the latest scope to return the records in reverse-chronological order.\n\nReturning all Chirps at once won&#039;t scale in production. Take a look at Laravel&#039;s powerful pagination to improve performance.\n\nConnecting users to Chirps\n\nThe Chirp&#039;s user relationship hasn&#039;t been defined yet. To fix this, let&#039;s add a new \&quot;belongs to\&quot; relationship to our Chirp model:\n\n\n\n&amp;lt;?php\n\n\/\/ ...\n\nclass Chirp extends Model\n{\n    use HasFactory;\n\n    \/\/ ...\n\n    public function user()\n    {\n        return $this-&amp;gt;belongsTo(User::class);\n    }\n}\n\n\n\n\nThis relationship is the inverse of the \&quot;has many\&quot; relationship we created earlier on the User model.\n\nDisplaying The Chirps\n\nNext, update the chirps.index view so we can list all Chirps:\n\n\n\n&amp;lt;x-app-layout&amp;gt;\n    &amp;lt;x-slot name=&amp;quot;header&amp;quot;&amp;gt;\n        &amp;lt;h2 class=&amp;quot;flex items-center space-x-1 font-semibold text-xl text-gray-800 dark:text-gray-200 leading-tight&amp;quot;&amp;gt;\n            &amp;lt;x-breadcrumbs :links=&amp;quot;[__(&#039;Chirps&#039;)]&amp;quot; \/&amp;gt;\n        &amp;lt;\/h2&amp;gt;\n    &amp;lt;\/x-slot&amp;gt;\n\n    &amp;lt;div class=&amp;quot;py-12&amp;quot;&amp;gt;\n        &amp;lt;div class=&amp;quot;max-w-2xl mx-auto sm:px-6 lg:px-8 space-y-6&amp;quot;&amp;gt;\n            &amp;lt;div class=&amp;quot;p-4 sm:p-8 bg-white dark:bg-gray-800 shadow sm:rounded-lg&amp;quot;&amp;gt;\n                &amp;lt;div class=&amp;quot;max-w-xl mx-auto&amp;quot;&amp;gt;\n                    {{&#039;@&#039;}}include(&#039;chirps.partials.new-chirp-trigger&#039;)\n\n                    &amp;lt;div class=&amp;quot;mt-6 bg-white shadow-sm rounded-lg divide-y dark:bg-gray-700 dark:divide-gray-500&amp;quot;&amp;gt;\n                        {{&#039;@&#039;}}each(&#039;chirps.partials.chirp&#039;, $chirps, &#039;chirp&#039;)\n                    &amp;lt;\/div&amp;gt;\n                &amp;lt;\/div&amp;gt;\n            &amp;lt;\/div&amp;gt;\n        &amp;lt;\/div&amp;gt;\n    &amp;lt;\/div&amp;gt;\n&amp;lt;\/x-app-layout&amp;gt;\n\n\n\n\nFinally, let&#039;s create a chirps.partials.chirp Blade partial to display Chirp. This component will be responsible for displaying an individual Chirp:\n\n\n\n&amp;lt;div class=&amp;quot;p-6 flex space-x-2&amp;quot;&amp;gt;\n    &amp;lt;svg xmlns=&amp;quot;http:\/\/www.w3.org\/2000\/svg&amp;quot; class=&amp;quot;h-6 w-6 text-gray-600 dark:text-gray-400 -scale-x-100&amp;quot; fill=&amp;quot;none&amp;quot; viewBox=&amp;quot;0 0 24 24&amp;quot;\n        stroke=&amp;quot;currentColor&amp;quot; stroke-width=&amp;quot;2&amp;quot;&amp;gt;\n        &amp;lt;path stroke-linecap=&amp;quot;round&amp;quot; stroke-linejoin=&amp;quot;round&amp;quot;\n            d=&amp;quot;M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z&amp;quot; \/&amp;gt;\n    &amp;lt;\/svg&amp;gt;\n\n    &amp;lt;div class=&amp;quot;flex-1&amp;quot;&amp;gt;\n        &amp;lt;div class=&amp;quot;flex justify-between items-center&amp;quot;&amp;gt;\n            &amp;lt;div&amp;gt;\n                &amp;lt;span class=&amp;quot;text-gray-800 dark:text-gray-200&amp;quot;&amp;gt;@{{ $chirp-&amp;gt;user-&amp;gt;name }}&amp;lt;\/span&amp;gt;\n                &amp;lt;small class=&amp;quot;ml-2 text-sm text-gray-600 dark:text-gray-400&amp;quot;&amp;gt;@{{ $chirp-&amp;gt;created_at-&amp;gt;diffForHumans() }}&amp;lt;\/small&amp;gt;\n            &amp;lt;\/div&amp;gt;\n        &amp;lt;\/div&amp;gt;\n        &amp;lt;p class=&amp;quot;mt-4 text-lg text-gray-900 dark:text-gray-200&amp;quot;&amp;gt;@{{ $chirp-&amp;gt;message }}&amp;lt;\/p&amp;gt;\n    &amp;lt;\/div&amp;gt;\n&amp;lt;\/div&amp;gt;\n\n\n\n\nNow take a look in your browser to see the message you Chirped earlier!\n\n\n\nExtra Credit: Relative Dates\n\nRight now our chirp.blade.php partial formats the date as relative, but that&#039;s relative to the time it was rendered, not the current time. We can write it in a way that it would auto-update without requiring a page refresh using Local Time Laravel package.\n\nFirst, let&#039;s install it via Composer:\n\ncomposer require tonysm\/local-time-laravel\n\n\nThen, install JS package:\n\nphp artisan importmap:pin local-time\n\n\nNow, let&#039;s create our own lib setup file in the libs\/localtime.js file:\n\n\n\nimport LocalTime from &amp;quot;local-time&amp;quot;\nLocalTime.start()\n\n\n\n\nNext, update the libs\/index.js file to import it:\n\n\n\nimport &amp;quot;libs\/turbo&amp;quot;;\nimport &amp;quot;libs\/local-time&amp;quot;;\nimport &amp;quot;controllers&amp;quot;;\n\n\n\n\nThen we can use this package&#039;s component in our chirps._chirp Blade partial to display relative dates using the newly installed HTML elements:\n\n\n\n&amp;lt;div class=&amp;quot;p-6 flex space-x-2&amp;quot;&amp;gt;\n    &amp;lt;svg xmlns=&amp;quot;http:\/\/www.w3.org\/2000\/svg&amp;quot; class=&amp;quot;h-6 w-6 text-gray-600 dark:text-gray-400 -scale-x-100&amp;quot; fill=&amp;quot;none&amp;quot; viewBox=&amp;quot;0 0 24 24&amp;quot;\n        stroke=&amp;quot;currentColor&amp;quot; stroke-width=&amp;quot;2&amp;quot;&amp;gt;\n        &amp;lt;path stroke-linecap=&amp;quot;round&amp;quot; stroke-linejoin=&amp;quot;round&amp;quot;\n            d=&amp;quot;M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z&amp;quot; \/&amp;gt;\n    &amp;lt;\/svg&amp;gt;\n\n    &amp;lt;div class=&amp;quot;flex-1&amp;quot;&amp;gt;\n        &amp;lt;div class=&amp;quot;flex justify-between items-center&amp;quot;&amp;gt;\n            &amp;lt;div&amp;gt;\n                &amp;lt;span class=&amp;quot;text-gray-800 dark:text-gray-200&amp;quot;&amp;gt;@{{ $chirp-&amp;gt;user-&amp;gt;name }}&amp;lt;\/span&amp;gt;\n                &amp;lt;small class=&amp;quot;ml-2 text-sm text-gray-600 dark:text-gray-400&amp;quot;&amp;gt;@{{ $chirp-&amp;gt;created_at-&amp;gt;diffForHumans() }}&amp;lt;\/small&amp;gt;\n                &amp;lt;small class=&amp;quot;ml-2 text-sm text-gray-600 dark:text-gray-400&amp;quot;&amp;gt;&amp;lt;x-local-time-ago :value=&amp;quot;$chirp-&amp;gt;created_at&amp;quot; \/&amp;gt;&amp;lt;\/small&amp;gt;\n            &amp;lt;\/div&amp;gt;\n        &amp;lt;\/div&amp;gt;\n        &amp;lt;p class=&amp;quot;mt-4 text-lg text-gray-900 dark:text-gray-200&amp;quot;&amp;gt;@{{ $chirp-&amp;gt;message }}&amp;lt;\/p&amp;gt;\n    &amp;lt;\/div&amp;gt;\n&amp;lt;\/div&amp;gt;\n\n\n\n\nIf you refresh the page, you should see the date string and it quickly updates to the relative time ago. The real nice thing about this approach is that if you keep your browser tab opened while visiting the listing Chirps page, the relative time will update from time to time!&quot;",
        "url": "https://turbo-laravel.com/bootcamp/listing-chirps",
      },
          "editing-chirps": {
        "title": "Editing Chirps",
        "content": "&quot;Let&#039;s add a feature that&#039;s missing from other popular bird-themed microblogging platforms \u2014 the ability to edit Chirps!\n\nRouting\n\nFirst we will update our routes file to enable the chirps.edit and chirps.update routes for our resource controller:\n\n\n\n&amp;lt;?php\n\n\/\/ ...\n\nRoute::resource(&#039;chirps&#039;, ChirpController::class)\n    -&amp;gt;only([&#039;index&#039;, &#039;create&#039;, &#039;store&#039;])\n    -&amp;gt;only([&#039;index&#039;, &#039;create&#039;, &#039;store&#039;, &#039;edit&#039;, &#039;update&#039;])\n    -&amp;gt;middleware([&#039;auth&#039;, &#039;verified&#039;]);\n\n\/\/ ...\n\n\n\n\n\nOur route table for this controller now looks like this:\n\n\n\n\n  Verb\n  URI\n  Action\n  Route Name\n\n\n\n\n  GET\n  \/chirps\n  index\n  chirps.index\n\n\n  GET\n  \/chirps\/create\n  create\n  chirps.create\n\n\n  POST\n  \/chirps\n  store\n  chirps.store\n\n\n  GET\n  \/chirps\/{chirp}\/edit\n  edit\n  chirps.edit\n\n\n  PUT\/PATCH\n  \/chirps\/{chirp}\n  update\n  chirps.update\n\n\n\n\nUpdating our partial\n\nNext, let&#039;s update our chirps.partials.chirp Blade partial to have an edit form for existing Chirps.\n\nWe&#039;re going to use the &amp;lt;x-dropdown&amp;gt; component that comes with Turbo Breeze, which we&#039;ll only display to the Chirp author. We&#039;ll also display an indication if a Chirp has been edited by comparing the Chirp&#039;s created_at date with its updated_at date:\n\n\n\n&amp;lt;div class=&amp;quot;p-6 flex space-x-2&amp;quot;&amp;gt;\n    &amp;lt;svg xmlns=&amp;quot;http:\/\/www.w3.org\/2000\/svg&amp;quot; class=&amp;quot;h-6 w-6 text-gray-600 -scale-x-100&amp;quot; fill=&amp;quot;none&amp;quot; viewBox=&amp;quot;0 0 24 24&amp;quot; stroke=&amp;quot;currentColor&amp;quot; stroke-width=&amp;quot;2&amp;quot;&amp;gt;\n        &amp;lt;path stroke-linecap=&amp;quot;round&amp;quot; stroke-linejoin=&amp;quot;round&amp;quot; d=&amp;quot;M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z&amp;quot; \/&amp;gt;\n    &amp;lt;\/svg&amp;gt;\n\n    &amp;lt;div class=&amp;quot;flex-1&amp;quot;&amp;gt;\n        &amp;lt;div class=&amp;quot;flex justify-between items-center&amp;quot;&amp;gt;\n            &amp;lt;div&amp;gt;\n                &amp;lt;span class=&amp;quot;text-gray-800&amp;quot;&amp;gt;@{{ $chirp-&amp;gt;user-&amp;gt;name }}&amp;lt;\/span&amp;gt;\n                &amp;lt;small class=&amp;quot;ml-2 text-sm text-gray-600&amp;quot;&amp;gt;&amp;lt;x-local-time-ago :value=&amp;quot;$chirp-&amp;gt;created_at&amp;quot; \/&amp;gt;&amp;lt;\/small&amp;gt;\n                {{&#039;@&#039;}}unless ($chirp-&amp;gt;created_at-&amp;gt;eq($chirp-&amp;gt;updated_at))\n                &amp;lt;small class=&amp;quot;text-sm text-gray-600 dark:text-gray-500&amp;quot;&amp;gt; &amp;amp;middot; edited&amp;lt;\/small&amp;gt;\n                {{&#039;@&#039;}}endunless\n            &amp;lt;\/div&amp;gt;\n\n            {{&#039;@&#039;}}if (Auth::id() === $chirp-&amp;gt;user-&amp;gt;id)\n            &amp;lt;x-dropdown align=&amp;quot;right&amp;quot; width=&amp;quot;48&amp;quot;&amp;gt;\n                &amp;lt;x-slot name=&amp;quot;trigger&amp;quot;&amp;gt;\n                    &amp;lt;button&amp;gt;\n                        &amp;lt;svg xmlns=&amp;quot;http:\/\/www.w3.org\/2000\/svg&amp;quot; class=&amp;quot;h-4 w-4 text-gray-400&amp;quot; viewBox=&amp;quot;0 0 20 20&amp;quot; fill=&amp;quot;currentColor&amp;quot;&amp;gt;\n                            &amp;lt;path d=&amp;quot;M6 10a2 2 0 11-4 0 2 2 0 014 0zM12 10a2 2 0 11-4 0 2 2 0 014 0zM16 12a2 2 0 100-4 2 2 0 000 4z&amp;quot; \/&amp;gt;\n                        &amp;lt;\/svg&amp;gt;\n                    &amp;lt;\/button&amp;gt;\n                &amp;lt;\/x-slot&amp;gt;\n\n                &amp;lt;x-slot name=&amp;quot;content&amp;quot;&amp;gt;\n                    &amp;lt;x-dropdown-link href=&amp;quot;@{{ route(&#039;chirps.edit&#039;, $chirp) }}&amp;quot;&amp;gt;@{{ __(&#039;Edit&#039;) }}&amp;lt;\/x-dropdown-link&amp;gt;\n                &amp;lt;\/x-slot&amp;gt;\n            &amp;lt;\/x-dropdown&amp;gt;\n            {{&#039;@&#039;}}endif\n        &amp;lt;\/div&amp;gt;\n\n        &amp;lt;p class=&amp;quot;mt-4 text-lg text-gray-900&amp;quot;&amp;gt;@{{ $chirp-&amp;gt;message }}&amp;lt;\/p&amp;gt;\n    &amp;lt;\/div&amp;gt;\n&amp;lt;\/div&amp;gt;\n\n\n\n\nShowing the edit Chirp form\n\nWe can now update the edit action on our ChirpController class to show the form to edit Chirps. Even though we&#039;re only displaying the edit button to the author of the Chirp, we also need to authorize the request to make sure it&#039;s actually the author that is updating it:\n\n\n\n&amp;lt;?php\n\nnamespace App\\Http\\Controllers;\n\nuse App\\Models\\Chirp;\nuse Illuminate\\Foundation\\Auth\\Access\\AuthorizesRequests;\nuse Illuminate\\Http\\Request;\n\nclass ChirpController extends Controller\n{\n    use AuthorizesRequests;\n\n    \/\/ ...\n\n    public function edit(Chirp $chirp)\n    {\n        \/\/\n        $this-&amp;gt;authorize(&#039;update&#039;, $chirp);\n\n        return view(&#039;chirps.edit&#039;, [\n            &#039;chirp&#039; =&amp;gt; $chirp,\n        ]);\n    }\n\n    \/\/ ...\n}\n\n\n\n\nNow, we need to create our chirps.edit view:\n\n\n\n&amp;lt;x-app-layout :title=&amp;quot;__(&#039;Edit Chirp&#039;)&amp;quot;&amp;gt;\n    &amp;lt;x-slot name=&amp;quot;header&amp;quot;&amp;gt;\n        &amp;lt;h2 class=&amp;quot;flex items-center space-x-1 font-semibold text-xl text-gray-800 dark:text-gray-200 leading-tight&amp;quot;&amp;gt;\n            &amp;lt;x-breadcrumbs :links=&amp;quot;[route(&#039;chirps.index&#039;) =&amp;gt; __(&#039;Chirps&#039;), __(&#039;Edit Chirp&#039;)]&amp;quot; \/&amp;gt;\n        &amp;lt;\/h2&amp;gt;\n    &amp;lt;\/x-slot&amp;gt;\n\n    &amp;lt;div class=&amp;quot;py-12&amp;quot;&amp;gt;\n        &amp;lt;div class=&amp;quot;max-w-2xl mx-auto sm:px-6 lg:px-8 space-y-6&amp;quot;&amp;gt;\n            &amp;lt;div class=&amp;quot;p-4 sm:p-8 bg-white dark:bg-gray-800 shadow sm:rounded-lg&amp;quot;&amp;gt;\n                &amp;lt;div class=&amp;quot;max-w-xl mx-auto&amp;quot;&amp;gt;\n                    {{&#039;@&#039;}}include(&#039;chirps.partials.form&#039;, [&#039;chirp&#039; =&amp;gt; $chirp])\n                &amp;lt;\/div&amp;gt;\n            &amp;lt;\/div&amp;gt;\n        &amp;lt;\/div&amp;gt;\n    &amp;lt;\/div&amp;gt;\n&amp;lt;\/x-app-layout&amp;gt;\n\n\n\n\nWe&#039;re using the same form partial the create chirps view uses. However, in this case we&#039;re passing down a Chirp model to the form so it can pre-fill the message field. Since we&#039;re passing a Chirp model, we can make the form submit to the chirps.update endpoint instead of the default chirps.store one when no Chirp is passed. Let&#039;s make the changes to the chirps.partials.form partial, replace the existing form with this one:\n\n\n\n&amp;lt;form action=&amp;quot;@{{ ($chirp ?? false) ? route(&#039;chirps.update&#039;, $chirp) : route(&#039;chirps.store&#039;) }}&amp;quot; method=&amp;quot;POST&amp;quot; class=&amp;quot;w-full&amp;quot;&amp;gt;\n    {{&#039;@&#039;}}csrf\n    {{&#039;@&#039;}}if ($chirp ?? false)\n        {{&#039;@&#039;}}method(&#039;PUT&#039;)\n    {{&#039;@&#039;}}endif\n\n    &amp;lt;div&amp;gt;\n        &amp;lt;x-input-label for=&amp;quot;message&amp;quot; :value=&amp;quot;__(&#039;Message&#039;)&amp;quot; class=&amp;quot;sr-only&amp;quot; \/&amp;gt;\n        &amp;lt;x-textarea-input id=&amp;quot;message&amp;quot; name=&amp;quot;message&amp;quot; autofocus placeholder=&amp;quot;@{{ __(&#039;What\\&#039;s on your mind?&#039;) }}&amp;quot; class=&amp;quot;block w-full&amp;quot; :value=&amp;quot;old(&#039;message&#039;, $chirp?-&amp;gt;message ?? &#039;&#039;)&amp;quot; \/&amp;gt;\n        &amp;lt;x-input-error :messages=&amp;quot;$errors-&amp;gt;get(&#039;message&#039;)&amp;quot; class=&amp;quot;mt-2&amp;quot; \/&amp;gt;\n    &amp;lt;\/div&amp;gt;\n\n    &amp;lt;div class=&amp;quot;mt-6 flex items-center space-x-4&amp;quot;&amp;gt;\n        &amp;lt;x-primary-button&amp;gt;\n            @{{ __(&#039;Chirp&#039;) }}\n        &amp;lt;\/x-primary-button&amp;gt;\n\n        {{&#039;@&#039;}}if ($chirp ?? false)\n        &amp;lt;a href=&amp;quot;@{{ route(&#039;chirps.index&#039;) }}&amp;quot; class=&amp;quot;dark:text-gray-400&amp;quot;&amp;gt;@{{ __(&#039;Cancel&#039;) }}&amp;lt;\/a&amp;gt;\n        {{&#039;@&#039;}}endif\n    &amp;lt;\/div&amp;gt;\n&amp;lt;\/form&amp;gt;\n\n\n\n\nAuthorization\n\nBy default, the authorize method will prevent everyone from being able to update the Chirp. We can specify who is allowed to update it by creating a Model Policy with the following command:\n\nphp artisan make:policy ChirpPolicy --model=Chirp\n\n\nThis will create a policy class at app\/Policies\/ChirpPolicy.php which we can update to specify that only the author is authorized to update a Chirp:\n\n\n\n&amp;lt;?php\n\nnamespace App\\Policies;\n\nuse App\\Models\\Chirp;App\\\nuse App\\Models\\User;\nuse Illuminate\\Auth\\Access\\HandlesAuthorization;\n\nclass ChirpPolicy\n{\n    \/\/ ...\n\n    public function update(User $user, Chirp $chirp)\n    {\n        \/\/\n        return $user-&amp;gt;is($chirp-&amp;gt;user);\n    }\n\n    \/\/ ...\n}\n\n\n\n\nYou should be able to use the dropdown, click on the Edit link and view the edit Chirp form:\n\n\n\nUpdating Chirps\n\nWe can now change the update action on our ChirpController class to validate the request and update the database. Again, we also need to authorize the request here to make sure it&#039;s actually the author that is updating it:\n\n\n\n&amp;lt;?php\n\nnamespace App\\Http\\Controllers;\n\nuse App\\Models\\Chirp;\nuse Illuminate\\Foundation\\Auth\\Access\\AuthorizesRequests;\nuse Illuminate\\Http\\Request;\n\nclass ChirpController extends Controller\n{\n    \/\/ ...\n\n    public function update(Request $request, Chirp $chirp)\n    {\n        \/\/\n        $this-&amp;gt;authorize(&#039;update&#039;, $chirp);\n\n        $validated = $request-&amp;gt;validate([\n            &#039;message&#039; =&amp;gt; [&#039;required&#039;, &#039;string&#039;, &#039;max:255&#039;],\n        ]);\n\n        $chirp-&amp;gt;update($validated);\n\n        return redirect()\n            -&amp;gt;route(&#039;chirps.index&#039;)\n            -&amp;gt;with(&#039;notice&#039;, __(&#039;Chirp updated.&#039;));\n    }\n\n    \/\/ ...\n}\n\n\n\n\nYou may have noticed the validation rules are duplicated with the store action. You might consider extracting them using Laravel&#039;s Form Request Validation, which makes it easy to re-use validation rules and to keep your controllers light.\n\nTesting it out\n\nTime to test it out! Go ahead and edit a few Chirps using the dropdown menu. If you register another user account, you&#039;ll see that only the author of a Chirp can edit it.&quot;",
        "url": "https://turbo-laravel.com/bootcamp/editing-chirps",
      },
          "deleting-chirps": {
        "title": "Deleting Chirps",
        "content": "&quot;Sometimes no amount of editing can fix a message, so let&#039;s give our users the ability to delete their Chirps.\n\nHopefully you&#039;re starting to get the hang of things now. We think you&#039;ll be impressed how quickly we can add this feature.\n\nRouting\n\nLet&#039;s update our routes\/web.php file to add the new destroy action in our resource definition:\n\n\n\n\/\/ ...\n\nRoute::resource(&#039;chirps&#039;, ChirpController::class)\n    -&amp;gt;only([&#039;index&#039;, &#039;create&#039;, &#039;store&#039;, &#039;edit&#039;, &#039;update&#039;])\n    -&amp;gt;only([&#039;index&#039;, &#039;create&#039;, &#039;store&#039;, &#039;edit&#039;, &#039;update&#039;, &#039;destroy&#039;])\n    -&amp;gt;middleware([&#039;auth&#039;, &#039;verified&#039;]);\n\n\/\/ ...\n\n\n\n\n\nOur route table for this controller now looks like this:\n\n\n\n\n  Verb\n  URI\n  Action\n  Route Name\n\n\n\n\n  GET\n  \/chirps\n  index\n  chirps.index\n\n\n  GET\n  \/chirps\/create\n  create\n  chirps.create\n\n\n  POST\n  \/chirps\n  store\n  chirps.store\n\n\n  GET\n  \/chirps\/{chirp}\/edit\n  edit\n  chirps.edit\n\n\n  PUT\/PATCH\n  \/chirps\/{chirp}\n  update\n  chirps.update\n\n\n  DELETE\n  \/chirps\/{chirp}\n  destroy\n  chirps.destroy\n\n\n\n\nUpdating the Controller\n\nNow we can update the destroy action on our ChirpController class to perform the deletion and return to the Chirp index:\n\n\n\n&amp;lt;?php\n\n\/\/ ...\n\nclass ChirpController extends Controller\n{\n    \/\/ ...\n\n    public function destroy(Chirp $chirp)\n    {\n        \/\/\n        $this-&amp;gt;authorize(&#039;delete&#039;, $chirp);\n\n        $chirp-&amp;gt;delete();\n\n        return redirect()\n            -&amp;gt;route(&#039;chirps.index&#039;)\n            -&amp;gt;with(&#039;notice&#039;, __(&#039;Chirp deleted.&#039;));\n    }\n}\n\n\n\n\nAuthorization\n\nAs with editing, we only want our Chirp authors to be able to delete their Chirps, so let&#039;s update the delete method our ChirpPolicy class:\n\n\n\n&amp;lt;?php\n\n\/\/ ...\n\nclass ChirpPolicy\n{\n    \/\/ ...\n\n    public function delete(User $user, Chirp $chirp)\n    {\n        \/\/\n        return $user-&amp;gt;is($chirp-&amp;gt;user);\n    }\n\n    \/\/ ...\n}\n\n\n\n\nAlthough the logic of authorizing users to update or delete Chirps is pretty much the same for this demo app, chances are you may have different authorization policies in a real app. For that reason, we&#039;re leaving them separate.\n\nUpdating our Chirp partial\n\nFinally, we can add a delete button to the dropdown menu we created earlier in our chirps._chirp Blade partial:\n\n\n\n&amp;lt;div class=&amp;quot;p-6 flex space-x-2&amp;quot;&amp;gt;\n    &amp;lt;svg xmlns=&amp;quot;http:\/\/www.w3.org\/2000\/svg&amp;quot; class=&amp;quot;h-6 w-6 text-gray-600 dark:text-gray-400 -scale-x-100&amp;quot; fill=&amp;quot;none&amp;quot; viewBox=&amp;quot;0 0 24 24&amp;quot; stroke=&amp;quot;currentColor&amp;quot; stroke-width=&amp;quot;2&amp;quot;&amp;gt;\n        &amp;lt;path stroke-linecap=&amp;quot;round&amp;quot; stroke-linejoin=&amp;quot;round&amp;quot; d=&amp;quot;M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z&amp;quot; \/&amp;gt;\n    &amp;lt;\/svg&amp;gt;\n\n    &amp;lt;div class=&amp;quot;flex-1&amp;quot;&amp;gt;\n        &amp;lt;div class=&amp;quot;flex justify-between items-center&amp;quot;&amp;gt;\n            &amp;lt;div&amp;gt;\n                &amp;lt;span class=&amp;quot;text-gray-800 dark:text-gray-200&amp;quot;&amp;gt;@{{ $chirp-&amp;gt;user-&amp;gt;name }}&amp;lt;\/span&amp;gt;\n                &amp;lt;small class=&amp;quot;ml-2 text-sm text-gray-600 dark:text-gray-400&amp;quot;&amp;gt;&amp;lt;x-local-time-ago :value=&amp;quot;$chirp-&amp;gt;created_at&amp;quot; \/&amp;gt;&amp;lt;\/small&amp;gt;\n                {{&#039;@&#039;}}unless ($chirp-&amp;gt;created_at-&amp;gt;eq($chirp-&amp;gt;updated_at))\n                &amp;lt;small class=&amp;quot;text-sm text-gray-600&amp;quot;&amp;gt; &amp;amp;middot; edited&amp;lt;\/small&amp;gt;\n                {{&#039;@&#039;}}endunless\n            &amp;lt;\/div&amp;gt;\n\n            {{&#039;@&#039;}}if (Auth::id() === $chirp-&amp;gt;user-&amp;gt;id)\n            &amp;lt;x-dropdown align=&amp;quot;right&amp;quot; width=&amp;quot;48&amp;quot;&amp;gt;\n                &amp;lt;x-slot name=&amp;quot;trigger&amp;quot;&amp;gt;\n                    &amp;lt;button&amp;gt;\n                        &amp;lt;svg xmlns=&amp;quot;http:\/\/www.w3.org\/2000\/svg&amp;quot; class=&amp;quot;h-4 w-4 text-gray-400&amp;quot; viewBox=&amp;quot;0 0 20 20&amp;quot; fill=&amp;quot;currentColor&amp;quot;&amp;gt;\n                            &amp;lt;path d=&amp;quot;M6 10a2 2 0 11-4 0 2 2 0 014 0zM12 10a2 2 0 11-4 0 2 2 0 014 0zM16 12a2 2 0 100-4 2 2 0 000 4z&amp;quot; \/&amp;gt;\n                        &amp;lt;\/svg&amp;gt;\n                    &amp;lt;\/button&amp;gt;\n                &amp;lt;\/x-slot&amp;gt;\n\n                &amp;lt;x-slot name=&amp;quot;content&amp;quot;&amp;gt;\n                    &amp;lt;x-dropdown-link href=&amp;quot;@{{ route(&#039;chirps.edit&#039;, $chirp) }}&amp;quot;&amp;gt;@{{ __(&#039;Edit&#039;) }}&amp;lt;\/x-dropdown-link&amp;gt;\n\n                    &amp;lt;form action=&amp;quot;@{{ route(&#039;chirps.destroy&#039;, $chirp) }}&amp;quot; method=&amp;quot;POST&amp;quot;&amp;gt;\n                        {{&#039;@&#039;}}method(&#039;DELETE&#039;)\n                        &amp;lt;x-dropdown-button type=&amp;quot;submit&amp;quot;&amp;gt;@{{ __(&#039;Delete&#039;) }}&amp;lt;\/x-dropdown-button&amp;gt;\n                    &amp;lt;\/form&amp;gt;\n                &amp;lt;\/x-slot&amp;gt;\n            &amp;lt;\/x-dropdown&amp;gt;\n            {{&#039;@&#039;}}endif\n        &amp;lt;\/div&amp;gt;\n\n        &amp;lt;p class=&amp;quot;mt-4 text-lg text-gray-900&amp;quot;&amp;gt;@{{ $chirp-&amp;gt;message }}&amp;lt;\/p&amp;gt;\n    &amp;lt;\/div&amp;gt;\n&amp;lt;\/div&amp;gt;\n\n\n\n\nTesting it out\n\nIf you Chirped anything you weren&#039;t happy with, try deleting it!&quot;",
        "url": "https://turbo-laravel.com/bootcamp/deleting-chirps",
      },
          "hotwiring-everything": {
        "title": "Hotwiring Everything",
        "content": "&quot;So far, our application is quite basic. Out of Hotwire, we&#039;re only using Turbo Drive, which is enabled by default when we install and start Turbo.\n\nInline forms with Turbo Frames\n\nOur application works, but we could improve it. Instead of sending users to a dedicated chirp creation form page, let&#039;s display the form inline right on the chirps.index page. To do that, we&#039;re going to use lazy-loading Turbo Frames:\n\n\n\n&amp;lt;x-app-layout&amp;gt;\n    &amp;lt;x-slot name=&amp;quot;header&amp;quot;&amp;gt;\n        &amp;lt;h2 class=&amp;quot;flex items-center space-x-1 font-semibold text-xl text-gray-800 dark:text-gray-200 leading-tight&amp;quot;&amp;gt;\n            &amp;lt;x-breadcrumbs :links=&amp;quot;[__(&#039;Chirps&#039;)]&amp;quot; \/&amp;gt;\n        &amp;lt;\/h2&amp;gt;\n    &amp;lt;\/x-slot&amp;gt;\n\n    &amp;lt;div class=&amp;quot;py-12&amp;quot;&amp;gt;\n        &amp;lt;div class=&amp;quot;max-w-2xl mx-auto sm:px-6 lg:px-8 space-y-6&amp;quot;&amp;gt;\n            &amp;lt;div class=&amp;quot;p-4 sm:p-8 bg-white dark:bg-gray-800 shadow sm:rounded-lg&amp;quot;&amp;gt;\n                &amp;lt;div class=&amp;quot;max-w-xl mx-auto&amp;quot;&amp;gt;\n                    {{&#039;@&#039;}}include(&#039;chirps.partials.new-chirp-trigger&#039;)\n                    &amp;lt;x-turbo::frame id=&amp;quot;create_chirp&amp;quot; src=&amp;quot;@{{ route(&#039;chirps.create&#039;) }}&amp;quot;&amp;gt;\n                        {{&#039;@&#039;}}include(&#039;chirps.partials.new-chirp-trigger&#039;)\n                    &amp;lt;\/x-turbo::frame&amp;gt;\n\n                    &amp;lt;div class=&amp;quot;mt-6 bg-white shadow-sm rounded-lg divide-y dark:bg-gray-700 dark:divide-gray-500&amp;quot;&amp;gt;\n                        {{&#039;@&#039;}}each(&#039;chirps.partials.chirp&#039;, $chirps, &#039;chirp&#039;)\n                    &amp;lt;\/div&amp;gt;\n                &amp;lt;\/div&amp;gt;\n            &amp;lt;\/div&amp;gt;\n        &amp;lt;\/div&amp;gt;\n    &amp;lt;\/div&amp;gt;\n&amp;lt;\/x-app-layout&amp;gt;\n\n\n\n\nFor that to work, we also need to wrap our create form with a matching Turbo Frame (by \&quot;matching\&quot; I mean same DOM ID):\n\n\n\n&amp;lt;x-app-layout :title=&amp;quot;__(&#039;Create Chirp&#039;)&amp;quot;&amp;gt;\n    &amp;lt;x-slot name=&amp;quot;header&amp;quot;&amp;gt;\n        &amp;lt;h2 class=&amp;quot;flex items-center space-x-1 font-semibold text-xl text-gray-800 dark:text-gray-200 leading-tight&amp;quot;&amp;gt;\n            &amp;lt;x-breadcrumbs :links=&amp;quot;[route(&#039;chirps.index&#039;) =&amp;gt; __(&#039;Chirps&#039;), __(&#039;New Chirp&#039;)]&amp;quot; \/&amp;gt;\n        &amp;lt;\/h2&amp;gt;\n    &amp;lt;\/x-slot&amp;gt;\n\n    &amp;lt;div class=&amp;quot;py-12&amp;quot;&amp;gt;\n        &amp;lt;div class=&amp;quot;max-w-2xl mx-auto sm:px-6 lg:px-8 space-y-6&amp;quot;&amp;gt;\n            &amp;lt;div class=&amp;quot;p-4 sm:p-8 bg-white dark:bg-gray-800 shadow sm:rounded-lg&amp;quot;&amp;gt;\n                &amp;lt;div class=&amp;quot;max-w-xl mx-auto&amp;quot;&amp;gt;\n                    {{&#039;@&#039;}}include(&#039;chirps.partials.form&#039;)\n                    &amp;lt;x-turbo::frame id=&amp;quot;create_chirp&amp;quot; target=&amp;quot;_top&amp;quot;&amp;gt;\n                        {{&#039;@&#039;}}include(&#039;chirps.partials.form&#039;)\n                    &amp;lt;\/x-turbo::frame&amp;gt;\n                &amp;lt;\/div&amp;gt;\n            &amp;lt;\/div&amp;gt;\n        &amp;lt;\/div&amp;gt;\n    &amp;lt;\/div&amp;gt;\n&amp;lt;\/x-app-layout&amp;gt;\n\n\n\n\nA few things about this:\n\n\nIn the chirps.index, we specified the Turbo Frame with the src attribute, which indicates Turbo that this is lazy-loading Turbo Frame\nThe Turbo Frame in the chirps.create page has a target=\&quot;_top\&quot; on it. That&#039;s not gonna be used, it&#039;s just in case someone opens that page directly by visiting \/chirps\/create or disables JavaScript (in this case, they would still see the link pointing to the create chirps page, so they would be able to use our application normally)\n\n\nIf you try to use the form now, you will see a strange behavior where the form disappears after you submit it and the link is back. If you refresh the page, you&#039;ll see the chirp was successfully created.\n\nThat happens because we&#039;re redirecting users to the chirps.index page after the form submission. That page has a matching Turbo Frame, which contains the link. Nothing else on the page changes because of the Turbo Frame contains the page changes to only its fragment.\n\nLet&#039;s make use of Turbo Streams to update our form with a clean one and prepend the recently created Chirp to the chirps list.\n\nResetting the form and prepending Chirps to the list\n\nBefore we change the ChirpController, let&#039;s give our list of chirps wrapper element an ID in the chirps.index page:\n\n\n\n&amp;lt;x-app-layout&amp;gt;\n    &amp;lt;x-slot name=&amp;quot;header&amp;quot;&amp;gt;\n        &amp;lt;h2 class=&amp;quot;flex items-center space-x-1 font-semibold text-xl text-gray-800 dark:text-gray-200 leading-tight&amp;quot;&amp;gt;\n            &amp;lt;x-breadcrumbs :links=&amp;quot;[__(&#039;Chirps&#039;)]&amp;quot; \/&amp;gt;\n        &amp;lt;\/h2&amp;gt;\n    &amp;lt;\/x-slot&amp;gt;\n\n    &amp;lt;div class=&amp;quot;py-12&amp;quot;&amp;gt;\n        &amp;lt;div class=&amp;quot;max-w-2xl mx-auto sm:px-6 lg:px-8 space-y-6&amp;quot;&amp;gt;\n            &amp;lt;div class=&amp;quot;p-4 sm:p-8 bg-white dark:bg-gray-800 shadow sm:rounded-lg&amp;quot;&amp;gt;\n                &amp;lt;div class=&amp;quot;max-w-xl mx-auto&amp;quot;&amp;gt;\n                    &amp;lt;x-turbo::frame id=&amp;quot;create_chirp&amp;quot; src=&amp;quot;@{{ route(&#039;chirps.create&#039;) }}&amp;quot;&amp;gt;\n                        {{&#039;@&#039;}}include(&#039;chirps.partials.new-chirp-trigger&#039;)\n                    &amp;lt;\/x-turbo::frame&amp;gt;\n\n                    &amp;lt;div class=&amp;quot;mt-6 bg-white shadow-sm rounded-lg divide-y dark:bg-gray-700 dark:divide-gray-500&amp;quot;&amp;gt;\n                    &amp;lt;div id=&amp;quot;chirps&amp;quot; class=&amp;quot;mt-6 bg-white shadow-sm rounded-lg divide-y dark:bg-gray-700 dark:divide-gray-500&amp;quot;&amp;gt;\n                        {{&#039;@&#039;}}each(&#039;chirps.partials.chirp&#039;, $chirps, &#039;chirp&#039;)\n                    &amp;lt;\/div&amp;gt;\n                &amp;lt;\/div&amp;gt;\n            &amp;lt;\/div&amp;gt;\n        &amp;lt;\/div&amp;gt;\n    &amp;lt;\/div&amp;gt;\n&amp;lt;\/x-app-layout&amp;gt;\n\n\n\n\nOkay, now we can change the store action in our ChirpController to return 3 Turbo Streams if the client supports it, one to update the form with a clean one, another to prepend the new chirp to the list, and another to append the flash message:\n\n\n\n&amp;lt;?php\n\n\/\/ ...\n\nclass ChirpController extends Controller\n{\n    \/\/ ...\n\n    public function store(Request $request)\n    {\n        $validated = $request-&amp;gt;validate([\n            &#039;message&#039; =&amp;gt; [&#039;required&#039;, &#039;string&#039;, &#039;max:255&#039;],\n        ]);\n\n        $request-&amp;gt;user()-&amp;gt;chirps()-&amp;gt;create($validated);\n        $chirp = $request-&amp;gt;user()-&amp;gt;chirps()-&amp;gt;create($validated);\n\n        if ($request-&amp;gt;wantsTurboStream()) {\n            return turbo_stream([\n                turbo_stream($chirp, &#039;prepend&#039;),\n                turbo_stream()-&amp;gt;update(&#039;create_chirp&#039;, view(&#039;chirps.partials.form&#039;)),\n                turbo_stream()-&amp;gt;append(&#039;notifications&#039;, view(&#039;layouts.partials.notice&#039;, [\n                    &#039;message&#039; =&amp;gt; __(&#039;Chirp created.&#039;),\n                ])),\n            ]);\n        }\n\n        return redirect()\n            -&amp;gt;route(&#039;chirps.index&#039;)\n            -&amp;gt;with(&#039;status&#039;, __(&#039;Chirp created.&#039;));\n    }\n\n    \/\/ ...\n}\n\n\n\n\nIf you try to create one now, you&#039;ll notice Turbo Laravel expects to find the Chirp partial at resources\/views\/chirps\/_chirp.blade.php, but we are using a folder-based partial convention. This pattern is common in Laravel, so Turbo Laravel understands that as well. Let&#039;s update the package to use that. Update your AppServiceProvider like so:\n\n\n\n&amp;lt;?php\n\nnamespace App\\Providers;\n\nuse HotwiredLaravel\\TurboLaravel\\Facades\\Turbo;\nuse Illuminate\\Support\\ServiceProvider;\n\nclass AppServiceProvider extends ServiceProvider\n{\n    \/\/ ...\n\n    public function boot(): void\n    {\n        Turbo::usePartialsSubfolderPattern();\n    }\n}\n\n\n\n\nNow if you try creating a Chirp, you should see the newly created Chirp at the top of the chirps list, the form should have been cleared, and a flash message showed up.\n\n\n\nLet&#039;s also implement inline editing for our chirps.\n\nDisplaying the edit chirps form inline\n\nTo do that, we need to tweak our chirps.partials.chirp partial and wrap it with a Turbo Frame. Instead of showing you a long Git diff, replace the existing partial with this one:\n\n\n\n&amp;lt;div class=&amp;quot;p-6 flex space-x-2&amp;quot;&amp;gt;\n&amp;lt;x-turbo::frame :id=&amp;quot;$chirp&amp;quot; class=&amp;quot;p-6 flex space-x-2&amp;quot;&amp;gt;\n    &amp;lt;svg xmlns=&amp;quot;http:\/\/www.w3.org\/2000\/svg&amp;quot; class=&amp;quot;h-6 w-6 text-gray-600 dark:text-gray-400 -scale-x-100&amp;quot; fill=&amp;quot;none&amp;quot; viewBox=&amp;quot;0 0 24 24&amp;quot; stroke=&amp;quot;currentColor&amp;quot; stroke-width=&amp;quot;2&amp;quot;&amp;gt;\n        &amp;lt;!-- ... --&amp;gt;\n    &amp;lt;\/svg&amp;gt;\n\n    &amp;lt;div class=&amp;quot;flex-1&amp;quot;&amp;gt;\n        &amp;lt;!-- ... --&amp;gt;\n    &amp;lt;\/div&amp;gt;\n&amp;lt;\/div&amp;gt;\n&amp;lt;\/x-turbo::frame&amp;gt;\n\n\n\n\nNow, let&#039;s also update the chirps.edit page to add a wrapping Turbo Frame around the form there:\n\n\n\n&amp;lt;x-app-layout :title=&amp;quot;__(&#039;Edit Chirp&#039;)&amp;quot;&amp;gt;\n    &amp;lt;x-slot name=&amp;quot;header&amp;quot;&amp;gt;\n        &amp;lt;h2 class=&amp;quot;flex items-center space-x-1 font-semibold text-xl text-gray-800 dark:text-gray-200 leading-tight&amp;quot;&amp;gt;\n            &amp;lt;x-breadcrumbs :links=&amp;quot;[route(&#039;chirps.index&#039;) =&amp;gt; __(&#039;Chirps&#039;), __(&#039;Edit Chirp&#039;)]&amp;quot; \/&amp;gt;\n        &amp;lt;\/h2&amp;gt;\n    &amp;lt;\/x-slot&amp;gt;\n\n    &amp;lt;div class=&amp;quot;py-12&amp;quot;&amp;gt;\n        &amp;lt;div class=&amp;quot;max-w-2xl mx-auto sm:px-6 lg:px-8 space-y-6&amp;quot;&amp;gt;\n            &amp;lt;div class=&amp;quot;p-4 sm:p-8 bg-white dark:bg-gray-800 shadow sm:rounded-lg&amp;quot;&amp;gt;\n                &amp;lt;div class=&amp;quot;max-w-xl mx-auto&amp;quot;&amp;gt;\n                    {{&#039;@&#039;}}include(&#039;chirps.partials.form&#039;, [&#039;chirp&#039; =&amp;gt; $chirp])\n                    &amp;lt;x-turbo::frame :id=&amp;quot;$chirp&amp;quot; target=&amp;quot;_top&amp;quot;&amp;gt;\n                        {{&#039;@&#039;}}include(&#039;chirps.partials.form&#039;, [&#039;chirp&#039; =&amp;gt; $chirp])\n                    &amp;lt;\/x-turbo::frame&amp;gt;\n                &amp;lt;\/div&amp;gt;\n            &amp;lt;\/div&amp;gt;\n        &amp;lt;\/div&amp;gt;\n    &amp;lt;\/div&amp;gt;\n&amp;lt;\/x-app-layout&amp;gt;\n\n\n\n\nUpdating inline edit form with the chirps partial\n\nNow, if you try clicking on the edit button, you should see the form appearing inline! If you submit it, you will see the change takes place already. That&#039;s awesome, right? Well, not so much. See, we can see the change because after the chirp is updated, the controller redirects the user to the index page and it happens that the chirp is rendered on that page, so it finds a matching Turbo Frame. If that wasn&#039;t the case, we would see a strange behavior.\n\nLet&#039;s change the update action in the ChirpController to return a Turbo Stream with the updated Chirp partial if the client supports it:\n\n\n\n&amp;lt;?php\n\n\/\/ ...\n\nclass ChirpController extends Controller\n{\n    \/\/ ...\n\n    public function update(Request $request, Chirp $chirp)\n    {\n        $this-&amp;gt;authorize(&#039;update&#039;, $chirp);\n\n        $validated = $request-&amp;gt;validate([\n            &#039;message&#039; =&amp;gt; [&#039;required&#039;, &#039;string&#039;, &#039;max:255&#039;],\n        ]);\n\n        $chirp-&amp;gt;update($validated);\n\n        if ($request-&amp;gt;wantsTurboStream()) {\n            return turbo_stream([\n                turbo_stream($chirp),\n                turbo_stream()-&amp;gt;append(&#039;notifications&#039;, view(&#039;layouts.partials.notice&#039;, [\n                    &#039;message&#039; =&amp;gt; __(&#039;Chirp updated.&#039;),\n                ])),\n            ]);\n        }\n\n        return redirect()\n            -&amp;gt;route(&#039;chirps.index&#039;)\n            -&amp;gt;with(&#039;notice&#039;, __(&#039;Chirp updated.&#039;));\n    }\n\n    \/\/ ...\n}\n\n\n\n\nNow, if you try editing a chirp, you should see the same thing as before, but now we&#039;re sure that our chirp will just be updated no matter if it&#039;s present in the index listing of chirps or not after the form is submitted. Yay!\n\n\n\nDeleting Chirps with Turbo Streams\n\nIf you try deleting a Chirp now that they are wrapped in a turbo-frame you&#039;ll notice the Chirp itself is gone, but for the wrong reason. That happens because after deleting a Chirp, we&#039;re also redirecting users to the index page and it happens that there&#039;s no chirp in there because it&#039;s gone from the database. Since Turbo didn&#039;t find a matching Turbo Frame, it removes the frame&#039;s content!\n\nLet&#039;s change the destroy action in our ChirpController to respond with a remove Turbo Stream whenever a Chirp is deleted and the client supports it:\n\n\n\n&amp;lt;?php\n\n\/\/ ...\n\nclass ChirpController extends Controller\n{\n    \/\/ ...\n\n    public function destroy(Chirp $chirp)\n    {\n        $this-&amp;gt;authorize(&#039;delete&#039;, $chirp);\n\n        $chirp-&amp;gt;delete();\n\n        if (request()-&amp;gt;wantsTurboStream()) {\n            return turbo_stream([\n                turbo_stream($chirp),\n                turbo_stream()-&amp;gt;append(&#039;notifications&#039;, view(&#039;layouts.partials.notice&#039;, [\n                    &#039;message&#039; =&amp;gt; __(&#039;Chirp deleted.&#039;),\n                ])),\n            ]);\n        }\n\n        return redirect()\n            -&amp;gt;route(&#039;chirps.index&#039;)\n            -&amp;gt;with(&#039;notice&#039;, __(&#039;Chirp deleted.&#039;));\n    }\n}\n\n\n\n\nAnd that&#039;s it!\n\nTurbo Stream Flash Macro\n\nSo far we&#039;ve been using the default action methods provided by the Turbo Laravel package. Let&#039;s add a notice macro to the PendingTurboStreamResponse class, which the turbo_stream() function returns (except when we give it an array, which then it returns an instance of the MultiplePendingTurboStreamResponse class). This notice macro will work as a shorthand for the creating Turbo Streams to append notifications on the page:\n\n\n\n&amp;lt;?php\n\nnamespace App\\Providers;\n\nuse HotwiredLaravel\\TurboLaravel\\Facades\\Turbo;\nuse Illuminate\\Support\\ServiceProvider;\nuse HotwiredLaravel\\TurboLaravel\\Http\\PendingTurboStreamResponse;\n\nclass AppServiceProvider extends ServiceProvider\n{\n    public function boot()\n    {\n        Turbo::usePartialsSubfolderPattern();\n\n        PendingTurboStreamResponse::macro(&#039;notice&#039;, function ($message) {\n            return turbo_stream()-&amp;gt;append(&#039;notifications&#039;, view(&#039;layouts.partials.notice&#039;, [\n                &#039;message&#039; =&amp;gt; $message,\n            ]));\n        });\n    }\n}\n\n\n\n\nNow, our controllers can be cleaned up a bit:\n\n\n\n&amp;lt;?php\n\n\/\/ ...\n\nclass ChirpController extends Controller\n{\n    \/\/ ...\n\n    public function store(Request $request)\n    {\n        $validated = $request-&amp;gt;validate([\n            &#039;message&#039; =&amp;gt; [&#039;required&#039;, &#039;string&#039;, &#039;max:255&#039;],\n        ]);\n\n        $chirp = $request-&amp;gt;user()-&amp;gt;chirps()-&amp;gt;create($validated);\n\n        if ($request-&amp;gt;wantsTurboStream()) {\n            return turbo_stream([\n                turbo_stream($chirp, &#039;prepend&#039;),\n                turbo_stream()-&amp;gt;update(&#039;create_chirp&#039;, view(&#039;chirps.partials.form&#039;)),\n                turbo_stream()-&amp;gt;append(&#039;notifications&#039;, view(&#039;layouts.partials.notice&#039;, [\n                    &#039;message&#039; =&amp;gt; __(&#039;Chirp created.&#039;),\n                ])),\n                turbo_stream()-&amp;gt;notice(__(&#039;Chirp created.&#039;)),\n            ]);\n        }\n\n        return redirect()\n            -&amp;gt;route(&#039;chirps.index&#039;)\n            -&amp;gt;with(&#039;notice&#039;, __(&#039;Chirp created.&#039;));\n    }\n\n    public function update(Request $request, Chirp $chirp)\n    {\n        $this-&amp;gt;authorize(&#039;update&#039;, $chirp);\n\n        $validated = $request-&amp;gt;validate([\n            &#039;message&#039; =&amp;gt; [&#039;required&#039;, &#039;string&#039;, &#039;max:255&#039;],\n        ]);\n\n        $chirp-&amp;gt;update($validated);\n\n        if ($request-&amp;gt;wantsTurboStream()) {\n            return turbo_stream([\n                turbo_stream($chirp),\n                turbo_stream()-&amp;gt;append(&#039;notifications&#039;, view(&#039;layouts.partials.notice&#039;, [\n                    &#039;message&#039; =&amp;gt; __(&#039;Chirp updated.&#039;),\n                ])),\n                turbo_stream()-&amp;gt;notice(__(&#039;Chirp updated.&#039;)),\n            ]);\n        }\n\n        return redirect()\n            -&amp;gt;route(&#039;chirps.index&#039;)\n            -&amp;gt;with(&#039;notice&#039;, __(&#039;Chirp updated.&#039;));\n    }\n\n    public function destroy(Chirp $chirp)\n    {\n        $this-&amp;gt;authorize(&#039;delete&#039;, $chirp);\n\n        $chirp-&amp;gt;delete();\n\n        if (request()-&amp;gt;wantsTurboStream()) {\n            return turbo_stream([\n                turbo_stream($chirp),\n                turbo_stream()-&amp;gt;append(&#039;notifications&#039;, view(&#039;layouts.partials.notice&#039;, [\n                    &#039;message&#039; =&amp;gt; __(&#039;Chirp deleted.&#039;),\n                ])),\n                turbo_stream()-&amp;gt;notice(__(&#039;Chirp deleted.&#039;)),\n            ]);\n        }\n\n        return redirect()\n            -&amp;gt;route(&#039;chirps.index&#039;)\n            -&amp;gt;with(&#039;notice&#039;, __(&#039;Chirp deleted.&#039;));\n    }\n}\n\n\n\n\nAlthough this is using Macros, we&#039;re still using the Turbo Stream actions that ship with Turbo by default. It&#039;s also possible to go custom and create your own actions, if you want to.\n\nTesting it out\n\nWith these changes, our application behaves so much better than before! Try it out yourself!&quot;",
        "url": "https://turbo-laravel.com/bootcamp/hotwiring-everything",
      },
          "broadcasting": {
        "title": "Broadcasting",
        "content": "&quot;We can send the same Turbo Streams we&#039;re returning to our users after a form submission over WebSockets and update the page for all users visiting it! Broadcasts may be triggered automatically whenever a model updates or manually whenever you want to broadcast it.\n\nSetting Up Reverb\n\nLet&#039;s setup Reverb to handle our WebSockets connections.\n\nFirst, run the install:broadcasting Artisan command:\n\nphp artisan install:broadcasting\n\n\nWhen it asks if you want to install the Node dependencies, say \&quot;No\&quot;. After that, we&#039;ll install them manually with importamps:\n\nphp artisan importmap:pin laravel-echo pusher-js current.js\n\n\nNext, we&#039;ll need to update the published echo.js file. It currently uses import.meta.env.*, which requires a build step. Instead, we&#039;ll update it to use the current.js to read the configs from meta tags we&#039;ll add to our layouts. But first, replace the echo.js with the following version:\n\n\n\nimport Echo from &#039;laravel-echo&#039;;\n\nimport Pusher from &#039;pusher-js&#039;;\nwindow.Pusher = Pusher;\n\nimport { Current } from &#039;current.js&#039;;\nwindow.Current = Current;\n\nwindow.Echo = new Echo({\n    broadcaster: &#039;reverb&#039;,\n    key: Current.reverb.appKey,\n    wsHost: Current.reverb.host,\n    wsPort: Current.reverb.port ?? 80,\n    wssPort: Current.reverb.port ?? 443,\n    forceTLS: (Current.reverb.scheme ?? &#039;https&#039;) === &#039;https&#039;,\n    enabledTransports: [&#039;ws&#039;, &#039;wss&#039;],\n});\n\n\n\n\nWe also need to update the bootstrap.js file to fix the import that was appended by Reverb to the Importmap style:\n\n\n\n\/\/ ...\n\n\/**\n * Echo exposes an expressive API for subscribing to channels and listening\n * for events that are broadcast by Laravel. Echo and event broadcasting\n * allow your team to quickly build robust real-time web applications.\n *\/\n\nimport &#039;.\/echo&#039;;\nimport &#039;echo&#039;;\n\n\n\n\nNext, let&#039;s create a new layout partial at resources\/views\/layouts\/partials\/reverb.blade.php with the following content:\n\n\n\n&amp;lt;meta name=&amp;quot;current-reverb-app-key&amp;quot; content=&amp;quot;@{{ config(&#039;broadcasting.connections.reverb.key&#039;) }}&amp;quot; \/&amp;gt;\n&amp;lt;meta name=&amp;quot;current-reverb-host&amp;quot; content=&amp;quot;@{{ config(&#039;reverb.servers.reverb.frontend.host&#039;) }}&amp;quot; \/&amp;gt;\n&amp;lt;meta name=&amp;quot;current-reverb-port&amp;quot; content=&amp;quot;@{{ config(&#039;reverb.servers.reverb.frontend.port&#039;) }}&amp;quot; \/&amp;gt;\n&amp;lt;meta name=&amp;quot;current-reverb-scheme&amp;quot; content=&amp;quot;@{{ config(&#039;reverb.servers.reverb.frontend.scheme&#039;) }}&amp;quot; \/&amp;gt;\n\n\n\n\nThen, add that to the app.blade.php layout file:\n\n\n\n&amp;lt;!DOCTYPE html&amp;gt;\n&amp;lt;html lang=&amp;quot;@{{ str_replace(&#039;_&#039;, &#039;-&#039;, app()-&amp;gt;getLocale()) }}&amp;quot;&amp;gt;\n    &amp;lt;head&amp;gt;\n        &amp;lt;meta charset=&amp;quot;utf-8&amp;quot;&amp;gt;\n        &amp;lt;meta name=&amp;quot;viewport&amp;quot; content=&amp;quot;width=device-width, initial-scale=1&amp;quot;&amp;gt;\n        &amp;lt;meta name=&amp;quot;csrf-token&amp;quot; content=&amp;quot;@{{ csrf_token() }}&amp;quot;&amp;gt;\n\n        {{&#039;@&#039;}}if ($viewTransitions ?? false)\n        &amp;lt;meta name=&amp;quot;view-transition&amp;quot; content=&amp;quot;same-origin&amp;quot; \/&amp;gt;\n        {{&#039;@&#039;}}endif\n\n        {{&#039;@&#039;}}include(&#039;layouts.partials.reverb&#039;)\n\n        @{{ $meta ?? &#039;&#039; }}\n\n        &amp;lt;title&amp;gt;@{{ config(&#039;app.name&#039;, &#039;Laravel&#039;) }}&amp;lt;\/title&amp;gt;\n\n        &amp;lt;!-- ... --&amp;gt;\n    &amp;lt;\/head&amp;gt;\n\n    &amp;lt;!-- ... --&amp;gt;\n&amp;lt;\/html&amp;gt;\n\n\n\n\nDo the same for the guest layout:\n\n\n\n&amp;lt;!DOCTYPE html&amp;gt;\n&amp;lt;html lang=&amp;quot;@{{ str_replace(&#039;_&#039;, &#039;-&#039;, app()-&amp;gt;getLocale()) }}&amp;quot;&amp;gt;\n    &amp;lt;head&amp;gt;\n        &amp;lt;meta charset=&amp;quot;utf-8&amp;quot;&amp;gt;\n        &amp;lt;meta name=&amp;quot;viewport&amp;quot; content=&amp;quot;width=device-width, initial-scale=1&amp;quot;&amp;gt;\n        &amp;lt;meta name=&amp;quot;csrf-token&amp;quot; content=&amp;quot;@{{ csrf_token() }}&amp;quot;&amp;gt;\n\n        {{&#039;@&#039;}}if ($viewTransitions ?? false)\n        &amp;lt;meta name=&amp;quot;view-transition&amp;quot; content=&amp;quot;same-origin&amp;quot; \/&amp;gt;\n        {{&#039;@&#039;}}endif\n\n        {{&#039;@&#039;}}include(&#039;layouts.partials.reverb&#039;)\n\n        @{{ $meta ?? &#039;&#039; }}\n\n        &amp;lt;!-- ... --&amp;gt;\n    &amp;lt;\/head&amp;gt;\n\n    &amp;lt;!-- ... --&amp;gt;\n&amp;lt;\/html&amp;gt;\n\n\n\n\nThen, we need to tweak our .env file to look something like this:\n\n# ...\n\nBROADCAST_CONNECTION=reverb\n\nREVERB_APP_ID=[REDACTED]\nREVERB_APP_KEY=[REDACTED]\nREVERB_APP_SECRET=[REDACTED]\nREVERB_HOST=&amp;quot;reverb.test&amp;quot;\nREVERB_PORT=8080\nREVERB_SCHEME=http\n\nREVERB_FRONTEND_HOST=&amp;quot;localhost&amp;quot;\nREVERB_FRONTEND_PORT=&amp;quot;${REVERB_PORT}&amp;quot;\nREVERB_FRONTEND_SCHEME=&amp;quot;${REVERB_SCHEME}&amp;quot;\n\n\nWith that, our Reverb config needs to be updated to use the new frontend configs:\n\n\n\n&amp;lt;?php\n\nreturn [\n    \/\/ ...\n\n    &#039;servers&#039; =&amp;gt; [\n\n        &#039;reverb&#039; =&amp;gt; [\n            &#039;host&#039; =&amp;gt; env(&#039;REVERB_SERVER_HOST&#039;, &#039;0.0.0.0&#039;),\n            &#039;port&#039; =&amp;gt; env(&#039;REVERB_SERVER_PORT&#039;, 8080),\n            &#039;hostname&#039; =&amp;gt; env(&#039;REVERB_HOST&#039;),\n            &#039;options&#039; =&amp;gt; [\n                &#039;tls&#039; =&amp;gt; [],\n            ],\n            &#039;scaling&#039; =&amp;gt; [\n                &#039;enabled&#039; =&amp;gt; env(&#039;REVERB_SCALING_ENABLED&#039;, false),\n                &#039;channel&#039; =&amp;gt; env(&#039;REVERB_SCALING_CHANNEL&#039;, &#039;reverb&#039;),\n            ],\n            &#039;frontend&#039; =&amp;gt; [\n                &#039;host&#039; =&amp;gt; env(&#039;REVERB_FRONTEND_HOST&#039;),\n                &#039;port&#039; =&amp;gt; env(&#039;REVERB_FRONTEND_PORT&#039;),\n                &#039;scheme&#039; =&amp;gt; env(&#039;REVERB_FRONTEND_SCHEME&#039;),\n            ],\n            &#039;pulse_ingest_interval&#039; =&amp;gt; env(&#039;REVERB_PULSE_INGEST_INTERVAL&#039;, 15),\n        ],\n    ],\n\n    \/\/ ...\n];\n\n\n\n\nThe Broadcasting component has two sides: the backend and the frontend. The backend needs to connect to the Reverb server, and since we&#039;re using Sail, we&#039;ll spin up a new container for that. For this reason, we cannot use the same host as the frontend, since that&#039;s what the browser will use to connect to the server. The backend will connect to a host named reverb.test:8080 (we&#039;ll add it next), and the browser will connect to localhost:8080.\n\nIf you&#039;re following using artisan serve, both can be localhost or 127.0.0.1.\n\nNext, update the docker-compose.yml to add the new reverb.test service:\n\n\n\nservices:\n    # ...\n\n    reverb.test:\n        build:\n            context: .\/vendor\/laravel\/sail\/runtimes\/8.3\n            dockerfile: Dockerfile\n            args:\n                WWWGROUP: &#039;${WWWGROUP}&#039;\n        image: sail-8.3\/app\n        command: [&amp;quot;php&amp;quot;, &amp;quot;artisan&amp;quot;, &amp;quot;reverb:start&amp;quot;]\n        extra_hosts:\n            - &#039;host.docker.internal:host-gateway&#039;\n        ports:\n            - &#039;${REVERB_PORT:-8080}:8080&#039;\n        environment:\n            WWWUSER: &#039;${WWWUSER}&#039;\n            LARAVEL_SAIL: 1\n            XDEBUG_MODE: &#039;${SAIL_XDEBUG_MODE:-off}&#039;\n            XDEBUG_CONFIG: &#039;${SAIL_XDEBUG_CONFIG:-client_host=host.docker.internal}&#039;\n            IGNITION_LOCAL_SITES_PATH: &#039;${PWD}&#039;\n        volumes:\n            - &#039;.:\/var\/www\/html&#039;\n        networks:\n            - sail\n        depends_on:\n            - laravel.test\n\nnetworks:\n    sail:\n        driver: bridge\n\n\n\n\nNow, we can boot the Reverb service by running:\n\n.\/vendor\/bin\/sail up -d\n\n\nThat&#039;s it!\n\nBroadcasting Turbo Streams\n\nLet&#039;s start by sending new Chirps to all users currently visiting the chirps page. We&#039;re going to start by creating a private broadcasting channel called chirps in our routes\/channels.php file. Any authenticated user may start receiving new Chirps broadcasts when they visit the chirps.index page, so we&#039;re simply returning true in the authorization check:\n\n\n\n&amp;lt;?php\n\nuse App\\Models\\Chirp;\nuse Illuminate\\Support\\Facades\\Broadcast;\n\nBroadcast::channel(&#039;App.Models.User.{id}&#039;, function ($user, $id) {\n    return (int) $user-&amp;gt;id === (int) $id;\n});\n\nBroadcast::channel(&#039;chirps&#039;, function () {\n    return true;\n});\n\n\n\n\nNow, let&#039;s update the chirps\/index.blade.php to add the x-turbo::stream-from Blade component that ships with Turbo Laravel:\n\n\n\n&amp;lt;x-app-layout&amp;gt;\n    &amp;lt;x-slot name=&amp;quot;header&amp;quot;&amp;gt;\n        &amp;lt;h2 class=&amp;quot;flex items-center space-x-1 font-semibold text-xl text-gray-800 dark:text-gray-200 leading-tight&amp;quot;&amp;gt;\n            &amp;lt;x-breadcrumbs :links=&amp;quot;[__(&#039;Chirps&#039;)]&amp;quot; \/&amp;gt;\n        &amp;lt;\/h2&amp;gt;\n    &amp;lt;\/x-slot&amp;gt;\n\n    &amp;lt;x-turbo::stream-from source=&amp;quot;chirps&amp;quot; \/&amp;gt;\n\n    &amp;lt;div class=&amp;quot;py-12&amp;quot;&amp;gt;\n        &amp;lt;!-- ... --&amp;gt;\n    &amp;lt;\/div&amp;gt;\n&amp;lt;\/x-app-layout&amp;gt;\n\n\n\n\nThat&#039;s it! When the user visits that page, this component will automatically start listening to a chirps private channel for broadcasts. By default, it assumes we&#039;re using private channels, but you may configure it to listen to presence or public channels by passing the type prop to the component. In this case, we&#039;re passing a string for the channel name, but we could also pass an Eloquent model instance and it would figure out the channel name based on Laravel&#039;s conventions.\n\nNow, we&#039;re ready to start broadcasting! First, let&#039;s add the Broadcasts trait to our Chirp model:\n\n\n\n&amp;lt;?php\n\nnamespace App\\Models;\n\nuse HotwiredLaravel\\TurboLaravel\\Models\\Broadcasts;\nuse Illuminate\\Database\\Eloquent\\Factories\\HasFactory;\nuse Illuminate\\Database\\Eloquent\\Model;\n\nclass Chirp extends Model\n{\n    use HasFactory;\n    use Broadcasts;\n\n    protected $fillable = [\n        &#039;message&#039;,\n    ];\n\n    public function user()\n    {\n        return $this-&amp;gt;belongsTo(User::class);\n    }\n}\n\n\n\n\nThat trait will give us a bunch of methods we can call from our Chirp model instances. Let&#039;s use it in the store action of our ChirpController to send newly created Chirps to all connected users:\n\n\n\n&amp;lt;?php\n\nnamespace App\\Http\\Controllers;\n\nuse App\\Models\\Chirp;\nuse Illuminate\\Http\\Request;\n\nclass ChirpController extends Controller\n{\n    \/\/ ...\n\n    public function store(Request $request)\n    {\n        $validated = $request-&amp;gt;validate([\n            &#039;message&#039; =&amp;gt; [&#039;required&#039;, &#039;string&#039;, &#039;max:255&#039;],\n        ]);\n\n        $chirp = $request-&amp;gt;user()-&amp;gt;chirps()-&amp;gt;create($validated);\n\n        $chirp-&amp;gt;broadcastPrependTo(&#039;chirps&#039;)\n            -&amp;gt;target(&#039;chirps&#039;)\n            -&amp;gt;partial(&#039;chirps.partials.chirp&#039;, [&#039;chirp&#039; =&amp;gt; $chirp])\n            -&amp;gt;toOthers();\n\n        if ($request-&amp;gt;wantsTurboStream()) {\n            return turbo_stream([\n                turbo_stream($chirp, &#039;prepend&#039;),\n                turbo_stream()-&amp;gt;update(&#039;create_chirp&#039;, view(&#039;chirps._form&#039;)),\n                turbo_stream()-&amp;gt;notice(__(&#039;Chirp created.&#039;)),\n            ]);\n        }\n\n        return redirect()\n            -&amp;gt;route(&#039;chirps.index&#039;)\n            -&amp;gt;with(&#039;notice&#039;, __(&#039;Chirp created.&#039;));\n    }\n\n    \/\/ ...\n}\n\n\n\n\nTo test this, try visiting the \/chirps page from two different tabs and creating a Chirp in one of them. The other should automatically update! We&#039;re also broadcasting on-the-fly in the same request\/response life-cycle, which could slow down our response time a bit, depending on your load and your queue driver response time. We can delay the broadcasting (which includes view rendering) to a queued job by chaining the -&amp;gt;later() method, for example.\n\nNow, let&#039;s make sure all visiting users receive Chirp updates whenever it changes. To achieve that, change the update action in the ChirpController:\n\n\n\n&amp;lt;?php\n\nnamespace App\\Http\\Controllers;\n\nuse App\\Models\\Chirp;\nuse Illuminate\\Http\\Request;\n\nuse function HotwiredLaravel\\TurboLaravel\\dom_id;\n\nclass ChirpController extends Controller\n{\n    \/\/ ...\n\n    public function update(Request $request, Chirp $chirp)\n    {\n        $this-&amp;gt;authorize(&#039;update&#039;, $chirp);\n\n        $validated = $request-&amp;gt;validate([\n            &#039;message&#039; =&amp;gt; [&#039;required&#039;, &#039;string&#039;, &#039;max:255&#039;],\n        ]);\n\n        $chirp-&amp;gt;update($validated);\n\n        $chirp-&amp;gt;broadcastReplaceTo(&#039;chirps&#039;)\n            -&amp;gt;target(dom_id($chirp))\n            -&amp;gt;partial(&#039;chirps.partials.chirp&#039;, [&#039;chirp&#039; =&amp;gt; $chirp])\n            -&amp;gt;toOthers();\n\n        if ($request-&amp;gt;wantsTurboStream()) {\n            return turbo_stream([\n                turbo_stream($chirp),\n                turbo_stream()-&amp;gt;notice(__(&#039;Chirp updated.&#039;)),\n            ]);\n        }\n\n        return redirect()\n            -&amp;gt;route(&#039;chirps.index&#039;)\n            -&amp;gt;with(&#039;notice&#039;, __(&#039;Chirp updated.&#039;));\n    }\n\n    \/\/ ...\n}\n\n\n\n\nAgain, open two tabs, try editing a Chirp and you should see the other tab automatically updating! Cool, right?!\n\nFinally, let&#039;s make sure deleted Chirps are removed from all visiting users&#039; pages. Tweak the destroy action in the ChirpController like so:\n\n\n\n&amp;lt;?php\n\nnamespace App\\Http\\Controllers;\n\nuse App\\Models\\Chirp;\nuse Illuminate\\Http\\Request;\n\nuse function HotwiredLaravel\\TurboLaravel\\dom_id;\n\nclass ChirpController extends Controller\n{\n    \/\/ ...\n\n    public function destroy(Request $request, Chirp $chirp)\n    {\n        $this-&amp;gt;authorize(&#039;delete&#039;, $chirp);\n\n        $chirp-&amp;gt;delete();\n\n        $chirp-&amp;gt;broadcastRemoveTo(&#039;chirps&#039;)\n            -&amp;gt;target(dom_id($chirp))\n            -&amp;gt;toOthers();\n\n        if ($request-&amp;gt;wantsTurboStream()) {\n            return turbo_stream([\n                turbo_stream($chirp),\n                turbo_stream()-&amp;gt;notice(__(&#039;Chirp deleted.&#039;)),\n            ]);\n        }\n\n        return redirect()\n            -&amp;gt;route(&#039;chirps.index&#039;)\n            -&amp;gt;with(&#039;notice&#039;, __(&#039;Chirp deleted.&#039;));\n    }\n}\n\n\n\n\nNow, open two tabs and try deleting a Chirp. You should see it being removed from the other tab as well!\n\nAutomatically Broadcasting on Model Changes\n\nSince we&#039;re interested in broadcasting all changes of our Chirp model, we can remove a few lines of code and instruct Turbo Laravel to make that automatically for us.\n\nWe may achieve that by setting the $broadcasts property to true in our Chirp model. However, Turbo Laravel will automatically broadcast newly created models using the append Turbo Stream action. In our case, we want it to prepend instead, so we&#039;re setting the $broadcasts property to an array and using the insertsBy key to configure the creation action to be used.\n\nWe also need to override where these broadcasts are going to be sent to. Turbo Laravel will automatically send creates to a channel named using the pluralization of our model&#039;s basename, which would work for us. But updates and deletes will be sent to a model&#039;s individual channel names (something like App.Models.Chirp.1 where 1 is the model ID). This is useful because we&#039;re usually broadcasting to a parent model&#039;s channel via a relationship, which we can do with the $broadcastsTo property (see the docs to know more about this), but in our case we&#039;ll always be sending the broadcasts to a private channel named chirps.\n\nOur Chirp model would end up looking like this:\n\n\n\n&amp;lt;?php\n\nnamespace App\\Models;\n\nuse HotwiredLaravel\\TurboLaravel\\Models\\Broadcasts;\nuse Illuminate\\Broadcasting\\PrivateChannel;\nuse Illuminate\\Database\\Eloquent\\Factories\\HasFactory;\nuse Illuminate\\Database\\Eloquent\\Model;\n\nclass Chirp extends Model\n{\n    use HasFactory;\n    use Broadcasts;\n\n    protected $broadcasts = [\n        &#039;insertsBy&#039; =&amp;gt; &#039;prepend&#039;,\n    ];\n\n    protected $fillable = [\n        &#039;message&#039;,\n    ];\n\n    public function user()\n    {\n        return $this-&amp;gt;belongsTo(User::class);\n    }\n\n    public function broadcastsTo()\n    {\n        return [\n            new PrivateChannel(&#039;chirps&#039;),\n        ];\n    }\n}\n\n\n\n\nWe can then remove a few lines from our ChirpsController:\n\n\n\n&amp;lt;?php\n\nnamespace App\\Http\\Controllers;\n\nuse App\\Models\\Chirp;\nuse Illuminate\\Http\\Request;\n\nuse function HotwiredLaravel\\TurboLaravel\\dom_id;\n\nclass ChirpController extends Controller\n{\n    \/\/ ...\n\n    public function store(Request $request)\n    {\n        $validated = $request-&amp;gt;validate([\n            &#039;message&#039; =&amp;gt; [&#039;required&#039;, &#039;string&#039;, &#039;max:255&#039;],\n        ]);\n\n        $chirp = $request-&amp;gt;user()-&amp;gt;chirps()-&amp;gt;create($validated);\n\n        $chirp-&amp;gt;broadcastPrependTo(&#039;chirps&#039;)\n           -&amp;gt;target(&#039;chirps&#039;)\n           -&amp;gt;partial(&#039;chirps.partials.chirp&#039;, [&#039;chirp&#039; =&amp;gt; $chirp])\n           -&amp;gt;toOthers();\n\n        if ($request-&amp;gt;wantsTurboStream()) {\n            return turbo_stream([\n                turbo_stream($chirp, &#039;prepend&#039;),\n                turbo_stream()-&amp;gt;update(&#039;create_chirp&#039;, view(&#039;chirps._form&#039;)),\n                turbo_stream()-&amp;gt;notice(__(&#039;Chirp created.&#039;)),\n            ]);\n        }\n\n        return redirect()\n            -&amp;gt;route(&#039;chirps.index&#039;)\n            -&amp;gt;with(&#039;notice&#039;, __(&#039;Chirp created.&#039;));\n    }\n\n    \/\/ ...\n\n    public function update(Request $request, Chirp $chirp)\n    {\n        $this-&amp;gt;authorize(&#039;update&#039;, $chirp);\n\n        $validated = $request-&amp;gt;validate([\n            &#039;message&#039; =&amp;gt; [&#039;required&#039;, &#039;string&#039;, &#039;max:255&#039;],\n        ]);\n\n        $chirp-&amp;gt;update($validated);\n\n        $chirp-&amp;gt;broadcastReplaceTo(&#039;chirps&#039;)\n            -&amp;gt;target(dom_id($chirp))\n            -&amp;gt;partial(&#039;chirps.partials.chirp&#039;, [&#039;chirp&#039; =&amp;gt; $chirp])\n            -&amp;gt;toOthers();\n\n        if ($request-&amp;gt;wantsTurboStream()) {\n            return turbo_stream([\n                turbo_stream($chirp),\n                turbo_stream()-&amp;gt;notice(__(&#039;Chirp updated.&#039;)),\n            ]);\n        }\n\n        return redirect()\n            -&amp;gt;route(&#039;chirps.index&#039;)\n            -&amp;gt;with(&#039;notice&#039;, __(&#039;Chirp updated.&#039;));\n    }\n\n    public function destroy(Request $request, Chirp $chirp)\n    {\n        $this-&amp;gt;authorize(&#039;delete&#039;, $chirp);\n\n        $chirp-&amp;gt;delete();\n\n        $chirp-&amp;gt;broadcastRemoveTo(&#039;chirps&#039;)\n            -&amp;gt;target(dom_id($chirp))\n            -&amp;gt;toOthers();\n\n        if ($request-&amp;gt;wantsTurboStream()) {\n            return turbo_stream([\n                turbo_stream($chirp),\n                turbo_stream()-&amp;gt;notice(__(&#039;Chirp deleted.&#039;)),\n            ]);\n        }\n\n        return redirect()\n            -&amp;gt;route(&#039;chirps.index&#039;)\n            -&amp;gt;with(&#039;notice&#039;, __(&#039;Chirp deleted.&#039;));\n    }\n}\n\n\n\n\n\n\n\n\nYou don&#039;t need a model to use Turbo Streams\n\n\n\nWe&#039;re only covering Turbo Stream broadcasts from an Eloquent model&#039;s perspective. However, you may broadcast anything using the TurboStream Facade or by chaining the broadcastTo() method call when using the turbo_stream() response builder function. Check the Broadcasting docs to know more about this.\n\n\nTesting it out\n\nBefore testing it out, we&#039;ll need to start a queue worker. That&#039;s because Laravel 11 sets the QUEUE_CONNECTION=database by default instead of sync, and Turbo Laravel will send automatic broadcasts in background. Let&#039;s do that:\n\nsail artisan queue:work --tries=1\n\n\nNow we can test it and it should be working!\n\nOne more cool thing about this approach: users will receive the broadcasts no matter where the Chirp models were created from! We can test this out by creating a Chirp entry from Tinker, for example. To try that, start a new Tinker session:\n\nphp artisan tinker\n\n\nAnd then create a Chirp from there:\n\nApp\\Models\\User::first()-&amp;gt;chirps()-&amp;gt;create([&#039;message&#039; =&amp;gt; &#039;Hello from Tinker!&#039;])\n# App\\Models\\Chirp {#7426\n#   message: &amp;quot;Hello from Tinker!&amp;quot;,\n#   user_id: 1,\n#   updated_at: &amp;quot;2023-11-26 23:01:00&amp;quot;,\n#   created_at: &amp;quot;2023-11-26 23:01:00&amp;quot;,\n#   id: 18,\n# }\n\n\n\n\nExtra Credit: Fixing The Missing Dropdowns\n\nWhen creating the Chirp from Tinker, even though we see them appearing on the page, if you look closely, you may notice that the dropdown with the \&quot;Edit\&quot; and \&quot;Delete\&quot; buttons is missing. This would also be true if we were using a real queue driver, since it would defer the rendering of the partial to a background queue worker. That&#039;s because when we send the broadcasts to run in background, the partial will render without a request and session contexts, so our calls to Auth::id() inside of it will always return null, which means the dropdown would never render.\n\nInstead of conditionally rendering the dropdown in the server side, let&#039;s switch to always rendering them and hide it from our users with a sprinkle of JavaScript instead.\n\nFirst, let&#039;s update our layouts.partials.current-identity partial to include a few things about the currently authenticated user when there&#039;s one:\n\n\n\n{{&#039;@&#039;}}auth\n&amp;lt;meta name=&amp;quot;current-identity-id&amp;quot; content=&amp;quot;@{{ Auth::user()-&amp;gt;id }}&amp;quot; \/&amp;gt;\n&amp;lt;meta name=&amp;quot;current-identity-name&amp;quot; content=&amp;quot;@{{ Auth::user()-&amp;gt;name }}&amp;quot; \/&amp;gt;\n{{&#039;@&#039;}}endauth\n\n\n\n\nNext, update the app.blade.php to include it:\n\n\n\n&amp;lt;!DOCTYPE html&amp;gt;\n&amp;lt;html lang=&amp;quot;@{{ str_replace(&#039;_&#039;, &#039;-&#039;, app()-&amp;gt;getLocale()) }}&amp;quot;&amp;gt;\n    &amp;lt;head&amp;gt;\n        &amp;lt;meta charset=&amp;quot;utf-8&amp;quot;&amp;gt;\n        &amp;lt;meta name=&amp;quot;viewport&amp;quot; content=&amp;quot;width=device-width, initial-scale=1&amp;quot;&amp;gt;\n        &amp;lt;meta name=&amp;quot;csrf-token&amp;quot; content=&amp;quot;@{{ csrf_token() }}&amp;quot;&amp;gt;\n\n        {{&#039;@&#039;}}if ($viewTransitions ?? false)\n        &amp;lt;meta name=&amp;quot;view-transition&amp;quot; content=&amp;quot;same-origin&amp;quot; \/&amp;gt;\n        {{&#039;@&#039;}}endif\n\n        {{&#039;@&#039;}}include(&#039;layouts.partials.reverb&#039;)\n        {{&#039;@&#039;}}include(&#039;layouts.partials.current-identity&#039;)\n\n        @{{ $meta ?? &#039;&#039; }}\n\n        &amp;lt;title&amp;gt;@{{ config(&#039;app.name&#039;, &#039;Laravel&#039;) }}&amp;lt;\/title&amp;gt;\n\n        &amp;lt;!-- ... --&amp;gt;\n    &amp;lt;\/head&amp;gt;\n\n    &amp;lt;body class=&amp;quot;font-sans antialiased&amp;quot;&amp;gt;\n        &amp;lt;!-- ... --&amp;gt;\n    &amp;lt;\/body&amp;gt;\n&amp;lt;\/html&amp;gt;\n\n\n\n\nNow, we&#039;re going to create a new Stimulus controller that is going to be responsible for the dropdown visibility. It should only show it if the currently authenticated user is the creator of the Chirp. First, let&#039;s create the controller:\n\nphp artisan stimulus:make visible_to_creator\n\n\nNow, update the Stimulus controller to look like this:\n\n\n\nimport { Controller } from &amp;quot;{{&#039;@&#039;}}hotwired\/stimulus&amp;quot;\n\n\/\/ Connects to data-controller=&amp;quot;visible-to-creator&amp;quot;\nexport default class extends Controller {\n    static values = {\n        id: String,\n    }\n\n    static classes = [&#039;hidden&#039;]\n\n    connect() {\n        this.toggleVisibility()\n    }\n\n    toggleVisibility() {\n        if (this.idValue == window.Current.identity.id) {\n            this.element.classList.remove(...this.hiddenClasses)\n        } else {\n            this.element.classList.add(...this.hiddenClasses)\n        }\n    }\n}\n\n\n\n\nNow, let&#039;s update our chirps.partials.chirp.blade.php partial to use this controller instead of handling this in the server-side:\n\n\n\n&amp;lt;x-turbo::frame :id=&amp;quot;$chirp&amp;quot; class=&amp;quot;p-6 flex space-x-2&amp;quot;&amp;gt;\n    &amp;lt;svg xmlns=&amp;quot;http:\/\/www.w3.org\/2000\/svg&amp;quot; class=&amp;quot;h-6 w-6 text-gray-600 dark:text-gray-400 -scale-x-100&amp;quot; fill=&amp;quot;none&amp;quot; viewBox=&amp;quot;0 0 24 24&amp;quot; stroke=&amp;quot;currentColor&amp;quot; stroke-width=&amp;quot;2&amp;quot;&amp;gt;\n        &amp;lt;!-- ... --&amp;gt;\n    &amp;lt;\/svg&amp;gt;\n\n    &amp;lt;div class=&amp;quot;flex-1&amp;quot;&amp;gt;\n        &amp;lt;div class=&amp;quot;flex justify-between items-center&amp;quot;&amp;gt;\n            &amp;lt;div&amp;gt;\n                &amp;lt;span class=&amp;quot;text-gray-800 dark:text-gray-200&amp;quot;&amp;gt;@{{ $chirp-&amp;gt;user-&amp;gt;name }}&amp;lt;\/span&amp;gt;\n                &amp;lt;small class=&amp;quot;ml-2 text-sm text-gray-600 dark:text-gray-400&amp;quot;&amp;gt;&amp;lt;x-local-time-ago :value=&amp;quot;$chirp-&amp;gt;created_at&amp;quot; \/&amp;gt;&amp;lt;\/small&amp;gt;\n                {{&#039;@&#039;}}unless ($chirp-&amp;gt;created_at-&amp;gt;eq($chirp-&amp;gt;updated_at))\n                &amp;lt;small class=&amp;quot;text-sm text-gray-600&amp;quot;&amp;gt; &amp;amp;middot; edited&amp;lt;\/small&amp;gt;\n                {{&#039;@&#039;}}endunless\n            &amp;lt;\/div&amp;gt;\n\n            {{&#039;@&#039;}}if (Auth::id() === $chirp-&amp;gt;user-&amp;gt;id) \n            &amp;lt;x-dropdown align=&amp;quot;right&amp;quot; width=&amp;quot;48&amp;quot;&amp;gt;\n            &amp;lt;x-dropdown align=&amp;quot;right&amp;quot; width=&amp;quot;48&amp;quot; class=&amp;quot;hidden&amp;quot; data-controller=&amp;quot;visible-to-creator&amp;quot; data-visible-to-creator-id-value=&amp;quot;@{{ $chirp-&amp;gt;user_id }}&amp;quot; data-visible-to-creator-hidden-class=&amp;quot;hidden&amp;quot;&amp;gt;\n                &amp;lt;!-- ... --&amp;gt;\n            &amp;lt;\/x-dropdown&amp;gt;\n            {{&#039;@&#039;}}endif\n        &amp;lt;\/div&amp;gt;\n        &amp;lt;p class=&amp;quot;mt-4 text-lg text-gray-900 dark:text-gray-200&amp;quot;&amp;gt;@{{ $chirp-&amp;gt;message }}&amp;lt;\/p&amp;gt;\n    &amp;lt;\/div&amp;gt;\n&amp;lt;\/x-turbo::frame&amp;gt;\n\n\n\n\nNext, we need to tweak our dropdown.blade.php Blade component to accept and merge the class, data-controller, and data-action attributes:\n\n\n\n{{&#039;@&#039;}}props([&#039;align&#039; =&amp;gt; &#039;right&#039;, &#039;width&#039; =&amp;gt; &#039;48&#039;, &#039;contentClasses&#039; =&amp;gt; &#039;py-1 bg-white&#039;])\n{{&#039;@&#039;}}props([&#039;align&#039; =&amp;gt; &#039;right&#039;, &#039;width&#039; =&amp;gt; &#039;48&#039;, &#039;contentClasses&#039; =&amp;gt; &#039;py-1 bg-white&#039;, &#039;dataController&#039; =&amp;gt; &#039;&#039;, &#039;dataAction&#039; =&amp;gt; &#039;&#039;])\n\n&amp;lt;!-- ... --&amp;gt;\n\n&amp;lt;div class=&amp;quot;relative&amp;quot; data-controller=&amp;quot;dropdown&amp;quot; data-action=&amp;quot;turbo:before-cache{{&#039;@&#039;}}window-&amp;gt;dropdown#closeNow click{{&#039;@&#039;}}window-&amp;gt;dropdown#close close-&amp;gt;dropdown#close&amp;quot;&amp;gt;\n&amp;lt;div @{{ $attributes-&amp;gt;merge([&#039;class&#039; =&amp;gt; &#039;relative&#039;, &#039;data-controller&#039; =&amp;gt; &amp;quot;dropdown {$dataController}&amp;quot;, &#039;data-action&#039; =&amp;gt; &amp;quot;turbo:before-cache{{&#039;@&#039;}}window-&amp;gt;dropdown#closeNow click{{&#039;@&#039;}}window-&amp;gt;dropdown#closeWhenClickedOutside close-&amp;gt;dropdown#close:stop {$dataAction}&amp;quot;]) }}&amp;gt;\n    &amp;lt;!-- ... --&amp;gt;\n&amp;lt;\/div&amp;gt;\n\n\n\n\nNow, if you try creating another user and test this out, you&#039;ll see that the dropdown only shows up for the creator of the Chirp!\n\n\n\nThis change also makes our entire _chirp partial cacheable! We could cache it and only render that when changes are made to the Chirp model using the Chirp&#039;s updated_at timestamps, for example.\n\n\n\n\n\nIs hiding the links with CSS enough?\n\n\n\nHiding the links in the frontend MUST NOT be your only protection here. Always ensure users are authorized to perform actions in the server side. We&#039;re already doing this in our controller using Laravel&#039;s Authorization Policies.&quot;",
        "url": "https://turbo-laravel.com/bootcamp/broadcasting",
      },
          "hotwire-native-installation": {
        "title": "Hotwire Native Installation",
        "content": "&quot;Hotwire offers mobile native adapters to help building high-fidelity hybrid apps with native navigation and a single shared web view.\n\nYou&#039;ll need a little bit of mobile development knowledge, specifically for Android and Kotlin. Not that much, though, because to be honest I&#039;m no mobile dev expert myself.\n\nThis guide isn&#039;t about \&quot;the best way to build Hotwire Native apps\&quot;. The idea is just to show you what&#039;s possible and how it integrates with Turbo.js and Turbo Laravel.\n\nWe&#039;re gonna focus on the Hotwire Native for Android lib. I feel like Hotwire Native for iOS has a lot more attention, so I want to focus on Android for a bit. It&#039;s also the platform I am more familiar with, to be honest.\n\nIn Android development, each screen used to be its own Activity, but that has changed over the years and now the \&quot;Single Activity\&quot; approach seems to be the way to go. Watch this talk called \&quot;Single activity: why, when, and how\&quot;. In short, we&#039;re gonna have a single activity and each screen will be represented by a Fragment and we&#039;ll use Google&#039;s Navigation component library to decide which fragment to present.\n\nHead over to the Overview section in the docs for Hotwire Native.\n\nLet&#039;s setup the Android app.\n\nSetting Up The Local Development\n\nTo get started, you will need Java, Kotlin, and Android Studio installed locally. We&#039;re not gonna cover installing those things, but you should be able to find many resources on that.\n\nI&#039;m using ASDF, so here&#039;s some links:\n\n\nASDF itself: https:\/\/asdf-vm.com\/\nASDF Java: https:\/\/github.com\/halcyon\/asdf-java\nASDF Kotlin: https:\/\/github.com\/asdf-community\/asdf-kotlin\nAndroid Studio: https:\/\/developer.android.com\/studio\n\n\nGet those installed first, and then we&#039;ll create the project.\n\nSetting Up The Project\n\nWhen creating the project, make sure you choose the \&quot;Empty Activity\&quot; option.\n\n\n\nOn the next screen, make sure you choose the \&quot;API 24\&quot; as that&#039;s required by the Hotwire Native adapter.\n\n\n\nNext, you&#039;re going to need to create a Virtual Device, next to the \&quot;run\&quot; icon (the green right-arrow in toolbar at the top), there&#039;s a dropdown with the \&quot;Device Manager\&quot; option. Click on it. In the sidebar that opens, click on the \&quot;Create Device\&quot; option. Choose whatever device you want to emulate, I&#039;ll go with a Pixel 2.\n\n\n\nFor the System image, I&#039;m choose API level 30, which is Android R.\n\n\n\nNow, you should see the option to run the app on the device emulator! Pressing on that, you should the app is running!\n\n\n\nLet&#039;s install Hotwire Native.\n\nInstalling Hotwire Native\n\nNow, let&#039;s add the Turbo lib. On the left sidebar, there&#039;s a \&quot;Gradle Scripts\&quot; section dropdown. Open it. In there, you should see 2 files named build.gradle, one for the project and one for the module. Open the module one. On it, scroll to the bottom where your dependencies are listed and add the Hotwire Native one:\n\ndependencies {\n    def lifecycle_version = &#039;2.5.1&#039; \/\/ Add this\n\n    implementation &#039;androidx.core:core-ktx:1.9.0&#039;\n    implementation &#039;androidx.appcompat:appcompat:1.5.1&#039;\n    implementation &#039;com.google.android.material:material:1.6.1&#039;\n    implementation &#039;androidx.constraintlayout:constraintlayout:2.1.4&#039;\n\n    \/\/ Add this section:\n    implementation &#039;dev.hotwire:turbo:7.0.0-rc12&#039;\n    implementation &amp;quot;androidx.lifecycle:lifecycle-livedata-ktx:$lifecycle_version&amp;quot;\n    implementation &amp;quot;androidx.lifecycle:lifecycle-viewmodel-ktx:$lifecycle_version&amp;quot;\n    implementation &amp;quot;androidx.lifecycle:lifecycle-runtime-ktx:$lifecycle_version&amp;quot;\n\n    testImplementation &#039;junit:junit:4.13.2&#039;\n    androidTestImplementation &#039;androidx.test.ext:junit:1.1.3&#039;\n    androidTestImplementation &#039;androidx.test.espresso:espresso-core:3.4.0&#039;\n}\n\n\nThen, press on \&quot;Sync now\&quot; at the top of the file. Once that&#039;s done, you should have Turbo installed.\n\n\n\nConfiguring Hotwire Native\n\nSo far, we have only added Hotwire Native to the project, but we&#039;re not using it yet. Let&#039;s configure it.\n\nWe&#039;re following the official Quick Start guide here.\n\nLet&#039;s start by creating our NavHostFragment, which is a component available in Android Jetpack that provides a contained navigation area where our fragments will appear.\n\nBefore we start, let&#039;s create a util package where we&#039;re going to have a Constants Kotlin file. To do that, right-click on the root package and choosing the \&quot;New \u003E Package\&quot; option. Then create the \&quot;util\&quot; package.\n\nInside of it, create the Constants.kt file with the following contents:\n\npackage com.example.turbochirpernative.util\n\nconst val BASE_URL = &amp;quot;http:\/\/10.0.2.2&amp;quot;\nconst val CHIRPS_HOME_URL = &amp;quot;$BASE_URL\/chirps&amp;quot;\n\n\nWe need to use something 10.0.2.2 instead of localhost here or something like Expose to get a remote URL that points to your app running locally.\n\nLet&#039;s now create a package in our app called \&quot;main\&quot;:\n\n\n\nNow, create a Kotlin class called MainSessionNavHostFragment. This class will extend the TurboSessionNavHostFragment class that ships with Turbo, feel free to copy the body of the class (make sure the imports are correct and the package name too):\n\npackage com.example.turbochirpernative.main\n\nimport android.webkit.WebView\nimport androidx.appcompat.app.AppCompatActivity\nimport androidx.fragment.app.Fragment\nimport com.example.turbochirpernative.util.CHIRPS_HOME_URL\nimport dev.hotwire.turbo.BuildConfig\nimport dev.hotwire.turbo.config.TurboPathConfiguration\nimport dev.hotwire.turbo.session.TurboSessionNavHostFragment\nimport kotlin.reflect.KClass\n\nclass MainSessionNavHostFragment : TurboSessionNavHostFragment() {\n    override val sessionName = &amp;quot;main&amp;quot;\n\n    override val startLocation = CHIRPS_HOME_URL\n\n    override val registeredActivities: List&amp;lt;KClass&amp;lt;out AppCompatActivity&amp;gt;&amp;gt;\n        get() = listOf()\n\n    override val registeredFragments: List&amp;lt;KClass&amp;lt;out Fragment&amp;gt;&amp;gt;\n        get() = listOf(\n            \/\/\n        )\n\n    override val pathConfigurationLocation: TurboPathConfiguration.Location\n        get() = TurboPathConfiguration.Location(\n            assetFilePath = &amp;quot;json\/configuration.json&amp;quot;,\n        )\n\n    override fun onSessionCreated() {\n        super.onSessionCreated()\n        session.webView.settings.userAgentString = customUserAgent(session.webView)\n\n        if (BuildConfig.DEBUG) {\n            session.setDebugLoggingEnabled(true)\n            WebView.setWebContentsDebuggingEnabled(true)\n        }\n    }\n\n    private fun customUserAgent(webView: WebView): String {\n        return &amp;quot;Hotwire Native Android ${webView.settings.userAgentString}&amp;quot;\n    }\n}\n\n\nThere&#039;s a lot going on here, and this code doesn&#039;t even work yet. Let&#039;s go piece by piece.\n\n\nThe startLocation property should point to your app&#039;s default home page. In our case, it&#039;s the \/chirps page. It could be the \/dashboard, but we don&#039;t have anything there yet;\nThe registeredActivities method is only used when we have more than one activity in our app, which isn&#039;t our case, so we return an empty list;\nThe registeredFragments method will return a list of all fragments in our app to build the navigation graph. It&#039;s currently empty, but we&#039;ll use it in a bit;\nThe pathConfigurationLocation returns the location to the path configuration JSON files. This file will have some app specific configurations which can be used for things like feature toggles, but it&#039;s also going to have the navigation configuration where we&#039;re going to specify which fragments will be used based on the URL pattern (more on that later). Our app should must ship with a default configuration.json file, but we could also provide a remote URL for the file that we could control dynamically from our backend server;\nWe&#039;re also configuring the WebView to use the Hotwire Native Android User Agent header so we can detect in the backend that the request is coming from a Hotwire Native client (see more here)\n\n\nOkay, now let&#039;s create our configuration.json file. Right-click on the project root named \&quot;app\&quot; and choose \&quot;New \u003E Directory\&quot;, then call it \&quot;assets\/json\&quot;. Then, right-click on the json directory we just created, and add a new file called configuration.json with the following contents:\n\n\n\n{\n  &amp;quot;settings&amp;quot;: {\n    &amp;quot;screenshots_enabled&amp;quot;: true\n  },\n  &amp;quot;rules&amp;quot;: [\n    {\n      &amp;quot;patterns&amp;quot;: [\n        &amp;quot;.*&amp;quot;\n      ],\n      &amp;quot;properties&amp;quot;: {\n        &amp;quot;context&amp;quot;: &amp;quot;default&amp;quot;,\n        &amp;quot;uri&amp;quot;: &amp;quot;turbo:\/\/fragment\/web&amp;quot;,\n        &amp;quot;pull_to_refresh_enabled&amp;quot;: true\n      }\n    }\n  ]\n}\n\n\nWe only have one rule defined in this file right now. This is the \&quot;catch-all\&quot; rule, which will be applied to every navigation started by Turbo. By default, it will render the fragment configured as the turbo:\/\/fragment\/web URI. Let&#039;s create that fragment and register it in our MainSessionNavHostFragment.\n\nTo create the fragment, let&#039;s first create a \&quot;features\&quot; package and then a \&quot;web\&quot; package inside of it. The \&quot;features\&quot; package will be where we keep our fragments and we can create sub packages for each subsystem we may have. For now, we only have one which we&#039;ll call \&quot;web\&quot;.\n\nInside of the features.web package, create a Kotlin class named WebFragment with the following contents:\n\npackage com.example.turbochirpernative.features.web\n\nimport dev.hotwire.turbo.fragments.TurboWebFragment\nimport dev.hotwire.turbo.nav.TurboNavGraphDestination\n\n{{&#039;@&#039;}}TurboNavGraphDestination(uri = &amp;quot;turbo:\/\/fragment\/web&amp;quot;)\nclass WebFragment: TurboWebFragment() {\n}\n\n\nNotice that we&#039;re annotating this class as the turbo:\/\/fragment\/web URI using the TurboNavGraphDestination annotation. This matches our URI config for the catch-all rule in our configuration.json file.\n\nNow, let&#039;s register this fragment in the MainSessionNavHostFragment:\n\npackage com.example.turbochirpernative.main\n\n\/\/ ...\n\nclass MainSessionNavHostFragment : TurboSessionNavHostFragment() {\n    override val registeredFragments: List&amp;lt;KClass&amp;lt;out Fragment&amp;gt;&amp;gt;\n        get() = listOf(\n            WebFragment::class \/\/ Add this\n        )\n\n    \/\/ ...\n}\n\n\nNext, we need to update our MainActivity to use the MainSessionNavHostFragment we have just created. But before we do that, let&#039;s do a refactor and also move it to the \&quot;main\&quot; package. You may have to do it twice for the refactoring to take effect.\n\n\n\nThis activity class is referenced in the AndroidManifest.xml file, make sure you update the reference to also use the .main package. You can edit the manifest by clicking on the \&quot;app\/manifests\&quot; section on your left sidebar. Since we&#039;re changing the manifest, let&#039;s also make sure we add the INTERNET permission to our app, otherwise we won&#039;t be able to make network requests.\n\n&amp;lt;?xml version=&amp;quot;1.0&amp;quot; encoding=&amp;quot;utf-8&amp;quot;?&amp;gt;\n&amp;lt;manifest xmlns:android=&amp;quot;http:\/\/schemas.android.com\/apk\/res\/android&amp;quot;\n    xmlns:tools=&amp;quot;http:\/\/schemas.android.com\/tools&amp;quot;&amp;gt;\n\n    &amp;lt;!-- Add this: --&amp;gt;\n    &amp;lt;uses-permission android:name=&amp;quot;android.permission.INTERNET&amp;quot; \/&amp;gt;\n\n    &amp;lt;application\n        android:allowBackup=&amp;quot;true&amp;quot;\n        android:dataExtractionRules=&amp;quot;{{&#039;@&#039;}}xml\/data_extraction_rules&amp;quot;\n        android:fullBackupContent=&amp;quot;{{&#039;@&#039;}}xml\/backup_rules&amp;quot;\n        android:icon=&amp;quot;{{&#039;@&#039;}}mipmap\/ic_launcher&amp;quot;\n        android:label=&amp;quot;{{&#039;@&#039;}}string\/app_name&amp;quot;\n        android:roundIcon=&amp;quot;{{&#039;@&#039;}}mipmap\/ic_launcher_round&amp;quot;\n        android:supportsRtl=&amp;quot;true&amp;quot;\n        android:theme=&amp;quot;{{&#039;@&#039;}}style\/Theme.TurboChirperNative&amp;quot;\n        tools:targetApi=&amp;quot;31&amp;quot;\n        android:usesCleartextTraffic=&amp;quot;true&amp;quot;&amp;gt; &amp;lt;!-- Allow &amp;quot;clear text&amp;quot; --&amp;gt;\n\n        &amp;lt;activity\n            android:name=&amp;quot;.main.MainActivity&amp;quot;\n            android:exported=&amp;quot;true&amp;quot;\n            android:label=&amp;quot;{{&#039;@&#039;}}string\/app_name&amp;quot;\n            android:theme=&amp;quot;{{&#039;@&#039;}}style\/Theme.TurboChirperNative&amp;quot;&amp;gt;\n\n            &amp;lt;intent-filter&amp;gt;\n                &amp;lt;action android:name=&amp;quot;android.intent.action.MAIN&amp;quot; \/&amp;gt;\n\n                &amp;lt;category android:name=&amp;quot;android.intent.category.LAUNCHER&amp;quot; \/&amp;gt;\n            &amp;lt;\/intent-filter&amp;gt;\n\n            &amp;lt;meta-data\n                android:name=&amp;quot;android.app.lib_name&amp;quot;\n                android:value=&amp;quot;&amp;quot; \/&amp;gt;\n        &amp;lt;\/activity&amp;gt;\n    &amp;lt;\/application&amp;gt;\n&amp;lt;\/manifest&amp;gt;\n\n\nNow, let&#039;s update our activity_main.xml layout file. Update it to match this content:\n\n&amp;lt;?xml version=&amp;quot;1.0&amp;quot; encoding=&amp;quot;utf-8&amp;quot;?&amp;gt;\n&amp;lt;androidx.constraintlayout.widget.ConstraintLayout\n    xmlns:android=&amp;quot;http:\/\/schemas.android.com\/apk\/res\/android&amp;quot;\n    xmlns:app=&amp;quot;http:\/\/schemas.android.com\/apk\/res-auto&amp;quot;\n    android:layout_width=&amp;quot;match_parent&amp;quot;\n    android:layout_height=&amp;quot;match_parent&amp;quot;&amp;gt;\n\n    &amp;lt;androidx.fragment.app.FragmentContainerView\n        android:id=&amp;quot;{{&#039;@&#039;}}+id\/main_nav_host&amp;quot;\n        android:name=&amp;quot;com.example.turbochirpernative.main.MainSessionNavHostFragment&amp;quot;\n        android:layout_width=&amp;quot;match_parent&amp;quot;\n        android:layout_height=&amp;quot;match_parent&amp;quot;\n        app:defaultNavHost=&amp;quot;false&amp;quot; \/&amp;gt;\n\n&amp;lt;\/androidx.constraintlayout.widget.ConstraintLayout&amp;gt;\n\n\nMake sure the android:name property points to the full package namespace of your MainSessionNavHostFragment.\n\nNext, update the MainActivity to match this:\n\npackage com.example.turbochirpernative.main\n\nimport android.os.Bundle\nimport com.example.turbochirpernative.R\nimport androidx.appcompat.app.AppCompatActivity\nimport dev.hotwire.turbo.activities.TurboActivity\nimport dev.hotwire.turbo.delegates.TurboActivityDelegate\n\nclass MainActivity : AppCompatActivity(), TurboActivity {\n    override lateinit var delegate: TurboActivityDelegate\n\n    override fun onCreate(savedInstanceState: Bundle?) {\n        super.onCreate(savedInstanceState)\n        setContentView(R.layout.activity_main)\n\n        delegate = TurboActivityDelegate(this, R.id.main_nav_host)\n    }\n}\n\n\nNow, if you run the app, you should see that we have successfully wrapped our web app in a native shell using Hotwire Native! Yay!\n\n\n\nAs of right now, mobile users have access to all the features exactly the way it works on mobile. As long as we build our features with a mobile first mentality using responsive UIs, we should be good most of the time. However, as of right now, you may notice our app is a little weird to use on mobile. Let&#039;s tweak our app so it looks better.\n\nLet&#039;s hide the top-level action bar and only leave the right below it. Open the layout file in \&quot;res -\u003E values -\u003E themes\&quot; and make it inherit from the NoActionBar theme:\n\n&amp;lt;resources xmlns:tools=&amp;quot;http:\/\/schemas.android.com\/tools&amp;quot;&amp;gt;\n    &amp;lt;!-- Fix the parent: --&amp;gt;\n    &amp;lt;style name=&amp;quot;Theme.TurboChirperNative&amp;quot; parent=&amp;quot;Theme.MaterialComponents.DayNight.NoActionBar&amp;quot;&amp;gt;\n        &amp;lt;!-- ... --&amp;gt;\n    &amp;lt;\/style&amp;gt;\n&amp;lt;\/resources&amp;gt;\n\n\nThen, change add the new indigo colors to the colors.xml file in \&quot;res -\u003E values -\u003E colors.xml\&quot;:\n\n&amp;lt;?xml version=&amp;quot;1.0&amp;quot; encoding=&amp;quot;utf-8&amp;quot;?&amp;gt;\n&amp;lt;resources&amp;gt;\n    &amp;lt;color name=&amp;quot;indigo_500&amp;quot;&amp;gt;#6366f1&amp;lt;\/color&amp;gt;\n    &amp;lt;color name=&amp;quot;indigo_700&amp;quot;&amp;gt;#4338ca&amp;lt;\/color&amp;gt;\n    &amp;lt;color name=&amp;quot;purple_200&amp;quot;&amp;gt;#FFBB86FC&amp;lt;\/color&amp;gt;\n    &amp;lt;color name=&amp;quot;purple_500&amp;quot;&amp;gt;#FF6200EE&amp;lt;\/color&amp;gt;\n    &amp;lt;color name=&amp;quot;purple_700&amp;quot;&amp;gt;#FF3700B3&amp;lt;\/color&amp;gt;\n    &amp;lt;color name=&amp;quot;teal_200&amp;quot;&amp;gt;#FF03DAC5&amp;lt;\/color&amp;gt;\n    &amp;lt;color name=&amp;quot;teal_700&amp;quot;&amp;gt;#FF018786&amp;lt;\/color&amp;gt;\n    &amp;lt;color name=&amp;quot;black&amp;quot;&amp;gt;#FF000000&amp;lt;\/color&amp;gt;\n    &amp;lt;color name=&amp;quot;white&amp;quot;&amp;gt;#FFFFFFFF&amp;lt;\/color&amp;gt;\n&amp;lt;\/resources&amp;gt;\n\n\nNow, it looks a little better. If you try to login, you should see the app looks exactly like you&#039;d expect: it&#039;s a web responsive version of the Turbo Chirper app we built on the previous module.\n\n\n\n\n\nThere are a bunch of things we can improve here. Some of the interactions we built for the web don&#039;t really make sense in a mobile UX point-of-view. For instance:\n\n\nAdding a Chirp inline. Or editing a Chirp inline. These features would usually be done in a native modal screen instead of showing the forms inline\nWe&#039;re currently showing the web navbar at the top of the page, but that&#039;s not that useful inside the mobile app (it&#039;s still useful for users visiting our web app from mobile device&#039;s browsers), as menu bars and dropdowns like that kind of breaks the illusion of native screens. Same goes for the edit\/delete Chirp dropdown\nRight now we&#039;re only authenticating users inside the WebView using Cookies. However, it&#039;s not uncommon to need a fully native screen here and there to enhance the mobile experience. For that, we would need to setup some API routes and handle authentication\n\n\nAnd we&#039;re gonna solve all that!&quot;",
        "url": "https://turbo-laravel.com/bootcamp/native-setup",
      },
          "native-authentication": {
        "title": "Native Authentication",
        "content": "&quot;Let&#039;s tackle the mobile authentication first. We&#039;re now able to use the web authentication flow, but as we discussed earlier, sometimes we need to implement fully native screens in our app that uses JSON endpoints with an Access Token. For that reason, we&#039;re gonna change our login flow just for our Hotwire Native Android client. If you were building a Native iOS app, that could also use this same flow.\n\nLaravel has essentially two first-party packages when it comes to Token-based authentication: Laravel Sanctum and Laravel Passport.\n\nFor this Bootcamp, we&#039;re gonna be using Laravel Sanctum, as our flow is a mix of an SPA and mobile authentication flows, both provided by Sanctum.\n\nOh, and we&#039;re going to use Jetpack Compose to build the Login screen. I don&#039;t know about you, but building screens in XML ain&#039;t I&#039;d be proud to show you. Let&#039;s start by adding the Gradle dependencies we need and making some tweaks to our app so Compose works properly.\n\nAdding Jetpack Compose\n\nOpen the Module&#039;s build.gradle file and add the following lines to it:\n\ndependencies {\n    def lifecycle_version = &#039;2.5.1&#039;\n    def compose_version = &#039;1.3.0-rc01&#039; \/\/ Add this\n\n    implementation &#039;androidx.core:core-ktx:1.9.0&#039;\n    implementation &#039;androidx.appcompat:appcompat:1.5.1&#039;\n    implementation &#039;com.google.android.material:material:1.6.1&#039;\n    implementation &#039;androidx.constraintlayout:constraintlayout:2.1.4&#039;\n\n    implementation &#039;dev.hotwire:turbo:7.0.0-rc12&#039;\n    implementation &amp;quot;androidx.lifecycle:lifecycle-livedata-ktx:$lifecycle_version&amp;quot;\n    implementation &amp;quot;androidx.lifecycle:lifecycle-viewmodel-ktx:$lifecycle_version&amp;quot;\n    implementation &amp;quot;androidx.lifecycle:lifecycle-runtime-ktx:$lifecycle_version&amp;quot;\n\n    \/\/ Add these:\n    implementation &amp;quot;androidx.compose.ui:ui:$compose_version&amp;quot;\n    implementation &amp;quot;androidx.compose.material:material:$compose_version&amp;quot;\n    implementation &amp;quot;com.squareup.okhttp3:okhttp:4.10.0&amp;quot;\n    implementation &amp;quot;com.google.code.gson:gson:2.9.1&amp;quot;\n\n    testImplementation &#039;junit:junit:4.13.2&#039;\n    androidTestImplementation &#039;androidx.test.ext:junit:1.1.3&#039;\n    androidTestImplementation &#039;androidx.test.espresso:espresso-core:3.4.0&#039;\n}\n\n\nWe added a bunch of dependencies here, let&#039;s dissect that:\n\n\nThe androidx.compose.ui:ui:* one is the main Jetpack Compose package\nThe androidx.compose.material:material:* comes with a set of Material UI components we can use\nThe com.squareup.okhttp3:okhttp:4.10.0 is the lib we&#039;re gonna use to make HTTP requests from our Native screens\nThe com.google.code.gson:gson:2.9.1 is the lib we&#039;re gonna use to serialize our JSON responses to objects we can use in Kotlin\n\n\nWe also made some changes to the buildFeatures to enable compose and also configured the composeOptions to use a specific version Jetcompose Compose Compiler to work with the Kotlin version I have (which is 1.7.20-RC). I was getting weird compilation errors without this. It was after many attempts that I found this fix (again, I&#039;m no mobile Android expert). If you happen to use a different Kotlin version, make sure you visit the compatibility table to see which version of the Compose Compiler you need.\n\nFor that compiler customization to work, we need to make a change to our settings.gradle file to add the compose compiler&#039;s repository to Maven:\n\ndependencyResolutionManagement {\n    repositoriesMode.set(RepositoriesMode.FAIL_ON_PROJECT_REPOS)\n    repositories {\n        google()\n        mavenCentral()\n        \/\/ Add this:\n        maven {\n            url &amp;quot;https:\/\/androidx.dev\/storage\/compose-compiler\/repository\/&amp;quot;\n        }\n    }\n}\n\n\nOkay, now press that \&quot;Sync now\&quot; link at the top and fingers crossed!\n\n\n\nThe Auth Client Service\n\nNow that we have all the libs in place, let&#039;s start sketching out how this is gonna work.\n\nAs mentioned earlier, we&#039;re gonna need both the Cookie AND the Token authentication in our case. We need the Cookie-based authentication for our shared WebView while the Access Token we&#039;ll store in our app settings so we can reuse it whenever we need to build a fully native screen.\n\nWe&#039;ll handle the Laravel side of this soon. Add these new constants to our util.Constants file:\n\npackage com.example.turbochirpernative.util\n\nconst val BASE_URL = &amp;quot;http:\/\/10.0.2.2&amp;quot;\nconst val CHIRPS_HOME_URL = &amp;quot;$BASE_URL\/chirps&amp;quot;\nconst val API_BASE_URL = &amp;quot;$BASE_URL\/api&amp;quot;\nconst val API_CSRF_COOKIES_URL = &amp;quot;$BASE_URL\/sanctum\/csrf-cookie&amp;quot;\nconst val API_LOGIN_URL = &amp;quot;$API_BASE_URL\/login&amp;quot;\n\n\nNext, let&#039;s create our AuthClient to interact with the API. First, add an \&quot;api\&quot; package to the root of the project (next to the \&quot;features\&quot; package) by right-clicking on the root package then choosing \&quot;New \u003E Package\&quot;. Inside of it, add a new Kotlin class:\n\npackage com.example.turbochirpernative.api\n\nimport android.util.Log\nimport android.webkit.CookieManager\nimport com.example.turbochirpernative.util.API_CSRF_COOKIES_URL\nimport com.example.turbochirpernative.util.API_LOGIN_URL\nimport com.example.turbochirpernative.util.BASE_URL\nimport com.google.gson.Gson\nimport com.google.gson.JsonObject\nimport okhttp3.*\nimport okhttp3.HttpUrl.Companion.toHttpUrl\nimport okhttp3.RequestBody.Companion.toRequestBody\nimport okio.IOException\nimport java.net.URLDecoder\n\nclass AuthClient() {\n    private var CLIENT_USER_AGENT = &amp;quot;Hotwire Native Android HTTP Client&amp;quot;\n\n    private var csrfToken: String = &amp;quot;&amp;quot;\n    private var csrfCookieStored: String = &amp;quot;&amp;quot;\n    private var sessionCookieStored: String = &amp;quot;&amp;quot;\n\n    {{&#039;@&#039;}}Throws(IOException::class)\n    fun fetchCsrfToken(onCsrfTokenFetched: () -&amp;gt; Unit) {\n        val client = OkHttpClient()\n\n        val request: Request = Request.Builder()\n            .url(API_CSRF_COOKIES_URL)\n            .addHeader(&amp;quot;Content-Type&amp;quot;, &amp;quot;application\/json; charset=utf-8&amp;quot;)\n            .addHeader(&amp;quot;Accept&amp;quot;, &amp;quot;application\/json; charset=utf-8&amp;quot;)\n            .addHeader(&amp;quot;User-Agent&amp;quot;, CLIENT_USER_AGENT)\n            .get()\n            .build()\n\n        client.newCall(request).enqueue(object: Callback {\n            override fun onFailure(call: Call, e: java.io.IOException) {\n                e.printStackTrace()\n            }\n\n            override fun onResponse(call: Call, response: Response) {\n                response.use {\n                    val cookieManager = CookieManager.getInstance()\n                    val cookies = Cookie.parseAll(BASE_URL.toHttpUrl(), it.headers)\n\n                    cookies.forEach { cookie -&amp;gt;\n                        if (cookie.name == &amp;quot;XSRF-TOKEN&amp;quot;) {\n                            csrfToken = URLDecoder.decode(cookie.value.toString(), Charsets.UTF_8.name())\n                            csrfCookieStored = cookie.toString()\n                        } else if (cookie.name == &amp;quot;turbo_chirp_native_session&amp;quot;) {\n                            sessionCookieStored = cookie.toString()\n                        }\n\n                        cookieManager.setCookie(BASE_URL, cookie.toString())\n                    }\n                }\n\n                onCsrfTokenFetched()\n            }\n        })\n    }\n\n    {{&#039;@&#039;}}Throws(IOException::class)\n    fun attempt(email: String, password: String, onResponse: (AuthResponse) -&amp;gt; Unit) {\n        val client = OkHttpClient()\n\n        val body = JsonObject()\n        body.addProperty(&amp;quot;email&amp;quot;, email)\n        body.addProperty(&amp;quot;password&amp;quot;, password)\n\n        val request: Request = Request.Builder()\n            .url(API_LOGIN_URL)\n            .addHeader(&amp;quot;Content-Type&amp;quot;, &amp;quot;application\/json; charset=utf-8&amp;quot;)\n            .addHeader(&amp;quot;Accept&amp;quot;, &amp;quot;application\/json; charset=utf-8&amp;quot;)\n            .addHeader(&amp;quot;User-Agent&amp;quot;, CLIENT_USER_AGENT)\n            .addHeader(&amp;quot;X-XSRF-TOKEN&amp;quot;, csrfToken)\n            .addHeader(&amp;quot;Cookie&amp;quot;, &amp;quot;$sessionCookieStored; $csrfCookieStored&amp;quot;)\n            .post(body.toString().toRequestBody())\n            .build()\n\n        client.newCall(request).enqueue(object: Callback {\n            override fun onFailure(call: Call, e: java.io.IOException) {\n                e.printStackTrace()\n            }\n\n            override fun onResponse(call: Call, response: Response) {\n                response.use {\n                    val gson = Gson()\n\n                    when {\n                        it.isSuccessful -&amp;gt; {\n                            Log.i(&amp;quot;AuthClient&amp;quot;, &amp;quot;HTTP request worked!&amp;quot;)\n\n                            val cookieManager = CookieManager.getInstance()\n                            val cookies = Cookie.parseAll(BASE_URL.toHttpUrl(), it.headers)\n\n                            cookies.forEach { cookie -&amp;gt;\n                                Log.i(&amp;quot;AuthClient&amp;quot;, &amp;quot;Received cookie &amp;quot; + cookie.name + &amp;quot; adding to the CookieManager...&amp;quot;)\n\n                                cookieManager.setCookie(BASE_URL, cookie.toString())\n                            }\n\n                            val login = gson.fromJson(it.body?.string(), LoginSuccessful::class.java)\n\n                            onResponse(AuthResponse(\n                                ok = true,\n                                successResponse = login,\n                                failedResponse = null,\n                            ))\n                        }\n                        else -&amp;gt; {\n                            Log.i(&amp;quot;AuthClient&amp;quot;, &amp;quot;HTTP request failed!&amp;quot;)\n\n                            onResponse(AuthResponse(\n                                ok = false,\n                                failedResponse = gson.fromJson(it.body?.string(), FailedResponse::class.java),\n                                successResponse = null,\n                            ))\n                        }\n                    }\n                }\n            }\n        })\n    }\n}\n\ndata class AuthResponse(\n    var ok: Boolean,\n    var successResponse: LoginSuccessful?,\n    var failedResponse: FailedResponse?,\n)\n\ndata class UserData(\n    val name: String,\n)\n\ndata class LoginSuccessful(\n    val token: String,\n    val data: UserData,\n    val redirectTo: String?,\n)\n\ndata class InvalidLoginResponse(\n    val email: Array&amp;lt;String&amp;gt;?,\n    val password: Array&amp;lt;String&amp;gt;?,\n)\n\ndata class FailedResponse(\n    val message: String,\n    val errors: InvalidLoginResponse,\n)\n\n\nI know there&#039;s a lot here. I&#039;m not that good in Kotlin, but this is not the point of this bootcamp. We&#039;re essentially adding a method to fetch the CSRF token used to get the Cookie authentication working, which we can use like so:\n\nAuthClient().fetchCsrfToken {\n    \/\/ It worked, do something after...\n}\n\n\nThis method will make an HTTP call to the \/sanctum\/csrf-cookie route provided by Sanctum. That route will return the Cookies we need in order to successfully authenticate, since we&#039;re gonna use the CSRF protection middleware from Laravel in the API routes.\n\nWe&#039;d need a way to store the cookies so they&#039;d automatically be added to the CookieManager whenever a response is received by the HTTP Client in whatever context, not just for the auth one. Anyways, for our purposes, this will do.\n\nThis code also adds the method to attempt authenticating, which should call an endpoint at \/api\/login, which will create soon when we&#039;re handling the Laravel side of things. This is how the attempt method may be used:\n\nAuthClient().attempt(email, password) { it -&amp;gt;\n    \/\/ &amp;quot;it&amp;quot; in this case is an instance of the `AuthResponse` class\n    \/\/ we created in the same file as the `AuthClient`...\n}\n\n\nWith that in place, let&#039;s build the Login Screen!\n\nThe Native Login Screen\n\nCreate the features.auth package. And, before we create the LoginFragment, we&#039;ll add two interfaces that it&#039;s gonna use. First, add a CsrfTokenCallback interface to the features.auth package with the following contents:\n\npackage com.example.turbochirpernative.features.auth\n\ninterface CsrfTokenCallback {\n    fun onCsrfTokenFetched()\n}\n\n\nThen, add a LoginRequestCallback interface also in the features.auth package:\n\npackage com.example.turbochirpernative.features.auth\n\ninterface LoginRequestCallback {\n    fun onLoginSucceeded(url: String)\n    fun onLoginFailed(msg: String)\n}\n\n\nNext, add the LoginFragment also to the features.auth package:\n\npackage com.example.turbochirpernative.features.auth\n\nimport android.os.Bundle\nimport android.view.LayoutInflater\nimport android.view.View\nimport android.view.ViewGroup\nimport android.widget.Toast\nimport androidx.compose.foundation.layout.Arrangement\nimport androidx.compose.foundation.layout.Column\nimport androidx.compose.foundation.layout.fillMaxWidth\nimport androidx.compose.foundation.layout.padding\nimport androidx.compose.material.Button\nimport androidx.compose.material.MaterialTheme\nimport androidx.compose.material.OutlinedTextField\nimport androidx.compose.material.Text\nimport androidx.compose.runtime.Composable\nimport androidx.compose.runtime.DisposableEffect\nimport androidx.compose.runtime.mutableStateOf\nimport androidx.compose.runtime.remember\nimport androidx.compose.ui.Alignment\nimport androidx.compose.ui.Modifier\nimport androidx.compose.ui.platform.ComposeView\nimport androidx.compose.ui.text.TextStyle\nimport androidx.compose.ui.text.font.FontWeight\nimport androidx.compose.ui.text.input.PasswordVisualTransformation\nimport androidx.compose.ui.text.input.TextFieldValue\nimport androidx.compose.ui.unit.dp\nimport androidx.compose.ui.unit.sp\nimport com.example.turbochirpernative.api.AuthClient\nimport dev.hotwire.turbo.fragments.TurboFragment\nimport dev.hotwire.turbo.nav.TurboNavGraphDestination\n\n{{&#039;@&#039;}}TurboNavGraphDestination(uri = &amp;quot;turbo:\/\/fragment\/auth\/login&amp;quot;)\nclass LoginFragment : TurboFragment(), LoginRequestCallback, CsrfTokenCallback {\n    private val authClient = AuthClient()\n\n    override fun onCreateView(\n        inflater: LayoutInflater, container: ViewGroup?,\n        savedInstanceState: Bundle?\n    ): View {\n        return ComposeView(requireContext()).apply {\n            setContent {\n                MaterialTheme {\n                    LoginScreen()\n                }\n            }\n        }\n    }\n\n    {{&#039;@&#039;}}Composable\n    private fun LoginScreen() {\n        DisposableEffect(true) {\n            fetchCsrfToken()\n\n            onDispose {  }\n        }\n\n        Column(Modifier.fillMaxWidth(), horizontalAlignment = Alignment.CenterHorizontally, verticalArrangement = Arrangement.Center) {\n\n            val email = remember { mutableStateOf(TextFieldValue(&amp;quot;&amp;quot;)) }\n            val password = remember { mutableStateOf(TextFieldValue(&amp;quot;&amp;quot;)) }\n\n            Text(&amp;quot;Turbo Chirp Native&amp;quot;, fontSize = 30.sp, style = TextStyle(fontWeight = FontWeight.Bold))\n            Text(&amp;quot;Login&amp;quot;, fontSize = 24.sp, modifier = Modifier.padding(top = 10.dp))\n            Column(modifier = Modifier.padding(vertical = 16.dp)) {\n                OutlinedTextField(\n                    label = { Text(&amp;quot;Email&amp;quot;) },\n                    singleLine = true,\n                    value = email.value,\n                    onValueChange = { email.value = it }\n                )\n            }\n            Column(modifier = Modifier.padding(vertical = 10.dp)) {\n                OutlinedTextField(\n                    label = { Text(&amp;quot;Password&amp;quot;) },\n                    singleLine = true,\n                    value = password.value,\n                    onValueChange = { password.value = it },\n                    visualTransformation = PasswordVisualTransformation(),\n                )\n            }\n            Column(modifier = Modifier.padding(vertical = 10.dp)) {\n                Button(onClick = {\n                    if (! email.value.text.isEmpty() &amp;amp;&amp;amp; ! password.value.text.isEmpty()) {\n                        authClient.attempt(email.value.text, password.value.text) {\n                            if (it.ok) {\n                                onLoginSucceeded(it.successResponse?.redirectTo + &amp;quot;&amp;quot;)\n                            } else {\n                                onLoginFailed(it.failedResponse?.message ?: &amp;quot;Something went wrong!&amp;quot;)\n                            }\n                        }\n                    }\n                }) {\n                    Text(&amp;quot;Login&amp;quot;)\n                }\n            }\n        }\n    }\n\n    override fun onLoginSucceeded(url: String) {\n        activity?.runOnUiThread { navigate(url) }\n    }\n\n    override fun onLoginFailed(msg: String) {\n        activity?.runOnUiThread {\n            Toast.makeText(context, msg, Toast.LENGTH_SHORT).show()\n        }\n    }\n\n    override fun onCsrfTokenFetched() {\n        activity?.runOnUiThread {\n            Toast.makeText(context, &amp;quot;CSRF Token fetched!&amp;quot;, Toast.LENGTH_SHORT).show()\n        }\n    }\n\n    private fun fetchCsrfToken() {\n        authClient.fetchCsrfToken() {\n            onCsrfTokenFetched()\n        }\n    }\n}\n\n\nThere&#039;s a lot going on in this screen, and we&#039;re not gonna talk about it much. The important thing to note here is that we&#039;re instantiating the authClient as an attribute to the LoginFragment instance. This is important because we&#039;re storing the CSRF Token, Cookie, and the Laravel Session cookie in the AuthClient instance, so we can&#039;t just create a new instance of the AuthClient whenever we want.\n\nAlso, we&#039;re calling the authClient.fetchCsrfToken() in a DisposableEffect to make sure it only calls it once when Compose mounts this screen. Then, whenever the user types non-blank email and password fields to the inputs we have just created, we&#039;ll call the authClient.attempt() with it. We&#039;re using Toast messages here and there to give some feedback on what&#039;s going on. That&#039;s more for us than for actual users of our app, so feel free to remove those if you want to.\n\nFinally, let&#039;s register our fragment in the MainSessionNavHostFragment:\n\npackage com.example.turbochirpernative.main\n\nimport android.webkit.WebView\nimport androidx.appcompat.app.AppCompatActivity\nimport androidx.fragment.app.Fragment\nimport com.example.turbochirpernative.BuildConfig\n\nimport com.example.turbochirpernative.features.auth.LoginFragment\nimport com.example.turbochirpernative.features.web.WebFragment\n\nimport com.example.turbochirpernative.util.CHIRPS_HOME_URL\nimport dev.hotwire.turbo.config.TurboPathConfiguration\nimport dev.hotwire.turbo.session.TurboSessionNavHostFragment\nimport kotlin.reflect.KClass\n\nclass MainSessionNavHostFragment : TurboSessionNavHostFragment() {\n    \/\/ ...\n\n    override val registeredFragments: List&amp;lt;KClass&amp;lt;out Fragment&amp;gt;&amp;gt;\n        get() = listOf(\n            WebFragment::class,\n            LoginFragment::class, \/\/ Add this\n        )\n\n    \/\/ ...\n}\n\n\nThen, add the new entry to the assets\/json\/configuration.json to tell Turbo to render the LoginFragment whenever we&#039;re visiting the \/login route:\n\n{\n  &amp;quot;settings&amp;quot;: {\n    &amp;quot;screenshots_enabled&amp;quot;: true\n  },\n  &amp;quot;rules&amp;quot;: [\n    {\n      &amp;quot;patterns&amp;quot;: [\n        &amp;quot;.*&amp;quot;\n      ],\n      &amp;quot;properties&amp;quot;: {\n        &amp;quot;context&amp;quot;: &amp;quot;default&amp;quot;,\n        &amp;quot;uri&amp;quot;: &amp;quot;turbo:\/\/fragment\/web&amp;quot;,\n        &amp;quot;pull_to_refresh_enabled&amp;quot;: true\n      }\n    },\n    {\n      &amp;quot;patterns&amp;quot;: [\n        &amp;quot;login$&amp;quot;,\n        &amp;quot;login\/$&amp;quot;\n      ],\n      &amp;quot;properties&amp;quot;: {\n        &amp;quot;context&amp;quot;: &amp;quot;default&amp;quot;,\n        &amp;quot;uri&amp;quot;: &amp;quot;turbo:\/\/fragment\/auth\/login&amp;quot;,\n        &amp;quot;pull_to_refresh_enabled&amp;quot;: false\n      }\n    }\n  ]\n}\n\n\nThis is what the project structure should look like for you:\n\n\n\nBefore we&#039;re able to test this, we need add Sanctum and our API routes to the Laravel side of our Chirper web app!\n\nSetting up Sanctum and the API Endpoints\n\nOur Sanctum installation process will follow the docs with one exception. First thing is the Sanctum installation. In the chirper web app root folder, install Sanctum via Composer:\n\ncomposer require laravel\/sanctum\n\n\nNext, publish the configuration file:\n\nphp artisan vendor:publish --provider=&amp;quot;Laravel\\Sanctum\\SanctumServiceProvider&amp;quot;\n\n\nThen, migrate the database:\n\nphp artisan migrate\n\n\nNow is the exception part. Sanctum&#039;s default installation recommends adding the EnsureFrontendRequestsAreStateful middleware that ships with Sanctum at the top of the API route group middleware stack. Instead, we&#039;re gonna create our own. We&#039;re also adding the TurboMiddleware to that route group:\n\n&amp;lt;?php\n\nnamespace App\\Http;\n\nuse Illuminate\\Foundation\\Http\\Kernel as HttpKernel;\n\nclass Kernel extends HttpKernel\n{\n    \/\/ ...\n\n    \/**\n     * The application&#039;s route middleware groups.\n     *\n     * {{&#039;@&#039;}}var array&amp;lt;string, array&amp;lt;int, class-string|string&amp;gt;&amp;gt;\n     *\/\n    protected $middlewareGroups = [\n        &#039;web&#039; =&amp;gt; [\n            \/\/ ...\n        ],\n\n        &#039;api&#039; =&amp;gt; [\n            \\HotwiredLaravel\\TurboLaravel\\Http\\Middleware\\TurboMiddleware::class,\n            \\App\\Http\\Middleware\\EnsureTurboNativeRequestsAreStateful::class, \/\/ Add this\n            &#039;throttle:api&#039;,\n            \\Illuminate\\Routing\\Middleware\\SubstituteBindings::class,\n        ],\n    ];\n\n    \/\/ ...\n}\n\n\nNow, let&#039;s create our own EnsureFrontendRequestsAreStateful in the app\/Http\/Middleware\/ folder:\n\n&amp;lt;?php\n\nnamespace App\\Http\\Middleware;\n\nuse Illuminate\\Routing\\Pipeline;\nuse Illuminate\\Support\\Collection;\nuse Illuminate\\Support\\Str;\n\nclass EnsureTurboNativeRequestsAreStateful\n{\n    \/**\n     * Handle the incoming requests.\n     *\n     * {{&#039;@&#039;}}param  \\Illuminate\\Http\\Request  $request\n     * {{&#039;@&#039;}}param  callable  $next\n     * {{&#039;@&#039;}}return \\Illuminate\\Http\\Response\n     *\/\n    public function handle($request, $next)\n    {\n        $this-&amp;gt;configureSecureCookieSessions();\n\n        return (new Pipeline(app()))-&amp;gt;send($request)-&amp;gt;through($request-&amp;gt;wasFromTurboNative() ? [\n            function ($request, $next) {\n                $request-&amp;gt;attributes-&amp;gt;set(&#039;turbo-native&#039;, true);\n\n                return $next($request);\n            },\n            config(&#039;turbo-laravel.middleware.encrypt_cookies&#039;, \\Illuminate\\Cookie\\Middleware\\EncryptCookies::class),\n            \\Illuminate\\Cookie\\Middleware\\AddQueuedCookiesToResponse::class,\n            \\Illuminate\\Session\\Middleware\\StartSession::class,\n            config(&#039;turbo-laravel.middleware.verify_csrf_token&#039;, \\Illuminate\\Foundation\\Http\\Middleware\\VerifyCsrfToken::class),\n        ] : [])-&amp;gt;then(function ($request) use ($next) {\n            return $next($request);\n        });\n    }\n\n    \/**\n     * Configure secure cookie sessions.\n     *\n     * {{&#039;@&#039;}}return void\n     *\/\n    protected function configureSecureCookieSessions()\n    {\n        config([\n            &#039;session.http_only&#039; =&amp;gt; true,\n            &#039;session.same_site&#039; =&amp;gt; &#039;lax&#039;,\n        ]);\n    }\n}\n\n\nNow, let&#039;s add our login route to the routes\/api.php entrypoint:\n\n&amp;lt;?php\n\nuse App\\Models\\User;\nuse Illuminate\\Http\\Request;\nuse Illuminate\\Support\\Facades\\Auth;\nuse Illuminate\\Support\\Facades\\Hash;\nuse Illuminate\\Support\\Facades\\Route;\nuse Illuminate\\Validation\\ValidationException;\n\n\/\/ Add this:\nRoute::post(&#039;\/login&#039;, function (Request $request) {\n    $credentials = $request-&amp;gt;validate([\n        &#039;email&#039; =&amp;gt; &#039;required|email&#039;,\n        &#039;password&#039; =&amp;gt; &#039;required&#039;,\n    ]);\n\n    if (! Auth::attempt($credentials, true)) {\n        throw ValidationException::withMessages([\n            &#039;email&#039; =&amp;gt; [&#039;The provided credentials are incorrect.&#039;],\n        ]);\n    }\n\n    $request-&amp;gt;session()-&amp;gt;regenerate();\n\n    return [\n        &#039;token&#039; =&amp;gt; Auth::user()-&amp;gt;createToken(&#039;Hotwire Native&#039;)-&amp;gt;plainTextToken,\n        &#039;redirectTo&#039; =&amp;gt; route(&#039;chirps.index&#039;),\n        &#039;data&#039; =&amp;gt; [\n            &#039;name&#039; =&amp;gt; Auth::user()-&amp;gt;name,\n        ],\n    ];\n});\n\n\/\/ ...\n\n\nNow, we&#039;re ready to test it!\n\nTesting Out\n\nIf you want to, purge all your sessions in the Laravel app by deleting all the files in the storage\/framework\/sessions\/ folder (assuming you&#039;re using the file session driver):\n\nrm -f storage\/framework\/sessions\/*\n\n\nNow, go back to Android Studio and build the client again. You should see the login screen and if you authenticate, you should then be sent to the chirps home page!\n\n\n\n\n\n\n\nOur access token is being stored in the preferences section of our app, which means we can reuse it whenever we need to make an HTTP call with a native screen and our WebView is successfully authenticated, so we don&#039;t need to worry about those screens that don&#039;t need native authentication anymore. Yay! Next, let&#039;s take a look at improving our mobile UX for creating Chirps.&quot;",
        "url": "https://turbo-laravel.com/bootcamp/native-auth",
      },
          "our-first-bridge-component": {
        "title": "Our First Bridge Component",
        "content": "&quot;Rendering the create chirps form inline right on the homepage isn&#039;t the best UX for mobile. Instead, it would be better to display the form as a native modal screen. Let&#039;s implement that, but first, let&#039;s hide the entire create chirps form on Hotwire Native.\n\nHiding the Elements for Hotwire Native only\n\nWe could technically prevent the entire section from even rendering on requests made by Hotwire Native clients using the @unlessturbonative Blade directives, something like this:\n\n&amp;lt;x-app-layout&amp;gt;\n    &amp;lt;x-slot name=&amp;quot;header&amp;quot;&amp;gt;\n        &amp;lt;h2 class=&amp;quot;font-semibold text-xl text-gray-800 leading-tight&amp;quot;&amp;gt;\n            @{{ __(&#039;Chirps&#039;) }}\n        &amp;lt;\/h2&amp;gt;\n    &amp;lt;\/x-slot&amp;gt;\n\n    &amp;lt;div class=&amp;quot;max-w-2xl mx-auto p-4 sm:p-6 lg:p-8&amp;quot;&amp;gt;\n        &amp;lt;!-- Add this: --&amp;gt;\n        {{&#039;@&#039;}}unlessturbonative\n        &amp;lt;x-turbo::frame id=&amp;quot;create_chirp&amp;quot; src=&amp;quot;@{{ route(&#039;chirps.create&#039;) }}&amp;quot;&amp;gt;\n            &amp;lt;div class=&amp;quot;relative flex items-center justify-center py-10 px-4 rounded-lg border border-dotted border-gray-300&amp;quot;&amp;gt;\n                &amp;lt;a class=&amp;quot;text-gray-700&amp;quot; href=&amp;quot;@{{ route(&#039;chirps.create&#039;) }}&amp;quot;&amp;gt;\n                    Add a new Chirp\n                    &amp;lt;span class=&amp;quot;absolute inset-0&amp;quot;&amp;gt;&amp;lt;\/span&amp;gt;\n                &amp;lt;\/a&amp;gt;\n            &amp;lt;\/div&amp;gt;\n        &amp;lt;\/x-turbo::frame&amp;gt;\n        {{&#039;@&#039;}}endunlessturbonative\n\n        &amp;lt;div id=&amp;quot;chirps&amp;quot; class=&amp;quot;mt-6 bg-white shadow-sm rounded-lg divide-y&amp;quot;&amp;gt;\n            {{&#039;@&#039;}}each(&#039;chirps._chirp&#039;, $chirps, &#039;chirp&#039;)\n        &amp;lt;\/div&amp;gt;\n    &amp;lt;\/div&amp;gt;\n&amp;lt;\/x-app-layout&amp;gt;\n\n\nThis would work, but that makes this page harder to cache. Not a problem now, but I prefer doing things like that on the client-side with CSS and a bit of JS.\n\nSince we have configured our WebView to use a custom User-Agent header, we can actually detect when our webapp is running inside a Hotwire Native client by checking that. Let&#039;s first add a helper to check the platform by creating a resources\/js\/helpers\/platform.js file with the following contents:\n\nconst { userAgent } = window.navigator;\n\nexport const isIos = \/iPhone|iPad\/.test(userAgent)\nexport const isAndroid = \/Android\/.test(userAgent)\nexport const isMobile = isIos || isAndroid\n\nexport const isIosApp = \/Hotwire Native iOS\/.test(userAgent)\nexport const isAndroidApp = \/Hotwire Native Android\/.test(userAgent)\nexport const isMobileApp = isIosApp || isAndroidApp\n\n\nNow, let&#039;s update our resources\/js\/app.js file to add a turbo-native class to out HTML document:\n\nimport &#039;.\/bootstrap&#039;;\nimport &#039;.\/elements\/turbo-echo-stream-tag&#039;;\nimport &#039;.\/libs&#039;;\nimport &#039;{{&#039;@&#039;}}github\/time-elements&#039;;\n\n\/\/ Add this:\nimport { isMobileApp } from &#039;.\/helpers\/platform&#039;;\n\nif (isMobileApp) {\n    document.documentElement.classList.add(&#039;turbo-native&#039;);\n}\n\n\nThis will ensure that when our web app runs inside a Hotwire Native client, a .turbo-native class will be added to the &amp;lt;html&amp;gt; element in our page, but we&#039;re not doing anything yet with it. Let&#039;s create a custom Tailwind CSS modifier that will allow us to make things behave differently when the .turbo-native class is present in the document.\n\nTo do that, open the tailwind.config.js file in the root of your Laravel app and make the following changes:\n\nconst defaultTheme = require(&#039;tailwindcss\/defaultTheme&#039;);\nconst plugin = require(&#039;tailwindcss\/plugin&#039;); \/\/ Add this\n\n\/** {{&#039;@&#039;}}type {import(&#039;tailwindcss&#039;).Config} *\/\nmodule.exports = {\n    \/\/ ...\n\n    plugins: [\n        require(&amp;quot;{{&#039;@&#039;}}tailwindcss\/forms&amp;quot;),\n        \/\/ Add this:\n        plugin(function ({ addVariant }) {\n            return addVariant(&#039;turbo-native&#039;, [&#039;&amp;amp;.turbo-native&#039;, &#039;.turbo-native &amp;amp;&#039;]);\n        }),\n    ],\n};\n\n\nWith that, we can use the new modifier like any other default modifier in Tailwind. Let&#039;s use it to hide the create chirps form on the index page for Hotwire Native clients. Open the resources\/views\/chirps\/index.blade.php and make the following changes:\n\n&amp;lt;x-app-layout&amp;gt;\n    &amp;lt;!-- ... --&amp;gt;\n\n    &amp;lt;div class=&amp;quot;max-w-2xl mx-auto p-4 sm:p-6 lg:p-8&amp;quot;&amp;gt;\n        &amp;lt;!-- Update the Turbo Frame: --&amp;gt;\n        &amp;lt;x-turbo::frame id=&amp;quot;create_chirp&amp;quot; src=&amp;quot;@{{ route(&#039;chirps.create&#039;) }}&amp;quot; class=&amp;quot;turbo-native:hidden&amp;quot; loading=&amp;quot;lazy&amp;quot;&amp;gt;\n            &amp;lt;div class=&amp;quot;relative flex items-center justify-center py-10 px-4 rounded-lg border border-dotted border-gray-300&amp;quot;&amp;gt;\n                &amp;lt;a class=&amp;quot;text-gray-700&amp;quot; href=&amp;quot;@{{ route(&#039;chirps.create&#039;) }}&amp;quot;&amp;gt;\n                    Add a new Chirp\n                    &amp;lt;span class=&amp;quot;absolute inset-0&amp;quot;&amp;gt;&amp;lt;\/span&amp;gt;\n                &amp;lt;\/a&amp;gt;\n            &amp;lt;\/div&amp;gt;\n        &amp;lt;\/x-turbo::frame&amp;gt;\n\n        &amp;lt;div id=&amp;quot;chirps&amp;quot; class=&amp;quot;mt-6 bg-white shadow-sm rounded-lg divide-y&amp;quot;&amp;gt;\n            {{&#039;@&#039;}}each(&#039;chirps._chirp&#039;, $chirps, &#039;chirp&#039;)\n        &amp;lt;\/div&amp;gt;\n    &amp;lt;\/div&amp;gt;\n&amp;lt;\/x-app-layout&amp;gt;\n\n\n\n\nLet&#039;s also tweak our index page a bit to remove some padding and unnecessary margins:\n\n&amp;lt;x-app-layout&amp;gt;\n    &amp;lt;!-- ... --&amp;gt;\n\n    &amp;lt;!-- Update this element: --&amp;gt;\n    &amp;lt;div class=&amp;quot;max-w-2xl mx-auto p-4 sm:p-6 lg:p-8 turbo-native:p-0&amp;quot;&amp;gt;\n        &amp;lt;x-turbo::frame id=&amp;quot;create_chirp&amp;quot; src=&amp;quot;@{{ route(&#039;chirps.create&#039;) }}&amp;quot; class=&amp;quot;turbo-native:hidden&amp;quot; loading=&amp;quot;lazy&amp;quot;&amp;gt;\n            &amp;lt;!-- ... --&amp;gt;\n        &amp;lt;\/x-turbo::frame&amp;gt;\n\n        &amp;lt;!-- Update this element: --&amp;gt;\n        &amp;lt;div id=&amp;quot;chirps&amp;quot; class=&amp;quot;mt-6 bg-white shadow-sm rounded-lg divide-y turbo-native:mt-0&amp;quot;&amp;gt;\n            {{&#039;@&#039;}}each(&#039;chirps._chirp&#039;, $chirps, &#039;chirp&#039;)\n        &amp;lt;\/div&amp;gt;\n    &amp;lt;\/div&amp;gt;\n&amp;lt;\/x-app-layout&amp;gt;\n\n\nLet&#039;s also hide the web nav bar for Hotwire Native users, our navigation should be fully native on the mobile clients anyways. To do that, change the resources\/views\/layouts\/navigation.blade.php file:\n\n&amp;lt;!-- Update the root nav element: --&amp;gt;\n&amp;lt;nav x-data=&amp;quot;{ open: false }&amp;quot; class=&amp;quot;bg-white border-b border-gray-100 turbo-native:hidden&amp;quot;&amp;gt;\n    &amp;lt;!-- ... --&amp;gt;\n&amp;lt;\/nav&amp;gt;\n\n\nLet&#039;s also hide the header section in the resources\/views\/layouts\/app.blade.php layout file:\n\n&amp;lt;!-- Update the Header element: --&amp;gt;\n&amp;lt;header class=&amp;quot;bg-white shadow turbo-native:hidden&amp;quot;&amp;gt;\n    &amp;lt;!-- ... --&amp;gt;\n&amp;lt;\/header&amp;gt;\n\n\nAnd our page should look like this:\n\n\n\nAdding the Floating Action Button\n\nNow that the create chirps form is hidden, we need to allow our users to somehow navigate to the create chirps form. Let&#039;s create our custom ChirpsHomeFragment that will be specific to the chirps.index route.\n\nCreate a new Kotlin class inside the features.web package and call it ChirpsHomeFragment:\n\npackage com.example.turbochirpernative.features.web\n\nimport android.os.Bundle\nimport android.view.LayoutInflater\nimport android.view.View\nimport android.view.ViewGroup\nimport com.example.turbochirpernative.R\nimport dev.hotwire.turbo.nav.TurboNavGraphDestination\n\n{{&#039;@&#039;}}TurboNavGraphDestination(uri = &amp;quot;turbo:\/\/fragment\/chirps\/index&amp;quot;)\nclass ChirpsHomeFragment: WebFragment() {\n    override fun onCreateView(inflater: LayoutInflater, container: ViewGroup?, savedInstanceState: Bundle?): View? {\n        return inflater.inflate(R.layout.fragment_chirps_home, container, false)\n    }\n}\n\n\nNotice that we&#039;re extending the WebFragment class so we need to make it open:\n\npackage com.example.turbochirpernative.features.web\n\nimport android.os.Bundle\nimport android.view.LayoutInflater\nimport android.view.View\nimport android.view.ViewGroup\nimport com.example.turbochirpernative.R\nimport dev.hotwire.turbo.fragments.TurboWebFragment\nimport dev.hotwire.turbo.nav.TurboNavGraphDestination\n\n{{&#039;@&#039;}}TurboNavGraphDestination(uri = &amp;quot;turbo:\/\/fragment\/web&amp;quot;)\nopen class WebFragment: TurboWebFragment() {\n\n    override fun onCreateView(inflater: LayoutInflater, container: ViewGroup?, savedInstanceState: Bundle?): View? {\n        return inflater.inflate(R.layout.fragment_web, container, false)\n    }\n\n    override fun onVisitCompleted(location: String, completedOffline: Boolean) {\n        super.onVisitCompleted(location, completedOffline)\n\n        val script = &amp;quot;window.NativeBridge.start();&amp;quot;\n        session.webView.evaluateJavascript(script, null)\n    }\n}\n\n\nAlso, we&#039;re rendering a different layout file, so we need to create it. Add a new layout file by right-clicking on the res\/layout folder and choosing the \&quot;New -\u003E Layout Resource File\&quot; option in the menu, add the following contents to it:\n\n&amp;lt;?xml version=&amp;quot;1.0&amp;quot; encoding=&amp;quot;utf-8&amp;quot;?&amp;gt;\n&amp;lt;androidx.constraintlayout.widget.ConstraintLayout\n    xmlns:android=&amp;quot;http:\/\/schemas.android.com\/apk\/res\/android&amp;quot;\n    xmlns:app=&amp;quot;http:\/\/schemas.android.com\/apk\/res-auto&amp;quot;\n    xmlns:tools=&amp;quot;http:\/\/schemas.android.com\/tools&amp;quot;\n    android:layout_width=&amp;quot;match_parent&amp;quot;\n    android:layout_height=&amp;quot;match_parent&amp;quot;&amp;gt;\n\n    &amp;lt;com.google.android.material.appbar.AppBarLayout\n        android:id=&amp;quot;{{&#039;@&#039;}}+id\/app_bar&amp;quot;\n        android:layout_width=&amp;quot;match_parent&amp;quot;\n        android:layout_height=&amp;quot;wrap_content&amp;quot;\n        android:background=&amp;quot;?colorPrimary&amp;quot;\n        app:layout_constraintEnd_toEndOf=&amp;quot;parent&amp;quot;\n        app:layout_constraintStart_toStartOf=&amp;quot;parent&amp;quot;\n        app:layout_constraintTop_toTopOf=&amp;quot;parent&amp;quot;&amp;gt;\n\n        &amp;lt;com.google.android.material.appbar.MaterialToolbar\n            android:id=&amp;quot;{{&#039;@&#039;}}+id\/toolbar&amp;quot;\n            android:layout_width=&amp;quot;match_parent&amp;quot;\n            app:titleTextColor=&amp;quot;?colorOnPrimary&amp;quot;\n            android:layout_height=&amp;quot;wrap_content&amp;quot; \/&amp;gt;\n\n    &amp;lt;\/com.google.android.material.appbar.AppBarLayout&amp;gt;\n\n    &amp;lt;include\n        layout=&amp;quot;{{&#039;@&#039;}}layout\/turbo_view&amp;quot;\n        android:layout_width=&amp;quot;match_parent&amp;quot;\n        android:layout_height=&amp;quot;0dp&amp;quot;\n        app:layout_constraintBottom_toBottomOf=&amp;quot;parent&amp;quot;\n        app:layout_constraintTop_toBottomOf=&amp;quot;{{&#039;@&#039;}}+id\/app_bar&amp;quot; \/&amp;gt;\n\n    &amp;lt;com.google.android.material.floatingactionbutton.FloatingActionButton\n        android:id=&amp;quot;{{&#039;@&#039;}}+id\/floatingActionButton&amp;quot;\n        android:layout_width=&amp;quot;wrap_content&amp;quot;\n        android:layout_height=&amp;quot;wrap_content&amp;quot;\n        android:layout_margin=&amp;quot;16dp&amp;quot;\n        android:clickable=&amp;quot;true&amp;quot;\n        android:focusable=&amp;quot;true&amp;quot;\n        android:tint=&amp;quot;{{&#039;@&#039;}}color\/white&amp;quot;\n        app:tint=&amp;quot;{{&#039;@&#039;}}color\/white&amp;quot;\n        app:backgroundTint=&amp;quot;{{&#039;@&#039;}}color\/indigo_500&amp;quot;\n        app:layout_constraintBottom_toBottomOf=&amp;quot;parent&amp;quot;\n        app:layout_constraintEnd_toEndOf=&amp;quot;parent&amp;quot;\n        app:srcCompat=&amp;quot;{{&#039;@&#039;}}android:drawable\/ic_input_add&amp;quot;\n        android:contentDescription=&amp;quot;New Chirp&amp;quot;\n    \/&amp;gt;\n\n&amp;lt;\/androidx.constraintlayout.widget.ConstraintLayout&amp;gt;\n\n\nNow, let&#039;s register our new fragment in the MainSessionNavHostFragment:\n\n\/\/ ...\n\nclass MainSessionNavHostFragment : TurboSessionNavHostFragment() {\n    override val registeredFragments: List&amp;lt;KClass&amp;lt;out Fragment&amp;gt;&amp;gt;\n        get() = listOf(\n            WebFragment::class,\n            LoginFragment::class,\n            ChirpsHomeFragment::class, \/\/ Add this\n        )\n\n    \/\/ ...\n}\n\n\nNow, let&#039;s configure our route path in the assets\/json\/configuration.json file to open that fragment whenever we visit the chirps.index route:\n\n{\n  &amp;quot;settings&amp;quot;: {\n    &amp;quot;screenshots_enabled&amp;quot;: true\n  },\n  &amp;quot;rules&amp;quot;: [\n    {\n      &amp;quot;patterns&amp;quot;: [\n        &amp;quot;.*&amp;quot;\n      ],\n      &amp;quot;properties&amp;quot;: {\n        &amp;quot;context&amp;quot;: &amp;quot;default&amp;quot;,\n        &amp;quot;uri&amp;quot;: &amp;quot;turbo:\/\/fragment\/web&amp;quot;,\n        &amp;quot;pull_to_refresh_enabled&amp;quot;: true\n      }\n    },\n    {\n      &amp;quot;patterns&amp;quot;: [\n        &amp;quot;login$&amp;quot;,\n        &amp;quot;login\/$&amp;quot;\n      ],\n      &amp;quot;properties&amp;quot;: {\n        &amp;quot;context&amp;quot;: &amp;quot;default&amp;quot;,\n        &amp;quot;uri&amp;quot;: &amp;quot;turbo:\/\/fragment\/auth\/login&amp;quot;,\n        &amp;quot;pull_to_refresh_enabled&amp;quot;: false\n      }\n    },\n    {\n      &amp;quot;patterns&amp;quot;: [\n        &amp;quot;chirps$&amp;quot;,\n        &amp;quot;chirps\/$&amp;quot;\n      ],\n      &amp;quot;properties&amp;quot;: {\n        &amp;quot;context&amp;quot;: &amp;quot;default&amp;quot;,\n        &amp;quot;uri&amp;quot;: &amp;quot;turbo:\/\/fragment\/chirps\/index&amp;quot;,\n        &amp;quot;pull_to_refresh_enabled&amp;quot;: true\n      }\n    }\n  ]\n}\n\n\nNotice that the URI matches what we defined in the ChirpsHomeFragment: turbo:\/\/fragment\/chirps\/index.\n\nAt this point, our app looks like this:\n\n\n\nBut our button doesn&#039;t work yet. Let&#039;s tell Hotwire Native to make a visit to the chirps\/create route. First, add the new constant to the util.Constants file:\n\npackage com.example.turbochirpernative.util\n\nconst val BASE_URL = &amp;quot;http:\/\/10.0.2.2&amp;quot;\nconst val CHIRPS_HOME_URL = &amp;quot;$BASE_URL\/chirps&amp;quot;\nconst val CHIRPS_CREATE_URL = &amp;quot;$CHIRPS_HOME_URL\/create&amp;quot; \/\/ Add this\n\nconst val API_BASE_URL = &amp;quot;$BASE_URL\/api&amp;quot;\nconst val API_CSRF_COOKIES_URL = &amp;quot;$BASE_URL\/sanctum\/csrf-cookie&amp;quot;\nconst val API_LOGIN_URL = &amp;quot;$API_BASE_URL\/login&amp;quot;\n\n\nNow, change the ChirpsHomeFragment to setup the click handler on that fab:\n\n{{&#039;@&#039;}}TurboNavGraphDestination(uri = &amp;quot;turbo:\/\/fragment\/chirps\/index&amp;quot;)\nclass ChirpsHomeFragment: WebFragment() {\n    \/\/ ...\n\n    \/\/ Add this:\n    override fun onViewCreated(view: View, savedInstanceState: Bundle?) {\n        super.onViewCreated(view, savedInstanceState)\n\n        setupFab()\n    }\n\n    \/\/ Add this:\n    private fun setupFab() {\n        view?.findViewById&amp;lt;FloatingActionButton&amp;gt;(R.id.createChirpsFab)?.setOnClickListener {\n            navigate(CHIRPS_CREATE_URL)\n        }\n    }\n}\n\n\nNow, let&#039;s click on it and you should be redirected to the create chirps form! How cool is that?!\n\n\n\nIf you try creating a chirp, however, you should see some interesting behavior...\n\n\n\nThat&#039;s not good. That&#039;s because we&#039;re returning Turbo Streams on the ChirpController@store action. Let&#039;s change it so it doesn&#039;t do that when the request was done via a Hotwire Native client. We want the redirect there. Head to the app\/Http\/Controllers\/ChirpController.php file and change the store action like so:\n\n&amp;lt;?php\n\nnamespace App\\Http\\Controllers;\n\nuse App\\Models\\Chirp;\nuse Illuminate\\Http\\Request;\n\nclass ChirpController extends Controller\n{\n    \/\/ ...\n\n    public function store(Request $request)\n    {\n        $validated = $request-&amp;gt;validate([\n            &#039;message&#039; =&amp;gt; [&#039;required&#039;, &#039;string&#039;, &#039;max:255&#039;],\n        ]);\n\n        $chirp = $request-&amp;gt;user()-&amp;gt;chirps()-&amp;gt;create($validated);\n\n        \/\/ Check if the request came from a Hotwire Native client...\n        if ($request-&amp;gt;wantsTurboStream() &amp;amp;&amp;amp; ! $request-&amp;gt;wasFromHotwireNative()) {\n            return turbo_stream([\n                turbo_stream($chirp, &#039;prepend&#039;),\n                turbo_stream()-&amp;gt;update(&#039;create_chirp&#039;, view(&#039;chirps._form&#039;)),\n                turbo_stream()-&amp;gt;append(&#039;notifications&#039;, view(&#039;layouts.notification&#039;, [\n                    &#039;message&#039; =&amp;gt; __(&#039;Chirp created.&#039;),\n                ]))\n            ]);\n        }\n\n        return redirect()\n            -&amp;gt;route(&#039;chirps.index&#039;)\n            -&amp;gt;with(&#039;status&#039;, __(&#039;Chirp created.&#039;));\n    }\n\n    \/\/ ...\n}\n\n\nThis should redirect us to the home page after creating a chirp and the new Chirp should appear there! Cool.\n\nWe have lost the flash message, but we&#039;ll handle that soon. One thing is bothering me: we&#039;re showing the \&quot;Turbo Chirper Native\&quot; title on every screen. I don&#039;t like that. Instead, I want each screen to customize the title. Well, it turns out it already does that based on the title of the page we&#039;re visiting. Let&#039;s change our app.blade.php layout file to accept a $title prop:\n\n&amp;lt;title&amp;gt;@{{ $title ?? config(&#039;app.name&#039;, &#039;Laravel&#039;) }}&amp;lt;\/title&amp;gt;\n\n\nNow, let&#039;s register the prop in the AppLayout component in app\/View\/Components:\n\n&amp;lt;?php\n\nnamespace App\\View\\Components;\n\nuse Illuminate\\View\\Component;\n\nclass AppLayout extends Component\n{\n    public function __construct(public ?string $title = null)\n    {\n    }\n\n    public function render()\n    {\n        return view(&#039;layouts.app&#039;);\n    }\n}\n\n\nThen, in the resources\/views\/chirps\/create.blade.php file, set the :title prop in the &amp;lt;x-app-layout&amp;gt; component:\n\n&amp;lt;!-- Add the title prop: --&amp;gt;\n&amp;lt;x-app-layout :title=&amp;quot;__(&#039;Create Chirp&#039;)&amp;quot;&amp;gt;\n    &amp;lt;!-- ... --&amp;gt;\n&amp;lt;\/x-app-layout&amp;gt;\n\n\nAnd with that, our create chirps page should have the \&quot;Create Chirp\&quot; title:&quot;",
        "url": "https://turbo-laravel.com/bootcamp/native-bridge-component",
      },
          "editing-in-a-modal": {
        "title": "Editing in a Modal",
        "content": "&quot;Right now our editing flow is not very mobile-friendly. Instead of showing the edit form inline in the list, we could show it as a native modal screen instead. But before we introduce the new native screen, let&#039;s first ensure our web dropdown appears as a real native bottom sheet list of options. That will serve as an example of how we can bridge the web and mobile native Worlds with a little bit of JavaScript. This approach was based on how the Hey app works (at least on the pieces I could spot from inspecting the page source).\n\nDropdowns in a BottomSheet modal\n\nLet&#039;s first create our BottomSheet. This one won&#039;t be driven by a navigation, though. We&#039;re going implement a web-\u003Enative bridge that we can trigger when the app is running inside a Hotwire Native client. For now, let&#039;s create a new XML view. Head to the sidebar, under \&quot;res\/layout\&quot;, right-click on it an choose \&quot;New -\u003E Layout Resource File\&quot;. Call it \&quot;popup_menu.xml\&quot; and add this content:\n\n&amp;lt;?xml version=&amp;quot;1.0&amp;quot; encoding=&amp;quot;utf-8&amp;quot;?&amp;gt;\n&amp;lt;androidx.cardview.widget.CardView\n    xmlns:android=&amp;quot;http:\/\/schemas.android.com\/apk\/res\/android&amp;quot;\n    android:layout_width=&amp;quot;match_parent&amp;quot;\n    android:layout_height=&amp;quot;wrap_content&amp;quot;&amp;gt;\n\n    &amp;lt;LinearLayout\n        android:id=&amp;quot;{{&#039;@&#039;}}+id\/popupMenuWrapper&amp;quot;\n        android:layout_width=&amp;quot;match_parent&amp;quot;\n        android:layout_height=&amp;quot;wrap_content&amp;quot;\n        android:layout_margin=&amp;quot;2dp&amp;quot;\n        android:orientation=&amp;quot;vertical&amp;quot;&amp;gt;\n    &amp;lt;\/LinearLayout&amp;gt;\n\n&amp;lt;\/androidx.cardview.widget.CardView&amp;gt;\n\n\nThis will be programatically added, so what&#039;s really important here is the android:id property. Since we&#039;re going to trigger this native feature from the web, the Hotwire Native for Android documentation says that the best location is in the TurboSessionNavHostFragment::onSessionCreated function. Let&#039;s then tweak our MainSessionNavHostFragment with the following change:\n\npackage com.example.turbochirpernative.main\n\nimport android.webkit.JavascriptInterface \/\/ Add this\nimport android.webkit.WebView\nimport android.widget.Button \/\/ Add this\nimport android.widget.LinearLayout\nimport android.widget.Toast \/\/ Add this\nimport androidx.appcompat.app.AppCompatActivity\nimport androidx.compose.ui.res.integerResource\nimport androidx.fragment.app.Fragment\nimport com.example.turbochirpernative.BuildConfig\nimport com.example.turbochirpernative.R \/\/ Add this\nimport com.example.turbochirpernative.features.auth.LoginFragment\nimport com.example.turbochirpernative.features.web.ChirpsHomeFragment\nimport com.example.turbochirpernative.features.web.WebFragment\nimport com.example.turbochirpernative.util.CHIRPS_HOME_URL\nimport com.google.android.material.bottomsheet.BottomSheetDialog \/\/ Add this\nimport com.google.gson.Gson \/\/ Add this\nimport dev.hotwire.turbo.config.TurboPathConfiguration\nimport dev.hotwire.turbo.session.TurboSessionNavHostFragment\nimport kotlin.reflect.KClass\n\nclass MainSessionNavHostFragment : TurboSessionNavHostFragment(), PopupMenuDelegator {\n    \/\/ ...\n\n    override fun onSessionCreated() {\n        super.onSessionCreated()\n        session.webView.settings.userAgentString = customUserAgent(session.webView)\n\n        if (BuildConfig.DEBUG) {\n            session.setDebugLoggingEnabled(true)\n            WebView.setWebContentsDebuggingEnabled(true)\n        }\n\n        \/\/ Add this:\n        session.webView.addJavascriptInterface(\n            JsBridge(this),\n            &amp;quot;NativeBridge&amp;quot;,\n        )\n    }\n\n    private fun customUserAgent(webView: WebView): String {\n        return &amp;quot;Hotwire Native Android ${webView.settings.userAgentString}&amp;quot;\n    }\n\n    override fun showPopupMenu(options: PopupMenu) {\n        activity?.runOnUiThread {\n            val context = requireContext()\n\n            val dialog = BottomSheetDialog(context)\n\n            val view = layoutInflater.inflate(R.layout.popup_menu, null)!!\n\n            val menuWrapper = view.findViewById&amp;lt;LinearLayout&amp;gt;(R.id.popupMenuWrapper)!!\n\n            menuWrapper.removeAllViews()\n\n            options.items.forEach { item -&amp;gt;\n                val button = Button(context)\n\n                button.text = item.text\n                button.setBackgroundColor(resources.getColor(R.color.white, null))\n\n                button.setOnClickListener {\n                    session.webView.evaluateJavascript(\n                        &amp;quot;window.dispatchEvent(new CustomEvent(&#039;popup-menu:selected&#039;, { detail: { index: &amp;quot; + item.index + &amp;quot;, text: &#039;&amp;quot; + item.text + &amp;quot;&#039; } }))&amp;quot;,\n                        null\n                    )\n\n                    dialog.dismiss()\n                }\n\n                menuWrapper.addView(button)\n            }\n\n            dialog.setOnCancelListener {\n                session.webView.evaluateJavascript(&amp;quot;window.dispatchEvent(new CustomEvent(&#039;popup-menu:canceled&#039;))&amp;quot;, null)\n            }\n\n            dialog.setCancelable(true)\n\n            dialog.setContentView(view)\n\n            dialog.show()\n        }\n    }\n\n    override fun showToast(msg: String) {\n        activity?.runOnUiThread {\n            Toast\n                .makeText(requireContext(), msg, Toast.LENGTH_SHORT)\n                .show()\n        }\n    }\n}\n\ndata class MenuItem(\n    val text: String,\n    val index: Int,\n)\n\ndata class PopupMenu(\n    val items: List&amp;lt;MenuItem&amp;gt;,\n)\n\ninterface PopupMenuDelegator {\n    fun showPopupMenu(options: PopupMenu);\n    fun showToast(msg: String);\n}\n\nclass JsBridge(private var delegator: PopupMenuDelegator) {\n    {{&#039;@&#039;}}JavascriptInterface\n    override fun toString(): String {\n        return &amp;quot;NativeBridge&amp;quot;\n    }\n\n    {{&#039;@&#039;}}JavascriptInterface\n    fun showPopup(json: String) {\n        val gson = Gson()\n\n        val options = gson.fromJson(json, PopupMenu::class.java)\n\n        delegator.showPopupMenu(options)\n    }\n\n    {{&#039;@&#039;}}JavascriptInterface\n    fun showToast(msg: String) {\n        delegator.showToast(msg)\n    }\n}\n\n\nNow we have the BottomSheet Menu ready to be triggered by our webapp.\n\nTelling the Native App to Show The Options\n\nWe&#039;re gonna create a Stimulus controller that will act when a user triggers the dropdown inside a Hotwire Native client. We&#039;re also gonna use the custom User Agent to detect we&#039;re on that platform. Whenever that is the case, we&#039;ll get some metadata from the HTML and pass that to the Native app so it can build the native menu. When the user either picks one of the options or dismisses the menu, we&#039;re gonna notify the web app about it.\n\nLet&#039;s then add the Stimulus controller. Open a terminal at the root of the webapp and run:\n\nphp artisan stimulus:make bridge\/popup_menu_controller\n\n\nThat should take care of creating and registering the controller for us. Open that Stimulus controller and place the following content:\n\nimport { Controller } from &amp;quot;{{&#039;@&#039;}}hotwired\/stimulus&amp;quot;\nimport { isMobileApp } from &amp;quot;..\/..\/helpers\/platform&amp;quot;\nimport { BridgeElement } from &amp;quot;..\/..\/helpers\/bridge_element&amp;quot;\n\n\/\/ Connects to data-controller=&amp;quot;bridge--popup-menu&amp;quot;\nexport default class extends Controller {\n    static targets = [&#039;option&#039;]\n\n    connect() {\n        this.clearCallbacks()\n    }\n\n    update(event) {\n        if (! this.enabled) return\n\n        event.stopImmediatePropagation()\n        event.preventDefault()\n\n        this.notifyBridgeToDisplayMenu(event)\n    }\n\n    notifyBridgeToDisplayMenu(event) {\n        const items = BridgeElement.makeMenuItems(this.optionTargets)\n\n        this.send(items, item =&amp;gt; {\n            new BridgeElement(this.optionTargets[item.index]).click()\n        })\n    }\n\n    send(items, callback) {\n        this.registeredCallbacks.push(callback)\n        window.NativeBridge.showPopup(JSON.stringify({ items }))\n    }\n\n    handle(event) {\n        let handler = this.registeredCallbacks.pop()\n\n        if (! handler) return\n\n        handler.call(this, event.detail)\n    }\n\n    clearCallbacks() {\n        this.registeredCallbacks = []\n    }\n\n    get enabled() {\n        return isMobileApp\n    }\n}\n\n\nSo, we&#039;re detecting if we&#039;re on a Hotwire Native client using the isMobileApp platform check (that same one we&#039;re using to add the turbo-native CSS class to the HTML document). The update method will be triggered by the dropdown trigger (same one that opens it), but we need to register it before the normal web trigger because we want to stop it from showing the dropdown and, instead, show the native menu. When the dropdown opens, we&#039;ll scan through all the option targets and fetch metadata from it, then register a callback in the controller&#039;s instance. When the user picks one of the options, the native client will dispatch a custom event to the window, so all instances of dropdown controllers will receive that event, but only the one with the callback will act on it. Then, it should trigger the default behavior of that option (link or button click).\n\nWhen the controller scans the option targets, it builds an instance of a BridgeElement class, which we don&#039;t have yet. Let&#039;s add one at resources\/js\/helpers\/bridge_element.js:\n\nimport { isAndroidApp, isMobileApp } from &amp;quot;.\/platform&amp;quot;\n\nexport class BridgeElement {\n    static makeMenuItems(elements){\n        return elements.map((element, index) =&amp;gt; {\n            return new BridgeElement(element).asMenuItem(index)\n        }).filter(item =&amp;gt; item)\n    }\n\n    constructor(element) {\n        this.element = element\n    }\n\n    asMenuItem(index) {\n        if (this.disabled) return\n\n        return {\n            text: this.text,\n            index: index,\n        }\n    }\n\n    click() {\n        this.ensureFrameOrFormTargetsTop()\n\n        \/\/ Remove the target attribute before clicking to avoid an\n        \/\/ issue in Android WebView that prevents a target=&amp;quot;_blank&amp;quot;\n        \/\/ URL from being obtained from a JavaScript click.\n\n        if (isAndroidApp) {\n            this.element.removeAttribute(&amp;quot;target&amp;quot;)\n        }\n\n        this.element.click()\n    }\n\n    ensureFrameOrFormTargetsTop() {\n        this.ensureFrameTargetsTop()\n        this.ensureFormTargetsTop()\n    }\n\n    ensureFrameTargetsTop() {\n        let frame = this.element.closest(&#039;turbo-frame&#039;)\n\n        if (! frame) return\n\n        frame.setAttribute(&#039;target&#039;, &#039;_top&#039;)\n    }\n\n    ensureFormTargetsTop() {\n        let form = this.element.closest(&#039;form&#039;)\n\n        if (! form) return\n\n        form.setAttribute(&#039;data-turbo-frame&#039;, &#039;_top&#039;)\n    }\n\n    get text() {\n        return this.element.textContent.trim()\n    }\n\n    get disabled() {\n        return ! this.enabled\n    }\n\n    get enabled() {\n        return isMobileApp\n    }\n}\n\n\nNext, let&#039;s update the our dropdown blade component to use this Stimulus controller we just created:\n\n{{&#039;@&#039;}}props([&#039;align&#039; =&amp;gt; &#039;right&#039;, &#039;width&#039; =&amp;gt; &#039;48&#039;, &#039;contentClasses&#039; =&amp;gt; &#039;py-1 bg-white&#039;])\n\n{{&#039;@&#039;}}php\nswitch ($align) {\n    case &#039;left&#039;:\n        $alignmentClasses = &#039;origin-top-left left-0&#039;;\n        break;\n    case &#039;top&#039;:\n        $alignmentClasses = &#039;origin-top&#039;;\n        break;\n    case &#039;right&#039;:\n    default:\n        $alignmentClasses = &#039;origin-top-right right-0&#039;;\n        break;\n}\n\nswitch ($width) {\n    case &#039;48&#039;:\n        $width = &#039;w-48&#039;;\n        break;\n}\n{{&#039;@&#039;}}endphp\n\n&amp;lt;!-- Update the data-controller attribute: --&amp;gt;\n\n&amp;lt;div\n    class=&amp;quot;relative&amp;quot;\n    data-controller=&amp;quot;bridge--popup-menu dropdown&amp;quot;\n    data-action=&amp;quot;\n        click{{&#039;@&#039;}}window-&amp;gt;dropdown#close\n        turbo:load{{&#039;@&#039;}}window-&amp;gt;dropdown#close\n        popup-menu:canceled{{&#039;@&#039;}}window-&amp;gt;bridge--popup-menu#clearCallbacks\n        popup-menu:selected{{&#039;@&#039;}}window-&amp;gt;bridge--popup-menu#handle\n    &amp;quot;\n    @{{ $attributes }}\n&amp;gt;\n    &amp;lt;!-- Update the data-action attribute: --&amp;gt;\n    &amp;lt;div data-action=&amp;quot;click-&amp;gt;bridge--popup-menu#update click-&amp;gt;dropdown#toggle click-&amp;gt;dropdown#stop&amp;quot;&amp;gt;\n        @{{ $trigger }}\n    &amp;lt;\/div&amp;gt;\n\n    &amp;lt;div\n        data-dropdown-target=&amp;quot;content&amp;quot;\n        data-transition-enter=&amp;quot;transition ease-out duration-200&amp;quot;\n        data-transition-enter-start=&amp;quot;transform opacity-0 scale-95&amp;quot;\n        data-transition-enter-end=&amp;quot;transform opacity-100 scale-100&amp;quot;\n        data-transition-leave=&amp;quot;transition ease-in duration-75&amp;quot;\n        data-transition-leave-start=&amp;quot;transform opacity-100 scale-100&amp;quot;\n        data-transition-leave-end=&amp;quot;transform opacity-0 scale-95&amp;quot;\n        class=&amp;quot;hidden absolute z-50 mt-2 @{{ $width }} rounded-md shadow-lg @{{ $alignmentClasses }}&amp;quot;\n    &amp;gt;\n        &amp;lt;div class=&amp;quot;rounded-md ring-1 ring-black ring-opacity-5 @{{ $contentClasses }}&amp;quot;&amp;gt;\n            @{{ $content }}\n        &amp;lt;\/div&amp;gt;\n    &amp;lt;\/div&amp;gt;\n&amp;lt;\/div&amp;gt;\n\n\nNow, we need to make sure the options are registered in the Stimulus controller where this Blade component is used. Let&#039;s update our _chirp blade partial:\n\n&amp;lt;x-turbo::frame :id=&amp;quot;$chirp&amp;quot; class=&amp;quot;block p-6&amp;quot;&amp;gt;\n    &amp;lt;div class=&amp;quot;flex space-x-2&amp;quot;&amp;gt;\n        &amp;lt;!-- ... --&amp;gt;\n\n        &amp;lt;div class=&amp;quot;flex-1&amp;quot;&amp;gt;\n            &amp;lt;div class=&amp;quot;flex justify-between items-center&amp;quot;&amp;gt;\n                &amp;lt;!-- ... --&amp;gt;\n\n                {{&#039;@&#039;}}if (Auth::id() === $chirp-&amp;gt;user-&amp;gt;id)\n                &amp;lt;x-dropdown align=&amp;quot;right&amp;quot; width=&amp;quot;48&amp;quot; data-bridge--popup-menu-msg-value=&amp;quot;@{{ $chirp-&amp;gt;message }}&amp;quot;&amp;gt;\n                    &amp;lt;!-- ... --&amp;gt;\n\n                    &amp;lt;x-slot name=&amp;quot;content&amp;quot;&amp;gt;\n                        &amp;lt;!-- Update the link: --&amp;gt;\n                        &amp;lt;a href=&amp;quot;@{{ route(&#039;chirps.edit&#039;, $chirp) }}&amp;quot; data-bridge--popup-menu-target=&amp;quot;option&amp;quot; class=&amp;quot;block w-full px-4 py-2 text-left text-sm leading-5 text-gray-700 hover:bg-gray-100 focus:bg-gray-100 transition duration-150 ease-in-out&amp;quot;&amp;gt;\n                            Edit\n                        &amp;lt;\/a&amp;gt;\n\n                        &amp;lt;form action=&amp;quot;@{{ route(&#039;chirps.destroy&#039;, $chirp) }}&amp;quot; method=&amp;quot;POST&amp;quot;&amp;gt;\n                            {{&#039;@&#039;}}method(&#039;DELETE&#039;)\n                            &amp;lt;!-- Update the button: --&amp;gt;\n                            &amp;lt;button data-bridge--popup-menu-target=&amp;quot;option&amp;quot; class=&amp;quot;block w-full px-4 py-2 text-left text-sm leading-5 text-gray-700 hover:bg-gray-100 focus:bg-gray-100 transition duration-150 ease-in-out&amp;quot;&amp;gt;\n                                Delete\n                            &amp;lt;\/button&amp;gt;\n                        &amp;lt;\/form&amp;gt;\n                    &amp;lt;\/x-slot&amp;gt;\n                &amp;lt;\/x-dropdown&amp;gt;\n                {{&#039;@&#039;}}endif\n            &amp;lt;\/div&amp;gt;\n\n            &amp;lt;p class=&amp;quot;mt-4 text-lg text-gray-900&amp;quot;&amp;gt;@{{ $chirp-&amp;gt;message }}&amp;lt;\/p&amp;gt;\n        &amp;lt;\/div&amp;gt;\n    &amp;lt;\/div&amp;gt;\n&amp;lt;\/x-turbo::frame&amp;gt;\n\n\nThis should get our dropdown appearing as a BottomSheet menu!\n\n\n\nOur Bridge Popup Menu controller also changes the frame target to _top, which is handy in our case as that will make a full page visit to the edit page instead of rendering the form inline!\n\nIf you try to update a chirp, however, the behavior will be similar to what it was previously on the create chirp flow. Let&#039;s fix it by letting the controller redirect to the list index of chirps instead of returning Turbo Streams. Since we&#039;re tinkering with the controller, let&#039;s also update the destroy flow so it also redirects there:\n\n&amp;lt;?php\n\nnamespace App\\Http\\Controllers;\n\nuse App\\Models\\Chirp;\nuse Illuminate\\Http\\Request;\n\nclass ChirpController extends Controller\n{\n    \/\/ ...\n\n    public function update(Request $request, Chirp $chirp)\n    {\n        $this-&amp;gt;authorize(&#039;update&#039;, $chirp);\n\n        $validated = $request-&amp;gt;validate([\n            &#039;message&#039; =&amp;gt; [&#039;required&#039;, &#039;string&#039;, &#039;max:255&#039;],\n        ]);\n\n        $chirp-&amp;gt;update($validated);\n\n        \/\/ Check if the request was from a Hotwire Native client:\n        if ($request-&amp;gt;wantsTurboStream() &amp;amp;&amp;amp; ! $request-&amp;gt;wasFromHotwireNative()) {\n            return turbo_stream([\n                turbo_stream($chirp),\n                turbo_stream()-&amp;gt;append(&#039;notifications&#039;, view(&#039;layouts.notification&#039;, [\n                    &#039;message&#039; =&amp;gt; __(&#039;Chirp updated.&#039;),\n                ])),\n            ]);\n        }\n\n        return redirect()\n            -&amp;gt;route(&#039;chirps.index&#039;)\n            -&amp;gt;with(&#039;status&#039;, __(&#039;Chirp updated.&#039;));\n    }\n\n    \/\/ ...\n\n    public function destroy(Request $request, Chirp $chirp)\n    {\n        $this-&amp;gt;authorize(&#039;delete&#039;, $chirp);\n\n        $chirp-&amp;gt;delete();\n\n        \/\/ Check if the request was from a Hotwire Native client:\n        if ($request-&amp;gt;wantsTurboStream() &amp;amp;&amp;amp; ! $request-&amp;gt;wasFromHotwireNative()) {\n            return turbo_stream([\n                turbo_stream($chirp),\n                turbo_stream()-&amp;gt;append(&#039;notifications&#039;, view(&#039;layouts.notification&#039;, [\n                    &#039;message&#039; =&amp;gt; __(&#039;Chirp deleted.&#039;),\n                ])),\n            ]);\n        }\n\n        return redirect()\n            -&amp;gt;route(&#039;chirps.index&#039;)\n            -&amp;gt;with(&#039;status&#039;, __(&#039;Chirp deleted.&#039;));\n    }\n}\n\n\nThat should have our edit and delete flows working properly, which is cool!\n\nUsing a Native Modal Screen for Forms\n\nInstead of showing the edit form in a new screen, I think it would be cool to introduce a native modal screen that other pages could use as well. First, add a new Fragment called WebModalFragment under the web package in the Android project without a layout:\n\npackage com.example.turbochirpernative.features.web\n\nimport android.os.Bundle\nimport android.view.View\nimport com.example.turbochirpernative.util.displayBackButtonAsCloseIcon\nimport dev.hotwire.turbo.nav.TurboNavGraphDestination\n\n{{&#039;@&#039;}}TurboNavGraphDestination(uri = &amp;quot;turbo:\/\/fragment\/web\/modal&amp;quot;)\nclass WebModalFragment : WebFragment() {\n    override fun onViewCreated(view: View, savedInstanceState: Bundle?) {\n        super.onViewCreated(view, savedInstanceState)\n        initToolbar()\n    }\n\n    private fun initToolbar() {\n        toolbarForNavigation()?.displayBackButtonAsCloseIcon()\n    }\n}\n\n\nWe need to create a new Extensions.kt file inside the util package so we can add this displayBackButtonAsCloseIcon method to the Toolbar:\n\npackage com.example.turbochirpernative.util\n\nimport androidx.appcompat.widget.Toolbar\nimport androidx.core.content.ContextCompat\nimport com.example.turbochirpernative.R\n\nfun Toolbar.displayBackButtonAsCloseIcon() {\n    navigationIcon = ContextCompat.getDrawable(context, R.drawable.ic_close)\n}\n\n\nNext, add a new Vector to the drawables by right-clicking on \&quot;New -\u003E Vector Asset\&quot; inside the \&quot;res\/drawables\&quot; folder, name it ic_close and choose the close icon.\n\nThen, let&#039;s register the WebModalFragment in our MainSessionNavHostFragment:\n\npackage com.example.turbochirpernative.main\n\n\/\/ ...\nimport com.example.turbochirpernative.features.web.WebModalFragment \/\/ Add this\n\nclass MainSessionNavHostFragment : TurboSessionNavHostFragment(), PopupMenuDelegator {\n    \/\/ ...\n\n    override val registeredFragments: List&amp;lt;KClass&amp;lt;out Fragment&amp;gt;&amp;gt;\n        get() = listOf(\n            WebFragment::class,\n            WebModalFragment::class, \/\/ Add this\n            LoginFragment::class,\n            ChirpsHomeFragment::class,\n        )\n\n    \/\/ ...\n}\n\n\/\/ ...\n\n\nWe need to add a new entry to our configuration so any URI ending with \/edit or \/create (our forms), will open inside of a web modal fragment instead of the default web fragment:\n\n{\n  &amp;quot;settings&amp;quot;: {\n    &amp;quot;screenshots_enabled&amp;quot;: true\n  },\n  &amp;quot;rules&amp;quot;: [\n    {\n      &amp;quot;patterns&amp;quot;: [\n        &amp;quot;.*&amp;quot;\n      ],\n      &amp;quot;properties&amp;quot;: {\n        &amp;quot;context&amp;quot;: &amp;quot;default&amp;quot;,\n        &amp;quot;uri&amp;quot;: &amp;quot;turbo:\/\/fragment\/web&amp;quot;,\n        &amp;quot;pull_to_refresh_enabled&amp;quot;: true\n      }\n    },\n    {\n      &amp;quot;patterns&amp;quot;: [\n        &amp;quot;\/edit$&amp;quot;,\n        &amp;quot;\/edit\/$&amp;quot;,\n        &amp;quot;\/create$&amp;quot;,\n        &amp;quot;\/create\/$&amp;quot;\n      ],\n      &amp;quot;properties&amp;quot;: {\n        &amp;quot;context&amp;quot;: &amp;quot;default&amp;quot;,\n        &amp;quot;uri&amp;quot;: &amp;quot;turbo:\/\/fragment\/web\/modal&amp;quot;,\n        &amp;quot;pull_to_refresh_enabled&amp;quot;: false\n      }\n    },\n    {\n      &amp;quot;patterns&amp;quot;: [\n        &amp;quot;login$&amp;quot;,\n        &amp;quot;login\/$&amp;quot;\n      ],\n      &amp;quot;properties&amp;quot;: {\n        &amp;quot;context&amp;quot;: &amp;quot;default&amp;quot;,\n        &amp;quot;uri&amp;quot;: &amp;quot;turbo:\/\/fragment\/auth\/login&amp;quot;,\n        &amp;quot;pull_to_refresh_enabled&amp;quot;: false\n      }\n    },\n    {\n      &amp;quot;patterns&amp;quot;: [\n        &amp;quot;chirps$&amp;quot;,\n        &amp;quot;chirps\/$&amp;quot;\n      ],\n      &amp;quot;properties&amp;quot;: {\n        &amp;quot;context&amp;quot;: &amp;quot;default&amp;quot;,\n        &amp;quot;uri&amp;quot;: &amp;quot;turbo:\/\/fragment\/chirps\/index&amp;quot;,\n        &amp;quot;pull_to_refresh_enabled&amp;quot;: true\n      }\n    }\n  ]\n}\n\n\nLet&#039;s also hide the cancel button when inside a Hotwire Native client by updating our resources\/chirps\/_form.blade.php in our web app:\n\n&amp;lt;form action=&amp;quot;@{{ ($chirp ?? false) ? route(&#039;chirps.update&#039;, $chirp) : route(&#039;chirps.store&#039;) }}&amp;quot; method=&amp;quot;POST&amp;quot;&amp;gt;\n    &amp;lt;!-- ... --&amp;gt;\n\n    &amp;lt;div class=&amp;quot;flex items-center justify-start space-x-2&amp;quot;&amp;gt;\n        &amp;lt;x-primary-button class=&amp;quot;mt-4&amp;quot;&amp;gt;\n            @{{ __(&#039;Chirp&#039;) }}\n        &amp;lt;\/x-primary-button&amp;gt;\n\n        {{&#039;@&#039;}}if ($chirp ?? false)\n        &amp;lt;!-- Update the link: --&amp;gt;\n        &amp;lt;a href=&amp;quot;@{{ route(&#039;chirps.index&#039;) }}&amp;quot; class=&amp;quot;mt-4 turbo-native:hidden&amp;quot;&amp;gt;Cancel&amp;lt;\/a&amp;gt;\n        {{&#039;@&#039;}}endif\n    &amp;lt;\/div&amp;gt;\n&amp;lt;\/form&amp;gt;\n\n\nTesting It Out\n\nNow, our app should be a bit nicer:&quot;",
        "url": "https://turbo-laravel.com/bootcamp/native-editing-modal",
      },
          "native-confirmation-dialog": {
        "title": "Native Confirmation Dialog",
        "content": "&quot;Right now we&#039;re not showing a confirmation when the user presses the delete button. Let&#039;s fix that.\n\nJS Confirm\n\nTurbo offers a data-turbo-confirm attribute we can use in forms and links. By default, that uses the JS confirm feature. Let&#039;s start with that.\n\nFirst, let&#039;s update our chirps\/partials\/chirp.blade.php file and add the data-turbo-confirm to the delete form:\n\n&amp;lt;x-turbo::frame :id=&amp;quot;$chirp&amp;quot; class=&amp;quot;block p-6&amp;quot;&amp;gt;\n    &amp;lt;div class=&amp;quot;flex space-x-2&amp;quot;&amp;gt;\n        &amp;lt;!-- ... --&amp;gt;\n\n        &amp;lt;div class=&amp;quot;flex-1&amp;quot;&amp;gt;\n            &amp;lt;div class=&amp;quot;flex justify-between items-center&amp;quot;&amp;gt;\n                &amp;lt;!-- ... --&amp;gt;\n\n                {{&#039;@&#039;}}if (Auth::id() === $chirp-&amp;gt;user-&amp;gt;id)\n                &amp;lt;x-dropdown align=&amp;quot;right&amp;quot; width=&amp;quot;48&amp;quot; data-bridge--popup-menu-msg-value=&amp;quot;@{{ $chirp-&amp;gt;message }}&amp;quot;&amp;gt;\n                    &amp;lt;!-- ... --&amp;gt;\n\n                    &amp;lt;x-slot name=&amp;quot;content&amp;quot;&amp;gt;\n                        &amp;lt;a href=&amp;quot;@{{ route(&#039;chirps.edit&#039;, $chirp) }}&amp;quot; data-bridge--popup-menu-target=&amp;quot;option&amp;quot; class=&amp;quot;block w-full px-4 py-2 text-left text-sm leading-5 text-gray-700 hover:bg-gray-100 focus:bg-gray-100 transition duration-150 ease-in-out&amp;quot;&amp;gt;\n                            Edit\n                        &amp;lt;\/a&amp;gt;\n\n                        &amp;lt;!-- Update form: --&amp;gt;\n                        &amp;lt;form action=&amp;quot;@{{ route(&#039;chirps.destroy&#039;, $chirp) }}&amp;quot; method=&amp;quot;POST&amp;quot; data-turbo-confirm=&amp;quot;@{{ __(&#039;Are you sure you want to delete this chirp?&#039;) }}&amp;quot;&amp;gt;\n                            {{&#039;@&#039;}}method(&#039;DELETE&#039;)\n                            &amp;lt;button data-bridge--popup-menu-target=&amp;quot;option&amp;quot; class=&amp;quot;block w-full px-4 py-2 text-left text-sm leading-5 text-gray-700 hover:bg-gray-100 focus:bg-gray-100 transition duration-150 ease-in-out&amp;quot;&amp;gt;\n                                Delete\n                            &amp;lt;\/button&amp;gt;\n                        &amp;lt;\/form&amp;gt;\n                    &amp;lt;\/x-slot&amp;gt;\n                &amp;lt;\/x-dropdown&amp;gt;\n                {{&#039;@&#039;}}endif\n            &amp;lt;\/div&amp;gt;\n\n            &amp;lt;p class=&amp;quot;mt-4 text-lg text-gray-900&amp;quot;&amp;gt;@{{ $chirp-&amp;gt;message }}&amp;lt;\/p&amp;gt;\n        &amp;lt;\/div&amp;gt;\n    &amp;lt;\/div&amp;gt;\n&amp;lt;\/x-turbo::frame&amp;gt;\n\n\nThat should get the JS confirm appearing both in the webapp and native.\n\n\n\n\n\nThat&#039;s nice, but we can do a lot better. Let&#039;s start with the web version. Turbo allows us to override the default implementation of its confirm feature. Let&#039;s implement it using our own modal.\n\nFirst, we&#039;re gonna create a global modal that will be used for this kind of confirmation. In the resources\/views\/layouts\/app.blade.php, update it to include the modal:\n\n&amp;lt;!DOCTYPE html&amp;gt;\n&amp;lt;html lang=&amp;quot;@{{ str_replace(&#039;_&#039;, &#039;-&#039;, app()-&amp;gt;getLocale()) }}&amp;quot;&amp;gt;\n    &amp;lt;head&amp;gt;\n    &amp;lt;\/head&amp;gt;\n    &amp;lt;body class=&amp;quot;font-sans antialiased&amp;quot;&amp;gt;\n        &amp;lt;!-- ... --&amp;gt;\n\n        {{&#039;@&#039;}}include(&#039;layouts.confirmation_modal&#039;) &amp;lt;!-- Add this --&amp;gt;\n    &amp;lt;\/body&amp;gt;\n&amp;lt;\/html&amp;gt;\n\n\nNext, let&#039;s create the resources\/views\/lauouts\/confirmation_modal.blade.php file with the following contents:\n\n&amp;lt;dialog id=&amp;quot;confirmation_modal&amp;quot; class=&amp;quot;p-0&amp;quot;&amp;gt;\n    &amp;lt;form method=&amp;quot;dialog&amp;quot;&amp;gt;\n        &amp;lt;div class=&amp;quot;bg-white px-4 pt-5 pb-4 sm:p-6 sm:pb-4&amp;quot;&amp;gt;\n            &amp;lt;div class=&amp;quot;sm:flex sm:items-start&amp;quot;&amp;gt;\n                &amp;lt;div class=&amp;quot;mx-auto shrink-0 flex items-center justify-center h-12 w-12 rounded-full bg-red-100 sm:mx-0 sm:h-10 sm:w-10&amp;quot;&amp;gt;\n                    &amp;lt;svg class=&amp;quot;h-6 w-6 text-red-600&amp;quot; stroke=&amp;quot;currentColor&amp;quot; fill=&amp;quot;none&amp;quot; viewBox=&amp;quot;0 0 24 24&amp;quot;&amp;gt;\n                        &amp;lt;path stroke-linecap=&amp;quot;round&amp;quot; stroke-linejoin=&amp;quot;round&amp;quot; stroke-width=&amp;quot;2&amp;quot; d=&amp;quot;M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z&amp;quot;\/&amp;gt;\n                    &amp;lt;\/svg&amp;gt;\n                &amp;lt;\/div&amp;gt;\n\n                &amp;lt;div class=&amp;quot;mt-3 text-center sm:mt-0 sm:ml-4 sm:text-left&amp;quot;&amp;gt;\n                    &amp;lt;h3 class=&amp;quot;text-lg&amp;quot; id=&amp;quot;confirmation_title&amp;quot;&amp;gt;\n                        @{{ __(&#039;Confirmation&#039;) }}\n                    &amp;lt;\/h3&amp;gt;\n\n                    &amp;lt;div class=&amp;quot;mt-2&amp;quot; id=&amp;quot;confirmation_message&amp;quot;&amp;gt;\n                        @{{ __(&#039;Are you sure?&#039;) }}\n                    &amp;lt;\/div&amp;gt;\n                &amp;lt;\/div&amp;gt;\n            &amp;lt;\/div&amp;gt;\n        &amp;lt;\/div&amp;gt;\n\n        &amp;lt;div class=&amp;quot;flex flex-row space-x-2 justify-end px-6 py-4 bg-gray-100 text-right&amp;quot;&amp;gt;\n            &amp;lt;button id=&amp;quot;confirmation_negative_btn&amp;quot; type=&amp;quot;submit&amp;quot; value=&amp;quot;canceled&amp;quot; class=&amp;quot;inline-flex items-center px-4 py-2 bg-white border border-gray-300 rounded-md font-semibold text-xs text-gray-700 uppercase tracking-widest shadow-sm hover:text-gray-500 focus:outline-none focus:border-blue-300 focus:ring focus:ring-blue-200 active:text-gray-800 active:bg-gray-50 disabled:opacity-25 transition&amp;quot;&amp;gt;\n                @{{ __(&#039;Cancel&#039;) }}\n            &amp;lt;\/button&amp;gt;\n\n            &amp;lt;button id=&amp;quot;confirmation_positive_btn&amp;quot; type=&amp;quot;submit&amp;quot; value=&amp;quot;confirmed&amp;quot; class=&amp;quot;inline-flex items-center justify-center px-4 py-2 bg-red-600 border border-transparent rounded-md font-semibold text-xs text-white uppercase tracking-widest hover:bg-red-500 focus:outline-none focus:border-red-700 focus:ring focus:ring-red-200 active:bg-red-600 disabled:opacity-25 transition&amp;quot;&amp;gt;\n                @{{ __(&#039;Confirm&#039;) }}\n            &amp;lt;\/button&amp;gt;\n        &amp;lt;\/div&amp;gt;\n    &amp;lt;\/form&amp;gt;\n&amp;lt;\/dialog&amp;gt;\n\n\nNow, let&#039;s override the default behavior to show this new modal instead of using the default JS confirm. In the resources\/js\/libs\/turbo.js, let&#039;s use the Turbo.setConfirmMethod(), it accepts a function that returns a Promise.\n\nimport * as Turbo from &#039;{{&#039;@&#039;}}hotwired\/turbo&#039;;\nimport { Confirmation } from &#039;..\/helpers&#039;;\n\nTurbo.setConfirmMethod(Confirmation);\n\nexport default Turbo;\n\n\nNow, let&#039;s create our Confirmation function. Create a resources\/js\/libs\/helpers\/confirmation.js file with the function defined:\n\nimport { WebConfirmation } from &#039;.\/web_confirmation&#039;;\n\nexport function Confirmation (message) {\n    return new WebConfirmation().confirm(message);\n};\n\n\nTurbo will pass the message we set in the data-turbo-confirm as the first parameter and the HTML element as the second parameter. We could use it to set additional params as data-* attributes in the form itself if we wanted to, like the icon or title shown in the modal, for instance. We&#039;re not gonna use that here, so we only need the message. We&#039;re going to delegate the manipulation of the modal to a WebConfirmation class, we only need to call its confirm method passing down the message. Let&#039;s create the resources\/js\/libs\/helpers\/web_confirmation.js:\n\nexport class WebConfirmation\n{\n    confirm(message) {\n        return new Promise((resolve) =&amp;gt; {\n            let dialog = document.querySelector(&#039;#confirmation_modal&#039;)\n\n            dialog.querySelector(&#039;#confirmation_message&#039;).textContent = message;\n\n            dialog.addEventListener(&#039;close&#039;, () =&amp;gt; {\n                resolve(dialog.returnValue === &#039;confirmed&#039;);\n            }, { once: true });\n\n            dialog.showModal();\n        });\n    }\n}\n\n\nWe&#039;re querying the dialog from the DOM, setting the contents of the #confirmation_message element as the message, then we&#039;re registering an event listener for the close event, then we&#039;re calling the dialog.showModal() method. As for the Promise, Turbo only expects that we pass true or false to the resolve function to indicate if it was confirmed or not. Let&#039;s see that in action:\n\n\n\n\n\nThis is not so good for the native version, but the web one is nice. Let&#039;s fix that.\n\nNative Confirmation\n\nFor the Native confirmation, we&#039;re gonna need to extend our Kotlin JSBridge a little bit. Whenever a confirmation is triggered by the webapp, and we&#039;re in a Hotwire Native client, we&#039;re gonna register a listener for the Native confirmation result, then send a message to the bridge and ask it to show a native AlertDialog. When the user chooses an option, we&#039;re going to send the result back to the web app via a custom event.\n\nLet&#039;s start with the web side, since it&#039;s simpler. Change the resources\/js\/helpers\/confirmation.js file to look like the following:\n\nimport { BridgeConfirmation } from &#039;.\/bridge_confirmation&#039;; \/\/ Add this\nimport { WebConfirmation } from &#039;.\/web_confirmation&#039;;\nimport { isMobileApp } from &#039;.\/platform&#039;; \/\/ Add this\n\nexport function Confirmation (message) {\n    \/\/ Add this:\n    if (isMobileApp) {\n        return new BridgeConfirmation().confirm(message);\n    }\n\n    return new WebConfirmation().confirm(message);\n};\n\n\nNow, let&#039;s create our resources\/js\/helpers\/bridge_confirmation.js file:\n\nexport class BridgeConfirmation\n{\n    confirm(message) {\n        return new Promise((resolve) =&amp;gt; {\n            window.addEventListener(&#039;confirmation:handle&#039;, ({ detail }) =&amp;gt; {\n                resolve(detail === &amp;quot;confirmed&amp;quot;);\n            }, { once: true });\n\n            window.NativeBridge.showConfirmationModal(message);\n        });\n    }\n}\n\n\nIt&#039;s really simple, right? Registering the event listener and sending a showConfirmationModal message to the bridge.\n\nNow, let&#039;s update the MainSessionNavHostFragment.kt in the native side to accept that message:\n\npackage com.example.turbochirpernative.main\n\n\/\/ ...\nimport android.content.DialogInterface\nimport androidx.appcompat.app.AlertDialog\n\nclass MainSessionNavHostFragment : TurboSessionNavHostFragment(), PopupMenuDelegator {\n    \/\/ ...\n\n    override fun showToast(msg: String) {\n        activity?.runOnUiThread {\n            Toast\n                .makeText(requireContext(), msg, Toast.LENGTH_SHORT)\n                .show()\n        }\n    }\n\n    override fun showConfirmationModal(msg: String) {\n        activity?.runOnUiThread {\n            val builder = AlertDialog.Builder(requireContext())\n            builder.setTitle(&amp;quot;Confirmation&amp;quot;)\n            builder.setMessage(msg)\n            builder.setPositiveButton(&amp;quot;Yes&amp;quot;, DialogInterface.OnClickListener { dialog, id -&amp;gt;\n                session.webView.evaluateJavascript(\n                    &amp;quot;window.dispatchEvent(new CustomEvent(&#039;confirmation:handle&#039;, { detail: &#039;confirmed&#039; }))&amp;quot;,\n                    null\n                )\n                dialog.dismiss()\n            })\n\n            builder.setNegativeButton(&amp;quot;No&amp;quot;, DialogInterface.OnClickListener { dialog, id -&amp;gt;\n                session.webView.evaluateJavascript(\n                    &amp;quot;window.dispatchEvent(new CustomEvent(&#039;confirmation:handle&#039;, { detail: &#039;canceled&#039; }))&amp;quot;,\n                    null\n                )\n                dialog.dismiss()\n            })\n\n            val alert = builder.create()\n\n            alert.show()\n        }\n    }\n}\n\n\/\/ ...\n\ninterface PopupMenuDelegator {\n    \/\/ ...\n\n    fun showConfirmationModal(msg: String);\n}\n\nclass JsBridge(private var delegator: PopupMenuDelegator) {\n    \/\/ ...\n\n    {{&#039;@&#039;}}JavascriptInterface\n    fun showConfirmationModal(msg: String) {\n        delegator.showConfirmationModal(msg)\n    }\n}\n\n\nTesting It Out\n\nThis should get our native confirmation modal looking similar to our JS confirm one, but now we&#039;re in full control of it looks like and what it does:&quot;",
        "url": "https://turbo-laravel.com/bootcamp/native-confirmation",
      },
          "native-toasts": {
        "title": "Native Toasts",
        "content": "&quot;You may have noticed that our flash messages are not behaving correctly in the native side. That&#039;s because of how our native client handles redirects. It looks like it actiaves the cache first, which triggers a new request to the web app, then it visits the redirected URL, which then triggers another visit. Our flash messages are flashed for a single subsequent request, which is the one that comes from the activated cache, so they get lost when the redirect visit starts.\n\nWe can fix that by using some predefined URLs in the webapp that will only happen for Hotwire Native requests and they only instruct the web app to either recede, resume, or refresh the screens natively instead of following redirects.\n\nTurbo Laravel ships with those predefined URLs for you:\n\nphp artisan route:list | grep turbo\n  GET|HEAD        recede_historical_location turbo_recede_historical_location\u2026\n  GET|HEAD        refresh_historical_location turbo_refresh_historical_locati\u2026\n  GET|HEAD        resume_historical_location turbo_resume_historical_location\u2026\n\n\nIf you make a request to those routes, you will see that they don&#039;t actually have any contents on them:\n\ncurl localhost\/recede_historical_location\nGoing back...\n\ncurl localhost\/refresh_historical_location\nRefreshing...\n\ncurl localhost\/resume_historical_location\nStaying put...\n\n\nTurbo Laravel ships with a InteractsWithTurboNativeNavigation trait that we can use in our controllers to redirect to these routes when the request comes from a Hotwire Native client or to a fallback route otherwise.\n\nLet&#039;s change our controller to make use of that. We&#039;re going to change both the store and update actions to recede the screen stacks instead of a regular redirect:\n\n&amp;lt;?php\n\nnamespace App\\Http\\Controllers;\n\nuse App\\Models\\Chirp;\nuse Illuminate\\Http\\Request;\nuse HotwiredLaravel\\TurboLaravel\\Http\\Controllers\\Concerns\\InteractsWithHotwireNativeNavigation; \/\/ Add this\n\nclass ChirpController extends Controller\n{\n    \/\/ Add this:\n    use InteractsWithHotwireNativeNavigation;\n\n    \/\/ ...\n\n    public function store(Request $request)\n    {\n        $validated = $request-&amp;gt;validate([\n            &#039;message&#039; =&amp;gt; [&#039;required&#039;, &#039;string&#039;, &#039;max:255&#039;],\n        ]);\n\n        $chirp = $request-&amp;gt;user()-&amp;gt;chirps()-&amp;gt;create($validated);\n\n        \/\/ Check if the request came from a Hotwire Native client...\n        if ($request-&amp;gt;wantsTurboStream() &amp;amp;&amp;amp; ! $request-&amp;gt;wasFromHotwireNative()) {\n            return turbo_stream([\n                turbo_stream($chirp, &#039;prepend&#039;),\n                turbo_stream()-&amp;gt;update(&#039;create_chirp&#039;, view(&#039;chirps._form&#039;)),\n                turbo_stream()-&amp;gt;append(&#039;notifications&#039;, view(&#039;layouts.notification&#039;, [\n                    &#039;message&#039; =&amp;gt; __(&#039;Chirp created.&#039;),\n                ])),\n            ]);\n        }\n\n        \/\/ Use the recedeOrRedirectTo helper:\n        return $this-&amp;gt;recedeOrRedirectTo(route(&#039;chirps.index&#039;))\n            -&amp;gt;with(&#039;status&#039;, __(&#039;Chirp created.&#039;));\n    }\n\n    \/\/ ...\n\n    public function update(Request $request, Chirp $chirp)\n    {\n        $this-&amp;gt;authorize(&#039;update&#039;, $chirp);\n\n        $validated = $request-&amp;gt;validate([\n            &#039;message&#039; =&amp;gt; [&#039;required&#039;, &#039;string&#039;, &#039;max:255&#039;],\n        ]);\n\n        $chirp-&amp;gt;update($validated);\n\n        \/\/ Check if the request was from a Hotwire Native client...\n        if ($request-&amp;gt;wantsTurboStream() &amp;amp;&amp;amp; ! $request-&amp;gt;wasFromHotwireNative()) {\n            return turbo_stream([\n                turbo_stream($chirp),\n                turbo_stream()-&amp;gt;append(&#039;notifications&#039;, view(&#039;layouts.notification&#039;, [\n                    &#039;message&#039; =&amp;gt; __(&#039;Chirp updated.&#039;),\n                ])),\n            ]);\n        }\n\n        \/\/ Use the recedeOrRedirectTo helper:\n        return $this-&amp;gt;recedeOrRedirectTo(route(&#039;chirps.index&#039;))\n            -&amp;gt;with(&#039;status&#039;, __(&#039;Chirp updated.&#039;));\n    }\n\n    \/\/ ...\n}\n\n\nThe recedeOrRedirectTo method is the one that does the job of checking if the request comes from a Hotwire Native client or a regular web client and recides to redirect to the recede route instead of default redirect route. We also need to ensure that for when we&#039;re creating or updating chirps, we only return Turbo Streams if the request didn&#039;t come from a Hotwire Native client.\n\nNext, we need to configure our specific routes in the Constants.kt file:\n\npackage com.example.turbochirpernative.util\n\nconst val BASE_URL = &amp;quot;http:\/\/10.0.2.2&amp;quot;\nconst val CHIRPS_HOME_URL = &amp;quot;$BASE_URL\/chirps&amp;quot;\nconst val CHIRPS_CREATE_URL = &amp;quot;$BASE_URL\/chirps\/create&amp;quot;\n\n\/\/ Native Redirect Routes\nconst val REFRESH_HISTORICAL_URL = &amp;quot;$BASE_URL\/refresh_historical_location&amp;quot;\nconst val RECEDE_HISTORICAL_URL = &amp;quot;$BASE_URL\/recede_historical_location&amp;quot;\nconst val RESUME_HISTORICAL_URL = &amp;quot;$BASE_URL\/resume_historical_location&amp;quot;\n\nconst val API_BASE_URL = &amp;quot;$BASE_URL\/api&amp;quot;\nconst val API_CSRF_COOKIES_URL = &amp;quot;$BASE_URL\/sanctum\/csrf-cookie&amp;quot;\nconst val API_LOGIN_URL = &amp;quot;$API_BASE_URL\/login&amp;quot;\n\n\nNow, we need to update our main WebFragment (which is inherited by our sub fragments like the modal one) to catch redirects to these specific routes and stop the navigation and instead apply their native behavior in the navigation stack:\n\npackage com.example.turbochirpernative.features.web\n\nimport android.os.Bundle\nimport android.view.LayoutInflater\nimport android.view.View\nimport android.view.ViewGroup\nimport com.example.turbochirpernative.R\n\n\/\/ Add these imports:\nimport com.example.turbochirpernative.util.RECEDE_HISTORICAL_URL\nimport com.example.turbochirpernative.util.REFRESH_HISTORICAL_URL\nimport com.example.turbochirpernative.util.RESUME_HISTORICAL_URL\n\nimport dev.hotwire.turbo.fragments.TurboWebFragment\nimport dev.hotwire.turbo.nav.TurboNavGraphDestination\n\n{{&#039;@&#039;}}TurboNavGraphDestination(uri = &amp;quot;turbo:\/\/fragment\/web&amp;quot;)\nopen class WebFragment: TurboWebFragment() {\n    override fun onCreateView(inflater: LayoutInflater, container: ViewGroup?, savedInstanceState: Bundle?): View? {\n        return inflater.inflate(R.layout.fragment_web, container, false)\n    }\n\n    \/\/ Add this:\n    override fun shouldNavigateTo(newLocation: String): Boolean {\n        return when (newLocation) {\n            RECEDE_HISTORICAL_URL -&amp;gt; {\n                navigateBack()\n                false\n            }\n            REFRESH_HISTORICAL_URL -&amp;gt; {\n                refresh()\n                false\n            }\n            RESUME_HISTORICAL_URL -&amp;gt; {\n                false\n            }\n            else -&amp;gt; super.shouldNavigateTo(newLocation)\n        }\n    }\n}\n\n\nNow, if we try creating or updating a Chirp, we should see the web flash messages appearing!\n\n\n\nFlash as Toast Messages\n\nIt&#039;s cool that we&#039;re showing the web flash messages, but it would be even better if we could instead convert those messages to appear as real native Toasts, don&#039;t you think?! So, let&#039;s implement that.\n\nFirst, we&#039;ll need to hide the flash messages wrapper, so they don&#039;t appear in a Hotwire Native context. We can do that using the turbo-native: Tailwind variant we already have. Open the resources\/views\/layouts\/notifications.blade.php file and update its contents:\n\n&amp;lt;!-- Update the root element: --&amp;gt;\n&amp;lt;div id=&amp;quot;notifications&amp;quot; class=&amp;quot;fixed top-10 left-0 w-full text-center flex flex-col items-center space-y-2 justify-center z-10 opacity-80 turbo-native:hidden&amp;quot;&amp;gt;\n    {{&#039;@&#039;}}if ($message = session()-&amp;gt;get(&#039;status&#039;, null))\n        {{&#039;@&#039;}}include(&#039;layouts.notification&#039;, [&#039;message&#039; =&amp;gt; $message])\n    {{&#039;@&#039;}}endif\n&amp;lt;\/div&amp;gt;\n\n\nWith that, the flash messages shouldn&#039;t appear in Hotwire Native clients, but they should still appear in the web ones.\n\nNext, let&#039;s create a bridge Stimulus controller that will send a message to the Native client to show convert those web flash messages into native ones.\n\nphp artisan stimulus:make bridge\/toast_controller\n\n\nWe&#039;ll update the notification view (the singular one) and make it use the controller we just created. It&#039;s important to note that the bridge controller needs to be listed before all other controllers:\n\n&amp;lt;div data-turbo-cache=&amp;quot;false&amp;quot; class=&amp;quot;py-1 px-4 leading-7 text-center text-white rounded-full bg-gray-900 transition-all animate-appear-then-fade&amp;quot; data-controller=&amp;quot;bridge--toast notification&amp;quot; data-action=&amp;quot;animationend-&amp;gt;notification#remove&amp;quot;&amp;gt;\n    @{{ $message }}\n&amp;lt;\/div&amp;gt;\n\n\nNow, let&#039;s implement our Stimulus Toast controller:\n\nimport { Controller } from &amp;quot;{{&#039;@&#039;}}hotwired\/stimulus&amp;quot;\nimport { isMobileApp } from &amp;quot;..\/..\/helpers\/platform&amp;quot;\n\n\/\/ Connects to data-controller=&amp;quot;bridge--toast&amp;quot;\nexport default class extends Controller {\n    connect() {\n        if (! this.enabled) return\n\n        window.NativeBridge.showToast(this.element.textContent.trim())\n        this.element.remove();\n    }\n\n    get enabled() {\n        return isMobileApp\n    }\n}\n\n\nIt will simply read the text content of the flash message and pass it up to the native client to as a toast, then it removes the flash element from the page.\n\nNow, we need to implement the showToast handling in our MainSessionNavHostFragment:\n\npackage com.example.turbochirpernative.main\n\n\/\/ ...\nimport android.widget.Toast \/\/ Add this\n\nclass MainSessionNavHostFragment : TurboSessionNavHostFragment(), PopupMenuDelegator {\n    \/\/ ...\n\n    \/\/ Add this:\n    override fun showToast(msg: String) {\n        activity?.runOnUiThread {\n            Toast\n                .makeText(requireContext(), msg, Toast.LENGTH_SHORT)\n                .show()\n        }\n    }\n\n    \/\/ ...\n}\n\ninterface PopupMenuDelegator {\n    fun showPopupMenu(options: PopupMenu);\n    fun showToast(msg: String); \/\/ Add this\n    fun showConfirmationModal(msg: String);\n}\n\nclass JsBridge(private var delegator: PopupMenuDelegator) {\n    \/\/ ...\n\n    \/\/ Add this:\n    {{&#039;@&#039;}}JavascriptInterface\n    fun showToast(msg: String) {\n        delegator.showToast(msg)\n    }\n\n    {{&#039;@&#039;}}JavascriptInterface\n    fun showConfirmationModal(msg: String) {\n        delegator.showConfirmationModal(msg)\n    }\n}\n\n\nNow, we should have the native Toast messages!\n\n\n\nWhat is cool about this is that we have full control over the text message shown in the notification from our web app! Let&#039;s change the message to use an emoji, for instance:\n\n\n\n\nThat&#039;s it!&quot;",
        "url": "https://turbo-laravel.com/bootcamp/native-toasts",
      },
          "conclusion": {
        "title": "Conclusion",
        "content": "&quot;I hope this Bootcamp served as an introduction to how you can use the premises provided the Hotwire way of building web apps and hybrid native apps.\n\nThere&#039;s a lot more we can do with this toolset, but I think this is a good stopping point for the Bootcamp.\n\nIf you want to know more about Hotwire, here&#039;s some recommendation links:\n\n\nThe hotwire dev newsletter by Joe Masilotti\nThe Hotwire Example Template Repository has tons and tons of examples written by Sean Doyle\n\n\nThere are other paid courses and books, but I&#039;ll only mention the free things here. If you have other free material hubs or compilation, please send it my way so I can update it here.\n\nI&#039;d love to hear what you think about this Bootcamp and Turbo Laravel. Feel free to follow me on Twitter or email me to share your thoughts. Go build something amazing!&quot;",
        "url": "https://turbo-laravel.com/bootcamp/conclusion",
      },
      }
  </script>
        </div>

              </main>
    </div>
  </div>

        <footer class="px-6 py-4 sm:px-20 sm:py-10 flex items-center space-x-2 justify-between">
          <p class="text-base text-center w-full">
            Turbo Laravel is maintained by <a href="https://tonysm.com" class="underline text-zinc-900/90">Tony Messias</a>. This is a <em>community project</em>, therefore not affiliated with Laravel nor Hotwire.
          </p>
        </footer>
    </body>
</html>
